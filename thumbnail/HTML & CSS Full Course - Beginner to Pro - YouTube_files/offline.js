(function(g){var window=this;'use strict';var E9V=function(F){var J=new g.t8("und",new g.bI("Default","und",!0));J.captionTracks=F.captionTracks;return J},j6W=function(F){return new g.gb(function(J,b){var I=F.length,u=[];
if(I)for(var w=function(a,e){I--;u[a]=e;I==0&&J(u)},M=function(a){b(a)},q,v=0;v<F.length;v++)q=F[v],g.HG3(q,g.Ha(w,v),M);
else J(u)})},$t=function(F){this.C=F},Cs=function(){$t.apply(this,arguments)},G5b=function(){Cs.apply(this,arguments)},VWW=function(){Cs.apply(this,arguments)},P3H=function(){Cs.apply(this,arguments)},B88=function(){Cs.apply(this,arguments)},T8b=function(){Cs.apply(this,arguments)},rvb=function(){Cs.apply(this,arguments)},SUb=function(){$t.apply(this,arguments)},s6L=function(){Cs.apply(this,arguments)},YUU=function(){Cs.apply(this,arguments)},$6b=function(){Cs.apply(this,arguments)},C35=function(){Cs.apply(this,
arguments)},XRR=function(){Cs.apply(this,arguments)},Q6R=function(){Cs.apply(this,arguments)},RPe=function(){Cs.apply(this,arguments)},D6W=function(){Cs.apply(this,arguments)},k5k=function(){Cs.apply(this,arguments)},O2z=function(){Cs.apply(this,arguments)},o9U=function(){Cs.apply(this,arguments)},hPU=function(){Cs.apply(this,arguments)},cvb=function(){$t.apply(this,arguments)},U6b=function(){Cs.apply(this,arguments)},x61=function(){Cs.apply(this,arguments)},n91=function(){Cs.apply(this,arguments)},
tW1=function(){Cs.apply(this,arguments)},Z21=function(){Cs.apply(this,arguments)},H25=function(){Cs.apply(this,arguments)},L6t=function(){Cs.apply(this,arguments)},FjU=function(){Cs.apply(this,arguments)},JNW=function(){Cs.apply(this,arguments)},bM5=function(){$t.apply(this,arguments)},IV1=function(){$t.apply(this,arguments)},uBe=function(){$t.apply(this,arguments)},wtV=function(){Cs.apply(this,arguments)},Mhb=function(){Cs.apply(this,arguments)},ANb=function(){Cs.apply(this,arguments)},q45=function(){Cs.apply(this,
arguments)},voU=function(){Cs.apply(this,arguments)},aVt=function(){Cs.apply(this,arguments)},e$W=function(){Cs.apply(this,arguments)},Kj8=function(){Cs.apply(this,arguments)},ptL=function(){Cs.apply(this,arguments)},gob=function(){Cs.apply(this,arguments)},ml8=function(){Cs.apply(this,arguments)},yNm=function(){Cs.apply(this,arguments)},iMW=function(){Cs.apply(this,arguments)},z$R=function(){Cs.apply(this,arguments)},NRH=function(){Cs.apply(this,arguments)},lV1=function(){Cs.apply(this,arguments)},
fVt=function(){Cs.apply(this,arguments)},Wjk=function(){Cs.apply(this,arguments)},dlk=function(){Cs.apply(this,arguments)},Eo8=function(){Cs.apply(this,arguments)},j2k=function(){Cs.apply(this,arguments)},GmU=function(){Cs.apply(this,arguments)},Vhm=function(){Cs.apply(this,arguments)},PFb=function(){Cs.apply(this,arguments)},BR8=function(){Cs.apply(this,arguments)},TRz=function(){Cs.apply(this,arguments)},rNW=function(){$t.apply(this,arguments)},S4b=function(){Cs.apply(this,arguments)},s21=function(){Cs.apply(this,
arguments)},Y4b=function(){Cs.apply(this,arguments)},$lU=function(){Cs.apply(this,arguments)},CFk=function(){Cs.apply(this,arguments)},Xtm=function(){Cs.apply(this,arguments)},Q2e=function(){Cs.apply(this,arguments)},R$b=function(){Cs.apply(this,arguments)},Dlm=function(){Cs.apply(this,arguments)},kmU=function(){Cs.apply(this,arguments)},OMU=function(){Cs.apply(this,arguments)},ooW=function(){Cs.apply(this,arguments)},h$R=function(){Cs.apply(this,arguments)},cNV=function(){Cs.apply(this,arguments)},
Ulb=function(){Cs.apply(this,arguments)},xlt=function(){Cs.apply(this,arguments)},no5=function(){Cs.apply(this,arguments)},tht=function(){Cs.apply(this,arguments)},ZMU=function(){Cs.apply(this,arguments)},HMz=function(){Cs.apply(this,arguments)},Ljm=function(){Cs.apply(this,arguments)},FxH=function(){Cs.apply(this,arguments)},Jh5=function(){Cs.apply(this,arguments)},b_b=function(){Cs.apply(this,arguments)},IAb=function(){Cs.apply(this,arguments)},uV5=function(){Cs.apply(this,arguments)},wYk=function(){Cs.apply(this,
arguments)},Mwb=function(){Cs.apply(this,arguments)},AhU=function(){Cs.apply(this,arguments)},qGm=function(){Cs.apply(this,arguments)},vIV=function(F){F=F.key||F.id;
if(!F)throw Error("Entity key is missing");return F},aA1=function(){if(Xr)return Xr();
var F={};Xr=g.H$("PersistentEntityStoreDb",{ET:(F.EntityStore={Sp:1},F.EntityAssociationStore={Sp:2},F),shared:!1,upgrade:function(J,b){b(1)&&g.sl(g.Vb(J,"EntityStore",{keyPath:"key"}),"entityType","entityType");b(2)&&(J=g.Vb(J,"EntityAssociationStore",{keyPath:["parentEntityKey","childEntityKey"]}),g.sl(J,"byParentEntityKey","parentEntityKey"),g.sl(J,"byChildEntityKey","childEntityKey"))},
version:3});return Xr()},eAk=function(F){return g.ku(aA1(),F)},Kxm=function(F){return g.ku((0,g.ueb)(),F)},QQ=function(F){this.token=F},R5=function(F,J){J=J===void 0?{}:J;
g.hC.call(this,g.w38[F],Object.assign({},{name:"PESEncoderError",type:F},J));this.type=F;this.level="WARNING";Object.setPrototypeOf(this,R5.prototype)},pYk=function(F){return new R5("WRONG_DATA_TYPE",{VX:F})},gIL=function(F){return F instanceof Error?new R5("UNKNOWN_ENCODE_ERROR",{U_:F.message}):new R5("UNKNOWN_ENCODE_ERROR")},m5U=function(F){return F instanceof Error?new R5("UNKNOWN_DECODE_ERROR",{U_:F.message}):new R5("UNKNOWN_DECODE_ERROR")},yhe=function(F,J){F=F instanceof R5?F:J(F);
g.Td(F);throw F;},i_V=function(){},zAL=function(F,J,b){try{return F.T(J,b)}catch(I){yhe(I,gIL)}},Nfe=function(F){F=(new TextEncoder).encode(F).subarray(0,16);
var J=new Uint8Array(16);J.set(F);return J},DK=function(F){this.C=F},fAz=function(F){var J=lAz[F];
if(J)return J;g.rQ(new g.hC("Entity model not found.",{entityType:F}))},Wxb=function(F,J){this.C=F;
this.U=J;this.T={}},EI1=function(F,J){a:{F=d51(F.U,J.version);
try{var b=F.U(J.data,J.key);break a}catch(I){yhe(I,m5U)}b=void 0}return b},kt=function(F,J,b){return F.C.objectStore("EntityStore").get(J).then(function(I){if(I){if(b&&I.entityType!==b)throw Error("Incorrect entity type");
return EI1(F,I)}})},OA=function(F,J,b){return b?(b=b.map(function(I){return kt(F,I,J)}),g.fD.all(b)):F.C.objectStore("EntityStore").index("entityType").getAll(IDBKeyRange.only(J)).then(function(I){return I.map(function(u){return EI1(F,u)})})},hl=function(F,J,b){var I=vIV(J),u=d51(F.U,1),w=Object.assign({},J);
return F.C.objectStore("EntityStore").get(I).then(function(M){if(M){if(M.entityType!==b)throw Error("Incorrect entity type");w.entityMetadata||(M=EI1(F,M),w.entityMetadata=M.entityMetadata)}}).then(function(){var M={key:I,
entityType:b,data:zAL(u,w,I),version:1};return g.fD.all([g.Tl(F.C.objectStore("EntityStore"),M),jIU(F,w,b)])}).then(function(){o5(F,I,b);
return I})},Git=function(F,J,b){J=J.map(function(I){return hl(F,I,b)});
return g.fD.all(J)},cb=function(F,J,b){if(b==null?0:b.MU){var I=new Set;
return Vwt(F,J,I).then(function(){for(var w=[],M=g.N(I),q=M.next();!q.done;q=M.next())w.push(cb(F,q.value));return g.fD.all(w).then(function(){})})}var u=g.w0(J).entityType;
return g.fD.all([F.C.objectStore("EntityStore").delete(J),PTW(F,J)]).then(function(){o5(F,J,u)})},BfL=function(F,J){return g.Xs(F.C.objectStore("EntityStore").index("entityType"),{query:IDBKeyRange.only(J)},function(b){return g.fD.all([b.delete(),
PTW(F,b.cursor.primaryKey)]).then(function(){o5(F,b.cursor.primaryKey,J);return g.$u(b)})})},Tfb=function(F,J,b,I){var u=d51(F.U,1);
return kt(F,J,I).then(function(w){if(w){w=g.gE(w,b);var M={key:J,entityType:I,data:zAL(u,w,J),version:1};return g.fD.all([g.Tl(F.C.objectStore("EntityStore"),M),jIU(F,w,I)])}}).then(function(){o5(F,J,I);
return J})},o5=function(F,J,b){var I=F.T[b];
I||(I=new Set,F.T[b]=I);I.add(J)},rht=function(F,J,b){var I=vIV(J);
b=fAz(b);if(!b)return g.fD.resolve([]);b=new b(J);F=F.C.objectStore("EntityAssociationStore");J=[];b=g.N(b.U());for(var u=b.next();!u.done;u=b.next())J.push(g.Tl(F,{parentEntityKey:I,childEntityKey:u.value}));return g.fD.all(J).then(function(w){return w.map(function(M){return M[1]})})},PTW=function(F,J){return F.C.objectStore("EntityAssociationStore").index("byParentEntityKey").delete(IDBKeyRange.only(J))},jIU=function(F,J,b){var I=vIV(J);
return PTW(F,I).then(function(){return rht(F,J,b)})},Vwt=function(F,J,b){if(b.has(J))return g.fD.resolve(void 0);
b.add(J);return SGH(F,J).then(function(I){return F.C.objectStore("EntityAssociationStore").index("byParentEntityKey").delete(IDBKeyRange.only(J)).then(function(){return I})}).then(function(I){var u=g.fD.resolve(void 0);
I=g.N(I);for(var w=I.next(),M={};!w.done;M={I2:void 0},w=I.next())M.I2=w.value,u=u.then(function(q){return function(){return Vwt(F,q.I2,b)}}(M));
return u}).then(function(){})},SGH=function(F,J){var b=F.C.objectStore("EntityAssociationStore");
return b.index("byParentEntityKey").getAll(IDBKeyRange.only(J)).then(function(I){var u=[];I=g.N(I);for(var w=I.next();!w.done;w=I.next())w=w.value,u.push(b.index("byChildEntityKey").getAll(w.childEntityKey));return g.fD.all(u)}).then(function(I){var u=[];
I=g.N(I);for(var w=I.next();!w.done;w=I.next())w=w.value,w.length===1&&u.push(w[0].childEntityKey);return u})},UA=function(){},sIt=function(){this.C={};
this.C[0]=new UA;if(!g.Nk("aes_pes_encoder_killswitch")){var F=this.C;try{var J=g.cK();var b=Nfe(J);var I=new DK(new g.fg(b),new g.lx(b))}catch(u){throw F=u instanceof Error?new R5("KEY_CREATION_FAILED",{U_:u.message}):new R5("KEY_CREATION_FAILED"),g.Td(F),F;}F[1]=I}},d51=function(F,J){J=J===void 0?0:J;
F=F.C[J];if(!F)throw J=new R5("INVALID_ENCODER_VERSION",{VX:J}),g.Td(J),J;return F},xt=function(F,J){g.R.call(this);
this.token=F;this.C=J;this.observers=[];F=new g.Qz.BroadcastChannel("PERSISTENT_ENTITY_STORE_SYNC:"+g.cK());F.onmessage=this.U.bind(this);this.channel=F},ns=function(F,J,b){var I,u,w,M;
return g.S(function(q){if(q.C==1)return g.T(q,eAk(F.token),2);if(q.C!=3)return I=q.U,g.T(q,g.B$(I,["EntityStore","EntityAssociationStore"],J,function(v){u=new Wxb(v,F.C);return b(u)}),3);
w=q.U;u&&(M=u.T,Object.keys(M).length>0&&(F.channel.postMessage(M),YGL(F,M)));return q.return(w)})},tl=function(F,J,b){return ns(F,{mode:"readwrite",
Em:!0},function(I){return hl(I,J,b)})},$55=function(F,J){return ns(F,{mode:"readwrite",
Em:!0},function(b){return Git(b,J,"offlineOrchestrationActionWrapperEntity")})},CT1=function(F,J){return ns(F,{mode:"readwrite",
Em:!0},function(b){return cb(b,J)})},XYb=function(F){return ns(F,{mode:"readwrite",
Em:!0},function(J){return BfL(J,"videoPlaybackPositionEntity")})},ZK=function(F,J,b){return ns(F,{mode:"readonly",
Em:!0},function(I){return kt(I,J,b)})},Hb=function(F,J,b){return ns(F,{mode:"readonly",
Em:!0},function(I){return OA(I,J,b)})},YGL=function(F,J){F=g.N(F.observers);
for(var b=F.next();!b.done;b=F.next())b=b.value,b(J)},QIR=function(){var F,J,b;
return g.S(function(I){if(I.C==1)return g.lk(I,2),g.T(I,g.tY(),4);if(I.C!=2){F=I.U;if(!F||!g.Uy()||typeof g.Qz.BroadcastChannel==="undefined")return I.return();J=new sIt;return I.return(new xt(F,J))}b=g.dY(I);b instanceof Error&&g.Td(b);return I.return()})},Ls=function(){RAR||(RAR=QIR());
return RAR},D5m=function(F){var J;
F=(J=F.options)==null?void 0:J.persistenceOption;return F==="ENTITY_PERSISTENCE_OPTION_PERSIST"||F==="ENTITY_PERSISTENCE_OPTION_INMEMORY_AND_PERSIST"},ki1=function(F){var J;
return g.S(function(b){return b.C==1?g.T(b,Ls(),2):(J=b.U)?g.T(b,ns(J,"readwrite",function(I){for(var u={},w=g.N(F),M=w.next(),q={};!M.done;q={o5:void 0,yV:void 0},M=w.next())q.o5=M.value,q.o5.entityKey&&D5m(q.o5)&&(q.yV=g.f$(q.o5.payload),M=void 0,q.o5.type==="ENTITY_MUTATION_TYPE_REPLACE"&&(M=function(v){return function(){return hl(I,v.o5.payload[v.yV],v.yV)}}(q)),q.o5.type==="ENTITY_MUTATION_TYPE_DELETE"&&(M=function(v){return function(){return cb(I,v.o5.entityKey)}}(q)),q.o5.type==="ENTITY_MUTATION_TYPE_UPDATE"&&
(M=function(v){return function(){return Tfb(I,v.o5.entityKey,v.o5.payload[v.yV],v.yV)}}(q)),M&&(u[q.o5.entityKey]=u[q.o5.entityKey]?u[q.o5.entityKey].then(M):M()));
return g.fD.all(Object.values(u))}),0):b.return()})},O_5=function(F){var J;
return g.S(function(b){if(b.C==1){J=F.mutations;if(!J||J.length<=0)return b.return();if(g.ZR){var I={type:"ENTITY_LOADED"};J!==void 0&&(I.payload=J);g.ZR.dispatch(I)}return g.T(b,ki1(J),2)}J.length=0;g.N4(b)})},oIW=function(F){return F!==void 0},hA8=function(F){var J=g.d7();
J=Object.assign({},J);F=Object.assign({},F);for(var b in J)F[b]?(J[b]!==4&&(J[b]=F[b]),delete F[b]):J[b]!==2&&(J[b]=4);Object.assign(J,F);g.xh_(J);JSON.stringify(J);return J},che=function(F){var J,b;
return g.S(function(I){if(I.C==1)return g.T(I,g.tY(),2);if(I.C!=3)return(J=I.U)?g.T(I,g.Gt(J),3):I.return();b=I.U;return I.return(g.B$(b,["index","media","captions"],{mode:"readwrite",Em:!0},function(u){var w=IDBKeyRange.bound(F+"|",F+"~");u=[u.objectStore("index").delete(w),u.objectStore("media").delete(w),u.objectStore("captions").delete(w)];return g.fD.all(u).then(function(){})}))})},U5k=function(){var F,J;
return g.S(function(b){if(b.C==1)return g.T(b,g.tY(),2);if(b.C!=3){F=b.U;if(!F)throw g.NP("rvdfd");return g.T(b,g.Gt(F),3)}J=b.U;return b.return(g.B$(J,["index","media"],{mode:"readwrite",Em:!0},function(I){var u={};return g.Yu(I.objectStore("index"),{},function(w){var M=w.cursor.key.match(/^([\w\-_]+)\|(a|v)$/),q=g.fD.resolve(void 0);if(M){var v=M[1];M=M[2];u[v]=u[v]||{};var a;u[v][M]=g.LqG((a=w.getValue())==null?void 0:a.fmts)}else q=w.delete().then(function(){});
return g.fD.all([g.$u(w),q]).then(function(e){return g.N(e).next().value})}).then(function(){for(var w={},M=g.N(Object.keys(u)),q=M.next();!q.done;q=M.next()){q=q.value;
var v=u[q].v;w[q]=u[q].a&&v?1:2}var a=hA8(w);return g.TDa(I.objectStore("media"),{},function(e){var K=e.cursor.key.match(g.IpG);K&&w[K[1]]||I.objectStore("media").delete(e.cursor.key);return g.fCm(e)}).then(function(){return a})})}))})},x55=function(F,J){var b,I;
return g.S(function(u){if(u.C==1)return g.T(u,g.tY(),2);if(u.C!=3){b=u.U;if(!b)throw g.NP("wct");return g.T(u,g.Gt(b),3)}I=u.U;return g.T(u,g.B$(I,["captions"],{mode:"readwrite",Em:!0},function(w){var M=[];w=w.objectStore("captions");for(var q=0;q<J.length;q++){var v=g.Tl(w,J[q],F+"|"+J[q].metadata.vss_id);M.push(v)}return g.fD.all(M)}),0)})},nIm=function(F){var J,b,I;
return g.S(function(u){if(u.C==1)return J=IDBKeyRange.bound(F+"|",F+"~"),g.T(u,g.tY(),2);if(u.C!=3){b=u.U;if(!b)throw g.NP("gactfv");return g.T(u,g.Gt(b),3)}I=u.U;return u.return(I.getAll("captions",J))})},twt=function(F){return g.S(function(J){g.jE(F,0);
return J.return(che(F))})},Z_b=function(F){return{context:g.UV(),
videoIds:F}},H_m=function(F){return{context:g.UV(),
playlistIds:F}},Lx8=function(F){return{context:g.UV(),
offlinePlaylistSyncChecks:F}},F2k=function(){this.C=new Map},bLR=function(){JW8||(JW8=new F2k);
return JW8},IG1=function(F,J){return{eventType:{flowEventNamespace:"FLOW_EVENT_NAMESPACE_OFFLINE_ORCHESTRATION",
flowEventType:F},metadata:J,statusCode:void 0,csn:void 0,can:void 0}},uwt=function(F,J,b){if(!b){var I=I===void 0?!1:I;
b=F.C.get("FLOW_TYPE_OFFLINE_ORCHESTRATION");if(!b||I)b=g.Nq(16),F.C.set("FLOW_TYPE_OFFLINE_ORCHESTRATION",b)}F={flowNonce:b,flowType:"FLOW_TYPE_OFFLINE_ORCHESTRATION",flowEventType:J.eventType};J.metadata&&(F.flowMetadata=J.metadata);J.statusCode!==void 0&&(F.flowEventStatus=J.statusCode);J.csn&&(F.csn=J.csn);J.can&&(F.can=J.can);g.AY("flowEvent",F,void 0)},wcb=function(F){var J,b,I,u,w,M,q,v,a,e,K,p,m,y,f,d,G,P,r,Q,D,t,n,uk,AJ,F7,h,L,l,c,Da,fz,Kz,Vz,Za,Ib,yU,E,V,B;
return g.S(function(Y){if(Y.C==1)return g.T(Y,ns(F,{mode:"readonly",Em:!0},function(X){return OA(X,"playbackData").then(function(JJ){var wY=JJ.map(function(yz){return yz.transfer}).filter(function(yz){return!!yz}),M4=JJ.map(function(yz){return yz.offlineVideoPolicy}).filter(function(yz){return!!yz}),C=JJ.filter(function(yz){return!!yz.key}).map(function(yz){return g.Ms(g.w0(yz.key).entityId,"downloadStatusEntity")});
wY=OA(X,"transfer",wY);M4=OA(X,"offlineVideoPolicy",M4);C=OA(X,"downloadStatusEntity",C);var ez=wY.then(function(yz){yz=yz.reduce(function(va,rY){(rY==null?0:rY.offlineVideoStreams)&&va.push.apply(va,g.W(rY.offlineVideoStreams));return va},[]).filter(function(va){return!!va});
return OA(X,"offlineVideoStreams",yz)});
return g.fD.all([wY,M4,ez,C]).then(function(yz){var va=g.N(yz);yz=va.next().value;var rY=va.next().value;var pz=va.next().value;va=va.next().value;return[JJ,yz,rY,pz,va]})})}),2);
if(Y.C!=3)return J=Y.U,g.T(Y,ns(F,{mode:"readonly",Em:!0},function(X){return OA(X,"mainDownloadsListEntity").then(function(JJ){var wY,M4;return(M4=(wY=JJ[0])==null?void 0:wY.downloads)!=null?M4:[]})}),3);
b=Y.U;I=g.N(J);u=I.next().value;w=I.next().value;M=I.next().value;q=I.next().value;v=I.next().value;a=u;e=w;K=M;p=q;m=v;y={};f={};d={};G={};P={};r=[];Q=g.N(e);for(D=Q.next();!D.done;D=Q.next())(t=D.value)&&(y[t.key]=t);n=g.N(K);for(uk=n.next();!uk.done;uk=n.next())(AJ=uk.value)&&(f[AJ.key]=AJ);F7=g.N(m);for(h=F7.next();!h.done;h=F7.next())(L=h.value)&&(d[L.key]=L);l=g.N(p);for(c=l.next();!c.done;c=l.next())(Da=c.value)&&(G[Da.key]=Da);fz=g.N(b);for(Kz=fz.next();!Kz.done;Kz=fz.next())Vz=Kz.value,Za=
void 0,P[(Za=Vz.videoItem)!=null?Za:""]=!0,Vz.videoItem&&(yU=Ib=void 0,E=(yU=(Ib=g.w0(Vz.videoItem))==null?void 0:Ib.entityId)!=null?yU:"",r.push({externalVideoId:E}));V=a.filter(function(X){if(!X||!X.key||!X.offlineVideoPolicy)return!1;X=g.w0(X.key).entityId;X=g.Ms(X,"downloadStatusEntity");var JJ;return!(X&&((JJ=d[X])==null?void 0:JJ.downloadState)==="DOWNLOAD_STATE_USER_DELETED")});
B=V.map(function(X){var JJ=y[X.transfer],wY=[];if(JJ==null?0:JJ.offlineVideoStreams)for(var M4=g.N(JJ.offlineVideoStreams),C=M4.next();!C.done;C=M4.next())(C=G[C.value])&&wY.push(C);M4=f[X.offlineVideoPolicy];C=P;var ez=X==null?void 0:X.playerResponseTimestamp,yz=g.w0(M4.key).entityId;X=g.Ms(yz,"mainVideoEntity");if(M4.action==="OFFLINE_VIDEO_POLICY_ACTION_DISABLE"){var va="OFFLINE_VIDEO_STATE_DISABLED";M4.expirationTimestamp&&Number(M4.expirationTimestamp)<Date.now()/1E3&&(va="OFFLINE_VIDEO_STATE_EXPIRED")}else if(M4.action===
"OFFLINE_VIDEO_POLICY_ACTION_DOWNLOAD_FAILED")va="OFFLINE_VIDEO_STATE_OFFLINE_FAILED";else{switch(JJ==null?void 0:JJ.transferState){case "TRANSFER_STATE_TRANSFER_IN_QUEUE":va="OFFLINE_VIDEO_STATE_PENDING";break;case "TRANSFER_STATE_TRANSFERRING":va="OFFLINE_VIDEO_STATE_TRANSFERRING";break;case "TRANSFER_STATE_PAUSED_BY_USER":va="OFFLINE_VIDEO_STATE_PAUSED_TRANSFER";break;case "TRANSFER_STATE_FAILED":va="OFFLINE_VIDEO_STATE_OFFLINE_FAILED";break;case "TRANSFER_STATE_COMPLETE":va="OFFLINE_VIDEO_STATE_PLAYABLE";
break;case "TRANSFER_STATE_WAITING_FOR_PLAYER_RESPONSE_REFRESH":va="OFFLINE_VIDEO_STATE_STREAMS_OUT_OF_DATE";break;default:va="OFFLINE_VIDEO_STATE_UNKNOWN"}if(va==="OFFLINE_VIDEO_STATE_OFFLINE_FAILED")switch(JJ==null?void 0:JJ.failureReason){case "TRANSFER_FAILURE_REASON_EXTERNAL_FILESYSTEM_WRITE":case "TRANSFER_FAILURE_REASON_FILESYSTEM_WRITE":va="OFFLINE_VIDEO_STATE_OUT_OF_STORAGE_ERROR";break;case "TRANSFER_FAILURE_REASON_STREAM_MISSING":va="OFFLINE_VIDEO_STATE_STREAMS_MISSING";break;case "TRANSFER_FAILURE_REASON_NETWORK":case "TRANSFER_FAILURE_REASON_NETWORK_LOST":va=
"OFFLINE_VIDEO_STATE_NETWORK_ERROR"}}yz={id:yz,videoState:va};if(JJ==null?0:JJ.cotn)yz.cotn=JJ.cotn;if(JJ==null?0:JJ.maximumDownloadQuality)yz.selectedVideoQuality=JJ==null?void 0:JJ.maximumDownloadQuality;if(JJ==null?0:JJ.lastProgressTimeMs)yz.lastProgressTimeMs=JJ.lastProgressTimeMs;ez&&(yz.playerResponseSavedTimeMs=String(Number(ez)*1E3));JJ=String;ez=0;wY=g.N(wY);for(va=wY.next();!va.done;va=wY.next())if(va=va.value,va.streamsProgress){va=g.N(va.streamsProgress);for(var rY=va.next();!rY.done;rY=
va.next()){var pz=void 0;ez+=Number((pz=rY.value.numBytesDownloaded)!=null?pz:0)}}yz.downloadedBytes=JJ(ez);yz.selectedOfflineMode=C[X]?"OFFLINE_MODE_TYPE_AUTO_OFFLINE":"OFFLINE_NOW";M4.action==="OFFLINE_VIDEO_POLICY_ACTION_DISABLE"&&(yz.offlinePlaybackDisabledReason=M4.offlinePlaybackDisabledReason);return yz});
return Y.return({offlineVideos:B,additionalOfflineClientState:{mainAppAdditionalOfflineClientState:{smartDownloadVideos:r}}})})},Mub=function(){this.locks=navigator.locks},AWb=function(){try{var F=g.kC("ytglobal.locks_");
if(F)return F;var J;if(J=navigator){var b=navigator;J="locks"in b&&!!b.locks}if(J)return g.Qz.localStorage&&g.Qz.localStorage.getItem("noop"),F=new Mub,g.RG("ytglobal.locks_",F),F}catch(I){}},FM=function(){},qNk=function(){},vg1=function(F){if(F.includes(":"))throw Error("Invalid user cache name: "+F);
return F+":"+g.cK("CacheStorage get")},aGH=function(){return g.S(function(F){if(JO!==void 0)return F.return(JO);
JO=new Promise(function(J){var b;return g.S(function(I){switch(I.C){case 1:return g.lk(I,2),g.T(I,bl.open("test-only"),4);case 4:return g.T(I,bl.delete("test-only"),5);case 5:g.Wa(I,3);break;case 2:if(b=g.dY(I),b instanceof Error&&b.name==="SecurityError")return J(!1),I.return();case 3:J("caches"in window),g.N4(I)}})});
return F.return(JO)})},K2m=function(){return g.S(function(F){if(F.C==1)return g.T(F,aGH(),2);
if(!F.U)return F.return(void 0);eY8||(eY8=new qNk);return F.return(eY8)})},I_=function(F,J,b){g.rQ(new g.hC("Woffle: "+F,b?{cotn:b}:""));
J instanceof Error&&g.rQ(J)},pc5=function(F){var J;
return g.S(function(b){if(b.C==1)return g.T(b,wcb(F),2);J=b.U;g.AY("offlineStateSnapshot",J);g.N4(b)})},ul=function(F){g.R.call(this);
var J=this;this.api=F;this.Po={g8E:function(){return J.C},
xPQ:function(){return J.U}};
typeof g.Qz.BroadcastChannel!=="undefined"&&(this.C=new g.Qz.BroadcastChannel("PLAYER_OFFLINE_ERROR_SYNC:"+g.cK()),this.C.onmessage=this.T.bind(this),this.U=new g.Qz.BroadcastChannel("PLAYER_OFFLINE_PAUSE_SYNC:"+g.cK()),this.U.onmessage=this.Z.bind(this))},wx=function(F,J){F.api.jE("onOfflineOperationFailure",J);
var b;(b=F.C)==null||b.postMessage(J)},ggH=function(F,J,b,I){var u=this;
this.Y=F;this.N=J;this.visibility=b;this.S=I;this.D=this.V=this.W=this.T=this.C=!1;this.Z=new g.ty(function(){u.jA()});
this.Po={tA:function(){return u.U},
jA:function(){u.jA()},
Y1E:function(){return u.Z}};
this.visibility.subscribe("visibilitystatechange",function(){u.G0()})},mBV=function(F){if(!F.T&&!F.C){var J=AWb();
if(J){F.T=!0;var b=g.cK("OfflineLockManager");J.request("woffle_orchestration_leader:"+b,{},function(){var I,u,w,M;return g.S(function(q){switch(q.C){case 1:return g.lk(q,2),F.U=new g.m6,F.C=!0,F.T=!1,g.T(q,F.Y(),4);case 4:return g.T(q,F.U.promise,5);case 5:g.Wa(q,0);break;case 2:I=g.dY(q),((w=(u=F).S)==null?0:w.call(u,"wo_relinquish_leadership_on_lock_request_error"))||F.jA(),I instanceof Error&&(M=I,M.args=[{name:"WoLockManagerError",Rt:I.name}],g.Td(M)),g.N4(q)}})})}}},yWt=function(F){F.C&&(F.D=
!0,Mz(F))},iLW=function(F,J){F.C&&(F.W=J,Mz(F))},zYe=function(F,J){F.C&&(F.V=J,Mz(F))},Mz=function(F){F.V&&F.W&&F.D&&F.visibility.isBackground()?g.Z_(F.Z,6E4):F.Z.stop()},AO=function(F){var J;
F.offlineDeleteReason=(J=F.offlineDeleteReason)!=null?J:"OFFLINE_DELETE_REASON_UNKNOWN";var b;F.offlineModeType=(b=F.offlineModeType)!=null?b:"OFFLINE_NOW";g.AY("offlineDeleteEvent",F)},qz=function(F,J){var b=J.videoId;
var I=J.ZW;J=J.offlineModeType;F.encryptedVideoId=b;F.cotn=I==null?void 0:I.cotn;F.offlineabilityFormatType=I==null?void 0:I.maximumDownloadQuality;var u;F.isRefresh=(u=I==null?void 0:I.isRefresh)!=null?u:!1;var w;F.softErrorCount=(w=I==null?void 0:I.transferRetryCount)!=null?w:0;F.offlineModeType=J!=null?J:"OFFLINE_NOW";(F.transferStatusType==="TRANSFER_STATUS_TYPE_UNKNOWN"&&F.statusType==="UNKNOWN_STATUS_TYPE"||!F.transferStatusType&&!F.statusType)&&g.rQ(Error("Woffle unknown transfer status"));
g.AY("offlineTransferStatusChanged",F)},Njz=function(F,J,b,I){I={transferStatusType:"TRANSFER_STATUS_TYPE_PROCESSING",
statusType:"OFFLINING_STARTED",transferFirstStarted:!!I};J&&b&&(J=Math.floor(J/1024).toFixed(),b=Math.floor(b/1024).toFixed(),I.alreadyDownloadedKbytes=J,I.totalFetchedKbytes=J,I.totalContentKbytes=b);qz(I,F)},lG1=function(F){qz({transferStatusType:"TRANSFER_STATUS_TYPE_DEQUEUED_BY_USER_PAUSE",
statusType:"SUSPENDED"},F)},fGR=function(F){switch(F){case "TRANSFER_FAILURE_REASON_FILESYSTEM_WRITE":case "TRANSFER_FAILURE_REASON_EXTERNAL_FILESYSTEM_WRITE":return"OFFLINE_DATABASE_ERROR";
case "TRANSFER_FAILURE_REASON_PLAYABILITY":return"NOT_PLAYABLE";case "TRANSFER_FAILURE_REASON_TOO_MANY_RETRIES":return"TOO_MANY_RETRIES";case "TRANSFER_FAILURE_REASON_INTERNAL":return"OFFLINE_DOWNLOAD_CONTROLLER_ERROR";case "TRANSFER_FAILURE_REASON_STREAM_MISSING":return"STREAM_VERIFICATION_FAILED";case "TRANSFER_FAILURE_REASON_SERVER":case "TRANSFER_FAILURE_REASON_SERVER_PROPERTY_MISSING":return"OFFLINE_REQUEST_FAILURE";case "TRANSFER_FAILURE_REASON_NETWORK":return"OFFLINE_NETWORK_ERROR";default:return"UNKNOWN_FAILURE_REASON"}},
vH=function(F){var J,b,I;
return((I=(J=F.actionMetadata)==null?void 0:(b=J.retryScheduleIntervalsInSeconds)==null?void 0:b.length)!=null?I:0)>0},a_=function(F){return F.actionType==="OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD"&&!!F.entityKey},eG=function(F){return F.actionType==="OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH"&&!!F.entityKey},Kh=function(F){return F.actionType==="OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE"&&!!F.entityKey},W21=function(F){return F.actionType==="OFFLINE_ORCHESTRATION_ACTION_TYPE_UPDATE"&&!!F.entityKey},
ph=function(F,J,b,I,u){u=u===void 0?!1:u;
var w,M,q,v,a,e;return g.S(function(K){if(K.C==1)return w=g.Ms(F,J),M=g.Ms(F,"downloadStatusEntity"),g.T(K,ns(b,{mode:"readonly",Em:!0},function(p){return g.fD.all([kt(p,w,J),kt(p,M,"downloadStatusEntity")])}),2);
q=K.U;v=q.length?q[0]:void 0;if(!v)return K.gD(0);a=dBb;if(e=q.length>1?q[1]:void 0){if(e.downloadState==="DOWNLOAD_STATE_USER_DELETED"&&!u)return K.return();e.downloadState=I}else e={key:M,downloadState:I};g.CO(v,a,e);return g.T(K,ns(b,{mode:"readwrite",Em:!0},function(p){return g.fD.all([hl(p,v,J),hl(p,e,"downloadStatusEntity")])}),0)})},gx=function(F,J){return F.actionType===J.actionType&&F.entityKey===J.entityKey},mv=function(F,J){if(F&&F.transferState!=="TRANSFER_STATE_COMPLETE"&&F.transferState!==
"TRANSFER_STATE_FAILED"){var b=g.w0(F.key).entityId;
qz({transferStatusType:"TRANSFER_STATUS_TYPE_TERMINATED_BY_USER",statusType:"CANCELLED"},{videoId:b,ZW:F,offlineModeType:J})}},y0=function(F){if(!F||!F.thumbnails)return[];
var J=[];F=g.N(F.thumbnails);for(var b=F.next();!b.done;b=F.next())b=b.value,b.url&&J.push(b.url);return J},EgV=function(F,J,b){b=b===void 0?[]:b;
var I,u,w,M,q,v,a,e,K,p,m,y,f;return g.S(function(d){if(d.C==1)return b.length?g.T(d,Hb(F,J),2):d.return([]);I=d.U;u=new Set;w=g.N(I);for(M=w.next();!M.done;M=w.next())if(q=M.value,v=q.id||q.key)a=g.w0(v).entityId,u.add(a);e=[];K=g.N(b);for(p=K.next();!p.done;p=K.next())m=p.value,y=m.offlineVideoData,f=void 0,((f=y)==null?0:f.videoId)&&!u.has(y.videoId)&&e.push(m);return d.return(e)})},jNU=function(F,J,b){return new g.RH(F,{cotn:J,
raw_player_response:b,download_media:!0,start:Infinity,disable_watch_next:!0})},Gvm=function(){return{priority:1,
retryScheduleIntervalsInSeconds:[1,2,4]}},il=function(F,J,b,I,u,w,M,q,v,a,e){this.entityType=F;
this.actionId=J;this.action=b;this.parentActionId=I;this.rootActionId=u===void 0?J:u;this.childActionIds=w;this.prereqActionId=M;this.postreqActionIds=q;this.hasChildActionFailed=a;this.retryScheduleIndex=0;this.C=e||Date.now();this.retryScheduleIndex=v||0},zO=function(F){if(!F.key)throw Error("Entity key is required.");
if(!F.actionProto)throw Error("OfflineOrchestrationAction is required.");var J=g.w0(F.key),b=g.w0(F.actionProto.entityKey);return new il(b.entityType,J.entityId,F.actionProto,F.parentActionId,F.rootActionId,F.childActionIds,F.prereqActionId,F.postreqActionIds,F.retryScheduleIndex,F.hasChildActionFailed,Number(F.enqueueTimeSec)*1E3)},Nz=function(F){return{key:g.Ms(F.actionId,"offlineOrchestrationActionWrapperEntity"),
actionProto:F.action,parentActionId:F.parentActionId,rootActionId:F.rootActionId,childActionIds:F.childActionIds,prereqActionId:F.prereqActionId,postreqActionIds:F.postreqActionIds,retryScheduleIndex:F.retryScheduleIndex,hasChildActionFailed:F.hasChildActionFailed,enqueueTimeSec:(F.C/1E3).toFixed()}},VuV=function(){var F;
return g.S(function(J){return J.C==1?g.T(J,K2m(),2):(F=J.U)?J.return(F.delete("yt-player-local-img")):J.return(!0)})},ll=function(F){var J,b;
return g.S(function(I){if(I.C==1)return g.T(I,K2m(),2);if(I.C!=3){J=I.U;if(!J)throw Error("Cache API not supported");return F.length?g.T(I,J.open("yt-player-local-img"),3):I.return()}b=I.U;return g.T(I,Promise.all(F.map(function(u){return b.delete(u)})),0)})},fh=function(F){var J,b;
return g.S(function(I){if(I.C==1)return g.T(I,K2m(),2);if(I.C!=3){J=I.U;if(!J)throw Error("Cache API not supported");return F.length?g.T(I,J.open("yt-player-local-img"),3):I.return()}b=I.U;return g.T(I,b.addAll(F),0)})},WH=function(F,J,b,I,u){var w,M,q,v,a,e,K,p,m,y,f,d,G,P,r,Q,D,t,n,uk,AJ,F7,h,L,l,c,Da,fz,Kz,Vz,Za;
return g.S(function(Ib){switch(Ib.C){case 1:return w=g.Ms(F,"mainVideoEntity"),M=g.Ms(F,"ytMainChannelEntity"),q=g.Ms(F,"transfer"),v=g.Ms(F,"videoDownloadContextEntity"),g.T(Ib,ns(J,{mode:"readonly",Em:!0},function(yU){return g.fD.all([kt(yU,w,"mainVideoEntity"),kt(yU,M,"ytMainChannelEntity"),kt(yU,q,"transfer"),kt(yU,v,"videoDownloadContextEntity"),OA(yU,"ytMainChannelEntity"),OA(yU,"offlineOrchestrationActionWrapperEntity")])}),2);
case 2:a=Ib.U;e=g.N(a);K=e.next().value;p=e.next().value;m=e.next().value;y=e.next().value;f=e.next().value;d=e.next().value;G=K;P=p;r=m;Q=y;D=f;t=d;if(!G&&!P){Ib.gD(3);break}n=G?y0(G.thumbnail):[];if(!P){uk=[];Ib.gD(4);break}return g.T(Ib,Pub(P,D),5);case 5:uk=Ib.U;case 4:return AJ=uk,g.T(Ib,ll(n.concat(AJ)),3);case 3:F7=[];h=g.Ms(F,"downloadStatusEntity");L=g.N(t);for(l=L.next();!l.done;l=L.next())c=l.value,Da=g.w0(c.key).entityId,fz=zO(c),Kz=g.w0(fz.action.entityKey).entityId,Da!==F&&Kz!==F||gx(b,
c.actionProto)||F7.push(c.key);return g.T(Ib,ns(J,{mode:"readwrite",Em:!0},function(yU){var E=F7.map(function(V){return cb(yU,V)});
E.push(cb(yU,w,{MU:!0}));E.push(cb(yU,h,{MU:!0}));return g.fD.all(E)}),7);
case 7:Za=(Vz=Q)==null?void 0:Vz.offlineModeType,u&&(AO(u),u.offlineModeType&&(Za=u.offlineModeType)),mv(r,Za),wx(I,{entityKey:w,failureReason:"OFFLINE_OPERATION_FAILURE_REASON_VIDEO_DELETED"}),g.N4(Ib)}})},rWR=function(F,J,b,I){var u,w,M,q,v,a,e,K,p,m,y,f,d,G,P,r,Q,D,t,n,uk,AJ,F7,h,L,l,c,Da,fz,Kz,Vz,Za,Ib,yU,E,V,B,Y,X,JJ,wY,M4,C,ez,yz,va,rY,pz,QU,Kf;
return g.S(function(hJ){switch(hJ.C){case 1:return u=g.Ms(F,"mainPlaylistEntity"),w=g.Ms(F,"ytMainChannelEntity"),g.T(hJ,ns(J,{mode:"readonly",Em:!0},function(QI){return g.fD.all([kt(QI,u,"mainPlaylistEntity"),kt(QI,w,"ytMainChannelEntity"),OA(QI,"mainPlaylistEntity"),OA(QI,"mainDownloadsListEntity"),OA(QI,"ytMainChannelEntity"),OA(QI,"offlineOrchestrationActionWrapperEntity")])}),2);
case 2:M=hJ.U;q=g.N(M);v=q.next().value;a=q.next().value;e=q.next().value;K=q.next().value;p=q.next().value;m=q.next().value;y=v;f=a;d=e;G=K;P=p;r=m;if(!y&&!f){hJ.gD(3);break}Q=y?Bjm(y):[];if(!f){D=[];hJ.gD(4);break}return g.T(hJ,Pub(f,P),5);case 5:D=hJ.U;case 4:return t=D,g.T(hJ,ll(Q.concat(t)),3);case 3:n=[];uk=new Map;if(!y){hJ.gD(7);break}return g.T(hJ,Tjb(y,d,G),8);case 8:n=hJ.U;AJ=g.N(n);for(F7=AJ.next();!F7.done;F7=AJ.next())h=F7.value,uk.set(h,{videoId:h,playlistId:F,offlineDeleteReason:"OFFLINE_DELETE_REASON_PARENT_LIST_DELETE"});
return g.T(hJ,ns(J,{mode:"readonly",Em:!0},function(QI){return g.fD.all([OA(QI,"transfer"),OA(QI,"videoDownloadContextEntity")])}),9);
case 9:L=hJ.U;l=g.N(L);c=l.next().value;Da=l.next().value;fz=c;Kz=Da;Vz=g.N(fz);for(Za=Vz.next();!Za.done;Za=Vz.next())Ib=Za.value,yU=g.w0(Ib.key).entityId,(E=uk.get(yU))&&Ib&&(E.cotn=Ib.cotn);V=g.N(Kz);for(B=V.next();!B.done;B=V.next())Y=B.value,X=g.w0(Y.key).entityId,(JJ=uk.get(X))&&Y&&(JJ.offlineModeType=Y.offlineModeType);case 7:wY=[];M4=g.N(r);for(C=M4.next();!C.done;C=M4.next())ez=C.value,yz=g.w0(ez.key).entityId,va=zO(ez),yz!==F&&va.rootActionId!==F||gx(b,ez.actionProto)||wY.push(ez.key);rY=
g.Ms(F,"mainPlaylistEntity");return g.T(hJ,ns(J,{mode:"readwrite",Em:!0},function(QI){var qX=wY.map(function(rU){return cb(QI,rU)});
qX.push(cb(QI,rY,{MU:!0}));return g.fD.all(qX)}),10);
case 10:if(!y){hJ.gD(0);break}n.reverse();if(!n){hJ.gD(0);break}pz=g.N(n);QU=pz.next();case 13:if(QU.done){hJ.gD(0);break}Kf=QU.value;return g.T(hJ,WH(Kf,J,b,I,uk.get(Kf)),14);case 14:QU=pz.next(),hJ.gD(13)}})},sNk=function(F,J,b,I){var u,w,M,q,v,a,e,K,p;
return g.S(function(m){if(m.C==1)return u=g.Ms("DOWNLOADS_LIST_ENTITY_ID_MANUAL_DOWNLOADS","mainDownloadsListEntity"),w=new Map,g.T(m,ns(F,{mode:"readwrite",Em:!0},function(y){var f=OA(y,"transfer"),d=OA(y,"offlineOrchestrationActionWrapperEntity"),G=OA(y,"videoDownloadContextEntity"),P=kt(y,u,"mainDownloadsListEntity");return g.fD.all([f,d,G,P]).then(function(r){r=g.N(r);var Q=r.next().value;var D=r.next().value;var t=r.next().value;var n=r.next().value;r=SNW.map(function(AJ){return BfL(y,AJ)});
D=g.N(D);for(var uk=D.next();!uk.done;uk=D.next())uk=uk.value,gx(J,uk.actionProto)||r.push(cb(y,uk.key,{MU:!0}));n&&(n.downloads=[],r.push(hl(y,n,"mainDownloadsListEntity")));if(t)for(t=g.N(t),n=t.next();!n.done;n=t.next())n=n.value,D=g.w0(n.key).entityId,D=g.Ms(D,"transfer"),w.set(D,n.offlineModeType);return g.fD.all(r).then(function(){return Q})})}),2);
M=m.U;q=g.N(M);for(v=q.next();!v.done;v=q.next())a=v.value,mv(a,w.get(a.key)),e=g.w0(a.key).entityId,K={videoId:e,offlineDeleteReason:I,cotn:a.cotn,offlineModeType:w.get(a.key)},AO(K),p=g.Ms(e,"mainVideoEntity"),wx(b,{entityKey:p,failureReason:"OFFLINE_OPERATION_FAILURE_REASON_VIDEO_DELETED"});return g.T(m,VuV(),0)})},Bjm=function(F,J){var b=[];
if(F.thumbnailStyleData){F=g.N(F.thumbnailStyleData);for(var I=F.next();!I.done;I=F.next()){var u=void 0,w=void 0,M=void 0;b=b.concat(y0((u=I.value)==null?void 0:(w=u.value)==null?void 0:(M=w.collageThumbnail)==null?void 0:M.coverThumbnail))}}J=y0(J);return b.concat(J)},Tjb=function(F,J,b){var I,u,w,M,q,v,a,e,K,p,m,y,f,d,G,P,r,Q,D,t,n,uk,AJ;
return g.S(function(F7){I=[];u=new Set;if(b.length)for(w=g.N(b),M=w.next();!M.done;M=w.next())if(q=M.value,v=void 0,(v=q.downloads)==null?0:v.length)for(a=g.N(q.downloads),e=a.next();!e.done;e=a.next())K=e.value,K.videoItem&&(p=g.w0(K.videoItem).entityId,u.add(p));if(F.videos){m=g.N(F.videos);for(y=m.next();!y.done;y=m.next())f=y.value,d=JSON.parse(g.w0(f).entityId),d.videoId&&!u.has(d.videoId)&&I.push(d.videoId);G=g.N(J);for(P=G.next();!P.done;P=G.next())if(r=P.value,r.key!==F.key&&(Q=r.videos))for(D=
g.N(Q),t=D.next();!t.done;t=D.next())n=t.value,uk=JSON.parse(g.w0(n).entityId),uk.videoId&&(AJ=I.indexOf(uk.videoId),AJ!==-1&&I.splice(AJ,1))}return F7.return(I)})},Pub=function(F,J){var b,I,u,w,M,q,v,a;
return g.S(function(e){b=y0(F.avatar);I=g.N(J);for(u=I.next();!u.done;u=I.next())if(w=u.value,w.id!==F.id)for(M=g.N(y0(w.avatar)),q=M.next();!q.done;q=M.next())v=q.value,a=b.indexOf(v),a!==-1&&b.splice(a,1);return e.return(b)})},YNk=function(F){var J;
return g.S(function(b){J=g.O(F.frameworkUpdates,dx);return F.frameworkUpdates&&J?g.T(b,O_5(J),0):b.return()})},Cu1=function(F){var J;
if((J=F.onResponseReceivedActions)!=null&&J.length){var b;F=(b=g.O(g.O(F.onResponseReceivedActions[0],$Be),g.FF8))==null?void 0:b.actions;if(F!=null&&F.length)return F}},Xct=function(F){var J,b,I;
return g.S(function(u){if(u.C==1)return F?g.T(u,ZK(F,g.$E,"mainDownloadsListEntity"),2):u.return([]);J=u.U;return((b=J)==null?0:(I=b.downloads)==null?0:I.length)?u.return(J.downloads.map(function(w){var M;return(M=w.videoItem)!=null?M:""})):u.return([])})},RY1=function(F,J){var b;
return g.S(function(I){return I.C==1?g.T(I,QNb(F,J),2):(b=I.U)?g.T(I,ns(F,{mode:"readwrite",Em:!0},function(u){var w=[hl(u,b.mainDownloadsLibraryEntity,"mainDownloadsLibraryEntity")];b.mainDownloadsListEntity&&w.push(hl(u,b.mainDownloadsListEntity,"mainDownloadsListEntity"));return g.fD.all(w)}),0):I.gD(0)})},QNb=function(F,J){var b,I,u,w,M,q,v,a,e,K,p,m,y,f,d,G,P,r;
return g.S(function(Q){if(Q.C==1)return b=g.Ms("main_downloads_library_id","mainDownloadsLibraryEntity"),I=g.Ms("DOWNLOADS_LIST_ENTITY_ID_MANUAL_DOWNLOADS","mainDownloadsListEntity"),g.T(Q,ns(F,{mode:"readonly",Em:!0},function(D){return g.fD.all([kt(D,b,"mainDownloadsLibraryEntity"),kt(D,I,"mainDownloadsListEntity")])}),2);
u=Q.U;w=g.N(u);M=w.next().value;q=w.next().value;v=M;a=q;v||(v={id:b});e=g.N(J);for(K=e.next();!K.done;K=e.next())if(p=K.value,p===g.$E){if(v.smartDownloadsList)return Q.return();v.smartDownloadsList=p}else if(m=g.w0(p).entityType,y={},m==="mainPlaylistEntity"?y.playlistItem=p:m==="mainVideoEntity"&&(y.videoItem=p),!g.Vj(y)){f=void 0;if((f=a)==null?0:f.downloads){d=!1;G=g.N(a.downloads);for(P=G.next();!P.done;P=G.next())if(r=P.value,r.playlistItem===p||r.videoItem===p){d=!0;break}d||a.downloads.push(y)}else a=
{id:I,downloads:[y]};v.downloadsList=I}return Q.return({mainDownloadsLibraryEntity:v,mainDownloadsListEntity:a})})},DB8=function(F,J){var b,I,u,w,M,q,v,a,e,K,p,m,y,f,d;
return g.S(function(G){if(G.C==1)return b=g.Ms("main_downloads_library_id","mainDownloadsLibraryEntity"),I=g.Ms("DOWNLOADS_LIST_ENTITY_ID_MANUAL_DOWNLOADS","mainDownloadsListEntity"),g.T(G,ns(F,{mode:"readonly",Em:!0},function(P){return g.fD.all([kt(P,b,"mainDownloadsLibraryEntity"),kt(P,I,"mainDownloadsListEntity"),kt(P,g.$E,"mainDownloadsListEntity")])}),2);
u=G.U;w=g.N(u);M=w.next().value;q=w.next().value;v=w.next().value;a=M;e=q;K=v;if(!a)return G.gD(0);if(J===g.$E&&((p=K)==null?0:p.downloads))K.downloads=[];else if((m=e)==null?0:m.downloads)for(y=g.w0(J).entityType,f=0;f<e.downloads.length;f++)if(d=e.downloads[f],y==="mainVideoEntity"&&d.videoItem===J){e.downloads.splice(f,1);break}else if(y==="mainPlaylistEntity"&&d.playlistItem===J){e.downloads.splice(f,1);break}return g.T(G,ns(F,{mode:"readwrite",Em:!0},function(P){var r=[hl(P,a,"mainDownloadsLibraryEntity")];
e&&r.push(hl(P,e,"mainDownloadsListEntity"));K&&r.push(hl(P,K,"mainDownloadsListEntity"));return g.fD.all(r)}),0)})},EI=function(F,J){var b,I,u,w,M,q,v,a,e,K,p;
return g.S(function(m){if(m.C==1)return b=g.Ms(J,"transfer"),I=g.Ms(J,"videoDownloadContextEntity"),g.T(m,ns(F,{mode:"readonly",Em:!0},function(y){return g.fD.all([kt(y,b,"transfer"),kt(y,I,"videoDownloadContextEntity")])}),2);
u=m.U;w=g.N(u);M=w.next().value;q=w.next().value;v=M;a=q;p={videoId:J,cotn:(e=v)==null?void 0:e.cotn,offlineModeType:(K=a)==null?void 0:K.offlineModeType};return m.return(p)})},jG=function(F,J,b,I,u){var w,M,q,v,a,e,K,p,m,y,f,d,G,P,r,Q,D,t,n,uk;
return g.S(function(AJ){switch(AJ.C){case 1:return w=g.Ms(F,"musicTrack"),M=g.Ms(F,"transfer"),g.T(AJ,ns(J,{mode:"readonly",Em:!0},function(F7){return g.fD.all([kt(F7,w,"musicTrack"),kt(F7,M,"transfer"),OA(F7,"musicTrack"),OA(F7,"offlineOrchestrationActionWrapperEntity")])}),2);
case 2:q=AJ.U;v=g.N(q);a=v.next().value;e=v.next().value;K=v.next().value;p=v.next().value;m=a;y=e;f=K;d=p;if(!m){AJ.gD(3);break}return g.T(AJ,kvt(m,f),4);case 4:return G=AJ.U,g.T(AJ,ll(G),3);case 3:P=[];r=g.N(d);for(Q=r.next();!Q.done;Q=r.next())D=Q.value,t=g.w0(D.key).entityId,n=zO(D),uk=g.w0(n.action.entityKey).entityId,t!==F&&uk!==F||gx(b,D.actionProto)||P.push(D.key);return g.T(AJ,ns(J,{mode:"readwrite",Em:!0},function(F7){var h=P.map(function(L){return cb(F7,L)});
h.push(cb(F7,w,{MU:!0}));return g.fD.all(h)}),6);
case 6:mv(y),u&&AO(u),wx(I,{entityKey:w,failureReason:"OFFLINE_OPERATION_FAILURE_REASON_VIDEO_DELETED"}),g.N4(AJ)}})},GO=function(F,J,b,I,u){var w,M,q,v,a,e,K,p,m,y,f,d,G,P,r,Q,D,t,n,uk,AJ,F7,h,L,l,c,Da,fz,Kz,Vz,Za,Ib,yU,E,V,B;
return g.S(function(Y){switch(Y.C){case 1:return w=g.Ms(F,J),M=g.Ms("music_downloads_library_id","musicDownloadsLibraryEntity"),g.T(Y,ns(b,{mode:"readonly",Em:!0},function(X){return g.fD.all([kt(X,w,J),kt(X,M,"musicDownloadsLibraryEntity"),OA(X,J),OA(X,"offlineOrchestrationActionWrapperEntity")])}),2);
case 2:q=Y.U;v=g.N(q);a=v.next().value;e=v.next().value;K=v.next().value;p=v.next().value;m=a;y=e;f=K;d=p;if(!m){Y.gD(3);break}return g.T(Y,kvt(m,f),4);case 4:return G=Y.U,g.T(Y,ll(G),3);case 3:P=[];r=new Map;if(!m){Y.gD(6);break}return g.T(Y,OLz(m,f,y),7);case 7:P=Y.U;Q=g.N(P);for(D=Q.next();!D.done;D=Q.next())t=D.value,n=g.w0(t).entityId,r.set(n,{videoId:n,playlistId:F,offlineDeleteReason:"OFFLINE_DELETE_REASON_PARENT_LIST_DELETE"});return g.T(Y,Hb(b,"transfer"),8);case 8:for(uk=Y.U,AJ=g.N(uk),
F7=AJ.next();!F7.done;F7=AJ.next())h=F7.value,L=g.w0(h.key).entityId,(l=r.get(L))&&h&&(l.cotn=h.cotn);case 6:c=[];Da=g.N(d);for(fz=Da.next();!fz.done;fz=Da.next())Kz=fz.value,Vz=g.w0(Kz.key).entityId,Za=zO(Kz),Vz!==F&&Za.rootActionId!==F||gx(I,Kz.actionProto)||c.push(Kz.key);Ib=g.Ms(F,J);return g.T(Y,ns(b,{mode:"readwrite",Em:!0},function(X){var JJ=c.map(function(wY){return cb(X,wY)});
JJ.push(cb(X,Ib,{MU:!0}));return g.fD.all(JJ)}),9);
case 9:if(!m){Y.gD(0);break}P.reverse();if(!P.length){Y.gD(0);break}yU=g.N(P);E=yU.next();case 12:if(E.done){Y.gD(0);break}V=E.value;B=g.w0(V).entityId;if(!B){Y.gD(13);break}return g.T(Y,jG(B,b,I,u,r.get(B)),13);case 13:E=yU.next(),Y.gD(12)}})},V0=function(F,J,b){var I,u,w,M,q,v,a;
return g.S(function(e){if(e.C==1)return g.T(e,ns(F,{mode:"readwrite",Em:!0},function(K){var p=OA(K,"transfer"),m=OA(K,"offlineOrchestrationActionWrapperEntity");return g.fD.all([p,m]).then(function(y){y=g.N(y);var f=y.next().value;var d=y.next().value;y=ogL.map(function(Q){return BfL(K,Q)});
d=g.N(d);for(var G=d.next();!G.done;G=d.next()){G=G.value;var P=g.w0(G.actionProto.entityKey).entityType==="musicTrack",r=G.actionProto.actionType==="OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD";gx(J,G.actionProto)||P&&(!P||r)||y.push(cb(K,G.key,{MU:!0}))}return g.fD.all(y).then(function(){return f})})}),2);
I=e.U;u=g.N(I);for(w=u.next();!w.done;w=u.next())M=w.value,mv(M),q=g.w0(M.key).entityId,v={videoId:q,offlineDeleteReason:void 0,cotn:M.cotn},AO(v),a=g.Ms(q,"musicTrack"),wx(b,{entityKey:a,failureReason:"OFFLINE_OPERATION_FAILURE_REASON_VIDEO_DELETED"});return g.T(e,VuV(),0)})},hYk=function(F){for(var J,b=g.N(F.additionalMetadatas),I=b.next();!I.done;I=b.next())I=I.value,I.offlineMusicVideoData&&(J=I.offlineMusicVideoData);
var u,w,M,q,v;return{id:g.Ms(F.videoId,"musicTrack"),videoId:F.videoId,title:F.title,thumbnailDetails:F.thumbnail,lengthMs:String(Number(F.lengthSeconds)*1E3),albumTitle:(u=J)==null?void 0:u.releaseTitle,musicVideoType:(w=J)==null?void 0:w.musicVideoType,contentRating:{explicitType:(M=J)==null?void 0:M.explicitType},artistNames:((q=J)==null?void 0:q.byline)||((v=J)==null?void 0:v.channelName),downloadMetadata:g.Ms(F.videoId,"musicTrackDownloadMetadataEntity")}},OLz=function(F,J,b){var I,u,w,M,q,v,
a,e,K,p,m,y,f,d,G,P,r,Q;
return g.S(function(D){I=[];u=new Set;if((w=b)==null?0:(M=w.downloadedTracks)==null?0:M.length)for(q=g.N(b.downloadedTracks),v=q.next();!v.done;v=q.next())a=v.value,u.add(a);if(F.tracks){e=g.N(F.tracks);for(K=e.next();!K.done;K=e.next())p=K.value,u.has(p)||I.push(p);m=g.N(J);for(y=m.next();!y.done;y=m.next())if(f=y.value,f.id!==F.id&&(d=f.tracks))for(G=g.N(d),P=G.next();!P.done;P=G.next())r=P.value,Q=I.indexOf(r),Q!==-1&&I.splice(Q,1)}return D.return(I)})},kvt=function(F,J){var b,I,u,w,M,q,v,a;
return g.S(function(e){b=y0(F.thumbnailDetails);I=g.N(J);for(u=I.next();!u.done;u=I.next())if(w=u.value,w.id!==F.id)for(M=g.N(y0(w.thumbnailDetails)),q=M.next();!q.done;q=M.next())v=q.value,a=b.indexOf(v),a!==-1&&b.splice(a,1);return e.return(b)})},cWU=function(F,J){var b,I,u,w,M,q,v,a,e;
return g.S(function(K){if(K.C==1)return b=g.Ms("music_downloads_library_id","musicDownloadsLibraryEntity"),g.T(K,ZK(F,b,"musicDownloadsLibraryEntity"),2);(I=K.U)||(I={id:b});u=g.w0(J).entityType;u==="musicTrack"?(w=I.downloadedTracks)!=null&&w.includes(J)||(I.downloadedTracks=((M=I.downloadedTracks)!=null?M:[]).concat(J)):u==="musicPlaylist"?(q=I.downloadedPlaylists)!=null&&q.includes(J)||(I.downloadedPlaylists=((v=I.downloadedPlaylists)!=null?v:[]).concat(J)):u!=="musicAlbumRelease"||(a=I.downloadedAlbumReleases)!=
null&&a.includes(J)||(I.downloadedAlbumReleases=((e=I.downloadedAlbumReleases)!=null?e:[]).concat(J));return g.T(K,tl(F,I,"musicDownloadsLibraryEntity"),0)})},UBV=function(F,J){var b,I,u,w,M,q,v;
return g.S(function(a){if(a.C==1)return b=g.Ms("music_downloads_library_id","musicDownloadsLibraryEntity"),g.T(a,ZK(F,b,"musicDownloadsLibraryEntity"),2);I=a.U;if(!I)return a.gD(0);u=g.w0(J).entityType;u==="musicTrack"?w=I.downloadedTracks:u==="musicPlaylist"&&(w=I.downloadedPlaylists);if((M=w)==null?0:M.length)for(q=0;q<w.length;q++)if(v=w[q],v===J){w.splice(q,1);break}return g.T(a,tl(F,I,"musicDownloadsLibraryEntity"),0)})},xBb=function(F){var J=F.videos;
F=[];var b=[];if(J){J=g.N(J);for(var I=J.next();!I.done;I=J.next()){var u=I.value.offlineVideoData.videoId;I=g.Ms(u,"musicTrack");u=g.Ms(u,"musicTrackDownloadMetadataEntity");F.push(I);b.push(u)}}return{cU:F,mM:b}},PH=function(F,J,b){J={track:hYk(J)};
b&&(J.playlistId=b);if(F=g.O(F.actionMetadata,ngb))J.maximumDownloadQuality=F.maximumDownloadQuality;return{musicTrackEntityActionMetadata:J}},ZL5=function(F){var J,b,I,u,w,M,q,v;
return g.S(function(a){switch(a.C){case 1:return J=g.IW(),b=Z_b(F),I=g.ZI(tuH),g.lk(a,2),w={m5:!0},g.T(a,g.cf(J,b,I,void 0,w),4);case 4:u=a.U;g.Wa(a,3);break;case 2:M=g.dY(a);if(M instanceof g.FS)throw q="GetOffline network manager error: "+M.message,I_(q,M),Error(q);I_("GetOffline fetch request error",M);throw Error("GetOffline fetch request error");case 3:v=BH(u);if(!u)throw I_("Network request failed"),Error("Network request failed");if(v!==void 0)TO(v);else if(!u.videos||!u.videos.length)throw I_("No data"),
Error("No data");return a.return(u.videos.map(function(e){return e.offlineVideoData}))}})},HL1=function(F){var J,b,I,u,w,M,q,v;
return g.S(function(a){switch(a.C){case 1:return J=g.IW(),b=H_m(F),I=g.ZI(tuH),g.lk(a,2),w={m5:!0},g.T(a,g.cf(J,b,I,void 0,w),4);case 4:u=a.U;g.Wa(a,3);break;case 2:M=g.dY(a);if(M instanceof g.FS)throw q="GetOffline network manager error for playlist: "+M.message,I_(q,M),Error(q);I_("GetOffline fetch request error for playlist",M);throw Error("GetOffline fetch request error for playlist");case 3:v=BH(u);if(!u)throw I_("Network request failed for playlist"),Error("Network request failed for playlist");
if(v!==void 0)TO(v,"playlist");else if(!u.playlists||!u.playlists.length)throw I_("No data for playlist"),Error("No data for playlist");return a.return(u.playlists.map(function(e){return e.offlinePlaylistData}))}})},Fat=function(F,J,b,I){var u,w,M,q,v,a,e,K,p,m,y,f,d,G,P,r,Q,D,t,n,uk,AJ,F7,h,L,l,c,Da,fz,Kz;
return g.S(function(Vz){switch(Vz.C){case 1:return g.T(Vz,Ls(),2);case 2:u=Vz.U;if(!u)return Vz.return([]);w=[];if((M=I)==null?0:M.length){w=I;Vz.gD(3);break}return g.T(Vz,Hb(u,"mainPlaylistEntity"),4);case 4:w=Vz.U;case 3:if(!w.length)return Vz.return([]);q=[];v=Date.now()/1E3;a=g.N(w);e=a.next();case 5:if(e.done)return q.length?g.T(Vz,L2t(q),10):Vz.return([]);K=e.value;if(!K.downloadState){p=void 0;Vz.gD(8);break}return g.T(Vz,ZK(u,K.downloadState,"mainPlaylistDownloadStateEntity"),9);case 9:p=
Vz.U;case 8:m=p;y=void 0;d=(f=(y=K)==null?void 0:y.entityMetadata)&&f.nextAutoRefreshIntervalSeconds?Number(f.nextAutoRefreshIntervalSeconds):NaN;G=Number.isNaN(d)?F:d;r=P=void 0;Q=((P=m)==null?0:P.lastSyncedTimestampMillis)?Number((r=m)==null?void 0:r.lastSyncedTimestampMillis)/1E3:0;t=D=void 0;n=((D=m)==null?0:D.addedTimestampMillis)?Number((t=m)==null?void 0:t.addedTimestampMillis)/1E3:0;if(b||!f||Q+G<=v){uk=[];AJ=void 0;if((AJ=K.videos)==null?0:AJ.length)for(F7=g.N(K.videos),h=F7.next();!h.done;h=
F7.next())L=h.value,l=JSON.parse(g.w0(L).entityId),l.videoId&&uk.push(l.videoId);c="0";f&&(Da=void 0,c=String(Number((Da=f.offlineLastModifiedTimestampSeconds)!=null?Da:0).toFixed()));fz={playlistId:K.playlistId,videoIds:uk,offlineLastModifiedTimestamp:c,autoSync:J,offlineDateAddedTimestamp:String(n.toFixed())};q.push(fz)}e=a.next();Vz.gD(5);break;case 10:return Kz=Vz.U,Vz.return(Kz)}})},JS5=function(){var F,J,b,I,u;
return g.S(function(w){if(w.C==1)return g.T(w,Ls(),2);if(w.C!=3)return(F=w.U)?g.T(w,Hb(F,"refresh"),3):w.return(!1);J=w.U;if((b=J[0])==null||!b.refreshTime)return w.return(!1);I=Number(J[0].refreshTime);u=Date.now()/1E3;return w.return(isFinite(I)&&u>=I)})},ISL=function(F,J){var b,I,u;
return g.S(function(w){switch(w.C){case 1:return g.lk(w,2),g.T(w,bqm(F,J),4);case 4:return I=w.U,g.T(w,YNk(I),5);case 5:b=Cu1(I);g.Wa(w,3);break;case 2:u=g.dY(w),I_("getAndProcessSmartDownloadsResponse request or processing error",u);case 3:return w.return(b)}})},uLL=function(F,J,b,I){var u,w,M,q,v,a,e,K,p,m,y,f,d,G,P,r,Q,D,t,n,uk,AJ,F7,h,L,l,c,Da,fz,Kz;
return g.S(function(Vz){switch(Vz.C){case 1:return g.T(Vz,Ls(),2);case 2:u=Vz.U;if(!u)return Vz.return([]);w=[];if((M=I)==null?0:M.length){w=I;Vz.gD(3);break}return g.T(Vz,Hb(u,"musicPlaylist"),4);case 4:w=Vz.U;case 3:if(!w.length)return Vz.return([]);q=[];v=Date.now()/1E3;a=g.N(w);e=a.next();case 5:if(e.done)return q.length?g.T(Vz,L2t(q),10):Vz.return([]);K=e.value;p=void 0;y=(m=(p=K)==null?void 0:p.entityMetadata)&&m.nextAutoRefreshIntervalSeconds?Number(m.nextAutoRefreshIntervalSeconds):NaN;f=
Number.isNaN(y)?F:y;G=d=0;P="DOWNLOAD_SYNC_STATE_UNKNOWN";if(!K.downloadMetadata){Vz.gD(8);break}return g.T(Vz,ZK(u,K.downloadMetadata,"musicPlaylistDownloadMetadataEntity"),9);case 9:r=Vz.U,D=Q=void 0,d=Number((D=(Q=r)==null?void 0:Q.addedTimestampMillis)!=null?D:"0")/1E3,n=t=void 0,G=Number((n=(t=r)==null?void 0:t.lastModifiedTimestampMillis)!=null?n:"0")/1E3,AJ=uk=void 0,P=(AJ=(uk=r)==null?void 0:uk.syncState)!=null?AJ:"DOWNLOAD_SYNC_STATE_UNKNOWN";case 8:F7=void 0;if(b||P!=="DOWNLOAD_SYNC_STATE_UP_TO_DATE"||
!m||Number((F7=m.lastSyncedTimestampSeconds)!=null?F7:0)+f<=v){h=[];L=void 0;if((L=K.tracks)==null?0:L.length)for(l=g.N(K.tracks),c=l.next();!c.done;c=l.next())Da=c.value,h.push(g.w0(Da).entityId);fz={playlistId:K.playlistId,videoIds:h,offlineLastModifiedTimestamp:String(G.toFixed()),autoSync:J,offlineDateAddedTimestamp:String(d.toFixed())};q.push(fz)}e=a.next();Vz.gD(5);break;case 10:return Kz=Vz.U,Vz.return(Kz)}})},bqm=function(F,J){var b,I,u,w,M,q,v,a,e,K;
return g.S(function(p){switch(p.C){case 1:return b=g.IW(),g.T(p,Ls(),2);case 2:I=p.U;if(!I){p.gD(3);break}return g.T(p,wcb(I),4);case 4:u=p.U;case 3:var m=u;w={context:g.UV(),browseId:"FEdownloads",browseRequestSupportedMetadata:{downloadsBrowseParams:{offlineFeatureSettingState:{isSdEnabled:F},offlineClientState:m,clientStateRequestData:{preferredFormatType:J}}}};M=g.ZI(w2L);g.lk(p,5);v={m5:!0};return g.T(p,g.cf(b,w,M,void 0,v),7);case 7:q=p.U;g.Wa(p,6);break;case 5:a=g.dY(p);if(a instanceof g.FS)throw e=
"DPS network manager error for smart downloads: "+a.message,I_(e,a),Error(e);I_("DPS fetch request error for smart downloads",a);throw Error("DPS fetch request error for smart downloads");case 6:K=BH(q);if(q)K!==void 0&&TO(K,"smart downloads");else throw I_("Network request failed for smart downloads"),Error("Network request failed for smart downloads");return p.return(q)}})},ASW=function(F,J){var b,I,u,w,M,q,v,a;
return g.S(function(e){switch(e.C){case 1:return b=g.IW(),I={context:g.UV(),videoPlaybackPositionEntities:F,lastSyncTimestampUsec:J},u=g.ZI(M7z),g.lk(e,2),M={m5:!0},g.T(e,g.cf(b,I,u,void 0,M),4);case 4:w=e.U;g.Wa(e,3);break;case 2:q=g.dY(e);if(q instanceof g.FS)throw v="VPPS network manager error: "+q.message,I_(v,q),Error(v);I_("VPPS fetch request error",q);throw Error("VPPS fetch request error");case 3:a=BH(w);if(w)a!==void 0&&TO(a,"position sync");else throw I_("Network request failed for position sync"),
Error("Network request failed for position sync");return e.return(w)}})},vR1=function(F,J,b){var I,u,w,M,q,v,a,e;
return g.S(function(K){switch(K.C){case 1:I=g.IW();var p=b.refreshData,m=b.isEnqueuedForExpiredStreamUrlRefetch,y=b.l9,f=b.offlineSourceData,d=b.mediaCapabilities,G={entityKey:F};p&&(G.refreshData=p);m&&(G.isExpiredStreamUrlRefetch=m);y&&(G.downloadParameters=y);f&&(G.offlineSourceData=f);p={context:g.LY(J),signatureTimestamp:20138,videos:[G]};d&&(p.mediaCapabilities=d);u=p;w=g.ZI(q0V);g.lk(K,2);q={m5:!0};return g.T(K,g.cf(I,u,w,void 0,q),4);case 4:M=K.U;g.Wa(K,3);break;case 2:v=g.dY(K);if(v instanceof
g.FS)throw a="GetPDE network manager error: "+v.message,I_(a,v),Error(a);I_("GetPDE fetch request error",v);throw Error("GetPDE fetch request error");case 3:e=BH(M);if(M)e!==void 0&&TO(e,"PDE");else throw I_("Network request failed for PDE"),Error("Network request failed for PDE");return K.return(M)}})},BH=function(F){var J;
return(J=F.errorMetadata)==null?void 0:J.status},TO=function(F,J){J=J?" for "+J:"";
if(F===0)throw F="Empty response body"+J,I_(F),Error(F);F="Response with error"+J;I_(F);throw Error(F);},L2t=function(F){var J,b,I,u,w,M,q,v;
return g.S(function(a){switch(a.C){case 1:return J=g.IW(),b=Lx8(F),I=g.ZI(aSt),g.lk(a,2),w={m5:!0},g.T(a,g.cf(J,b,I,void 0,w),4);case 4:u=a.U;g.Wa(a,3);break;case 2:M=g.dY(a);if(M instanceof g.FS)throw q="offlinePlaylistSyncCheck network manager error: "+M.message,I_(q,M),Error(q);I_("offlinePlaylistSyncCheck fetch request error",M);throw Error("offlinePlaylistSyncCheck fetch request error");case 3:v=BH(u);if(!u)throw I_("Network request failed for playlist sync"),Error("Network request failed for playlist sync");
if(v!==void 0)TO(v,"playlist sync");else if(!u.offlinePlaylistSyncCheckDatas||!u.offlinePlaylistSyncCheckDatas.length)throw I_("No data for playlist sync"),Error("No data for playlist sync");return a.return(u.offlinePlaylistSyncCheckDatas.map(function(e){return e.offlinePlaylistSyncCheckData}))}})},rx=function(F){this.C=F},e81=function(F,J){var b,I,u,w,M,q;
return g.S(function(v){switch(v.C){case 1:b=new Map,I=g.N(J),u=I.next();case 2:if(u.done){v.gD(4);break}w=u.value;M=b;q=M.set;return g.T(v,F.U(w),5);case 5:q.call(M,w,v.U);u=I.next();v.gD(2);break;case 4:return v.return(b)}})},SG=function(F,J,b,I,u,w){J=g.Ms(J,b);
I=Object.assign({},w,{priority:I,retryScheduleIntervalsInSeconds:u});return{actionType:F,entityKey:J,actionMetadata:I}},sI=function(F,J,b,I,u,w){this.status=F;
this.C=J;this.Z=b;this.U=I;this.T=u;this.downloadState=w},KaL=function(F,J,b){this.C=F;
this.rD=J;this.T=b},mN5=function(F,J){var b,I,u,w,M,q,v,a,e;
return g.S(function(K){switch(K.C){case 1:return b=J.entityKey,u=(I=g.O(J.actionMetadata,Yh))==null?void 0:I.isEnqueuedForExpiredStreamUrlRefetch,g.lk(K,2),w=void 0,g.T(K,p2U(F,J),4);case 4:w=K.U;g.lk(K,5);var p=(p=g.O(J.actionMetadata,Yh))?{maximumDownloadQuality:p.maximumDownloadQuality}:void 0;return g.T(K,vR1(b,F.rD,{isEnqueuedForExpiredStreamUrlRefetch:u,l9:p,offlineSourceData:w}),7);case 7:M=K.U;g.Wa(K,6,2);break;case 5:return g.dY(K,2),q=vH(J)?"OFFLINE_ORCHESTRATION_FAILURE_REASON_RECOVERABLE_NETWORK_ERROR":
"OFFLINE_ORCHESTRATION_FAILURE_REASON_UNRECOVERABLE_NETWORK_ERROR",I_("PDE handleAdd error"),K.return($h(J,!1,void 0,"OFFLINE_OPERATION_FAILURE_REASON_NETWORK_REQUEST_FAILED",q,"DOWNLOAD_STATE_FAILED"));case 6:return g.T(K,gRV(F,M,J),8);case 8:return K.return($h(J,!0,M.orchestrationActions));case 2:return v=g.dY(K),a="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",e="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",v instanceof g.gZ&&v.type==="QUOTA_EXCEEDED"&&(a="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",
e="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),I_("PDE handleAdd error"),K.return($h(J,!1,void 0,a,e,"DOWNLOAD_STATE_FAILED"))}})},z8L=function(F,J){var b,I,u,w,M,q,v,a,e,K,p,m,y,f,d,G,P,r,Q,D,t,n,uk,AJ;
return g.S(function(F7){switch(F7.C){case 1:return b=J.entityKey,I=g.w0(b).entityId,g.T(F7,ns(F.C,{mode:"readonly",Em:!0},function(h){var L=kt(h,b,"playbackData"),l=kt(h,g.Ms(I,"offlineVideoPolicy"),"offlineVideoPolicy");h=kt(h,g.Ms(I,"transfer"),"transfer");return g.fD.all([L,l,h])}),2);
case 2:u=F7.U;w=g.N(u);M=w.next().value;q=w.next().value;v=w.next().value;a=M;e=q;K=v;if(!a||!e)return F7.return($h(J,!0));p=[];f=((y=a)==null?0:y.playerResponseJson)?JSON.parse(a.playerResponseJson):null;if(!(K&&f&&F.rD.S("html5_refresh_deprecated_downloads"))){F7.gD(3);break}m=ySb(F,f,K);return g.T(F7,iqz(F,K),4);case 4:p=F7.U;case 3:d={lastPlayerResponseTimestampSeconds:a.playerResponseTimestamp,offlineToken:e.offlineToken,formatIds:p};G={};if((P=K)==null?0:P.maximumDownloadQuality)G.maximumDownloadQuality=
K.maximumDownloadQuality;g.lk(F7,5);r=void 0;return g.T(F7,p2U(F,J),7);case 7:return r=F7.U,g.lk(F7,8),g.T(F7,vR1(b,F.rD,{refreshData:d,l9:G,offlineSourceData:r,mediaCapabilities:m}),10);case 10:Q=F7.U;g.Wa(F7,9,5);break;case 8:return g.dY(F7,5),D=vH(J)?"OFFLINE_ORCHESTRATION_FAILURE_REASON_RECOVERABLE_NETWORK_ERROR":"OFFLINE_ORCHESTRATION_FAILURE_REASON_UNRECOVERABLE_NETWORK_ERROR",I_("PDE handleRefresh error"),F7.return($h(J,!1,void 0,"OFFLINE_OPERATION_FAILURE_REASON_NETWORK_REQUEST_FAILED",D,
"DOWNLOAD_STATE_FAILED"));case 9:return g.T(F7,gRV(F,Q,J),11);case 11:return F7.return($h(J,!0,Q.orchestrationActions));case 5:return t=g.dY(F7),n="PDE handleRefresh error",t instanceof Error&&(n="PDE handleRefresh error: "+t.message),uk="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",AJ="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",t instanceof g.gZ&&t.type==="QUOTA_EXCEEDED"&&(uk="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",AJ="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),
I_(n),F7.return($h(J,!1,void 0,uk,AJ,"DOWNLOAD_STATE_FAILED"))}})},p2U=function(F,J){var b,I,u,w;
return g.S(function(M){if(M.C==1)return b=g.w0(J.entityKey).entityId,I=g.Ms(b,"videoDownloadContextEntity"),g.T(M,ZK(F.C,I,"videoDownloadContextEntity"),2);u=M.U;return(w=u)!=null&&w.offlineModeType?M.return({offlineModeType:u.offlineModeType}):M.return(void 0)})},gRV=function(F,J,b){var I,u,w,M,q;
return g.S(function(v){if(v.C==1){if(!J.frameworkUpdates||!g.O(J.frameworkUpdates,dx))return v.return();if(!(g.O(J.frameworkUpdates,dx).mutations&&g.O(J.frameworkUpdates,dx).mutations.length>0&&g.O(J.frameworkUpdates,dx).mutations[0].type==="ENTITY_MUTATION_TYPE_DELETE"))return v.gD(2);I=g.w0(g.O(J.frameworkUpdates,dx).mutations[0].entityKey).entityId;return g.T(v,EI(F.C,I),3)}if(v.C!=2){u=v.U;w=g.O(b.actionMetadata,Yh);if(q=(M=w)==null?void 0:M.playlistId)u.playlistId=q;u.offlineDeleteReason="OFFLINE_DELETE_REASON_UNKNOWN";
return g.hP(F.rD)?g.T(v,WH(I,F.C,b,F.T,u),2):g.sV(F.rD)?g.T(v,jG(I,F.C,b,F.T),2):v.gD(2)}return g.T(v,O_5(g.O(J.frameworkUpdates,dx)),0)})},$h=function(F,J,b,I,u,w){return new sI(J?"OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS":"OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",vH(F),b,I,u,w)},ySb=function(F,J,b){J=jNU(F.rD,b.cotn,J);
b=g.IU(J);return g.B_G(J,b,F.rD)},iqz=function(F,J){var b,I,u,w,M,q,v,a,e,K,p;
return g.S(function(m){if(m.C==1)return b=[],g.T(m,ns(F.C,{mode:"readonly",Em:!0},function(y){var f=[],d=J.offlineVideoStreams;if(d){d=g.N(d);for(var G=d.next();!G.done;G=d.next())f.push(kt(y,G.value,"offlineVideoStreams"))}return g.fD.all(f)}),2);
if(I=m.U)for(u=g.N(I),w=u.next();!w.done;w=u.next())if(M=w.value,q=void 0,(q=M)==null?0:q.streamsProgress)for(v=M.streamsProgress,a=0;a<v.length;a++)e=v[a],K=JSON.parse(e.formatStreamBytes),p={itag:K.itag,lmt:K.lastModified,xtags:K.xtags},b.push(p);return m.return(b)})},N2R=function(F,J){this.C=F;
this.rD=J},lSe=function(F,J){var b,I,u,w,M,q,v,a,e,K,p,m;
return g.S(function(y){switch(y.C){case 1:return b=vH(J),g.T(y,Hb(F.C,"videoPlaybackPositionEntity"),2);case 2:I=y.U;if(I.length===0)return y.return(new sI("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",b));g.lk(y,3);return g.T(y,QQ.getInstance(),5);case 5:u=y.U;if(!u)throw Error("prefStorage is undefined");return g.T(y,u.get("psi"),6);case 6:return w=y.U,v=(q=(M=w)==null?void 0:M.OF)!=null?q:"0",g.T(y,ASW(I,v),7);case 7:return a=y.U,e={isPaused:a.watchHistoryPaused,OF:a.syncTimestampUsec},g.T(y,u.set("psi",
e),8);case 8:if(e.isPaused){y.gD(9);break}K=g.O(a.frameworkUpdates,dx);if(!a.frameworkUpdates||!K){y.gD(9);break}return g.T(y,O_5(K),9);case 9:g.Wa(y,4);break;case 3:return p=g.dY(y),m="PPE handleRefresh error: "+(p instanceof Error?p.message:"unknown error"),I_(m),y.return(new sI("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",b,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 4:return y.return(new sI("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
b))}})},Wa1=function(F,J){var b,I,u,w,M,q,v,a;
return g.S(function(e){switch(e.C){case 1:return b=vH(J),I=g.w0(J.entityKey).entityId,g.lk(e,2),g.T(e,QQ.getInstance(),4);case 4:u=e.U;if(!u)throw Error("prefStorage is undefined");return g.T(e,u.get("psi"),5);case 5:w=e.U;M=g.O(J.actionMetadata,fSH);if(((q=w)==null?void 0:q.isPaused)!==!1||(v=M)==null||!v.lastPlaybackPositionSeconds){e.gD(6);break}a={key:g.Ms(I,"videoPlaybackPositionEntity"),videoId:I,lastPlaybackPositionSeconds:M.lastPlaybackPositionSeconds};return g.T(e,tl(F.C,a,"videoPlaybackPositionEntity"),
6);case 6:g.Wa(e,3);break;case 2:return g.dY(e),e.return(new sI("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",b,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 3:return e.return(new sI("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",b))}})},dNb=function(F,J){var b,I,u;
return g.S(function(w){switch(w.C){case 1:b=vH(J);g.lk(w,2);I=g.w0(J.entityKey).entityId;if(I==="!*$_ALL_ENTITIES_!*$")return g.T(w,XYb(F.C),5);u=g.Ms(I,"videoPlaybackPositionEntity");return g.T(w,CT1(F.C,u),5);case 5:g.Wa(w,3);break;case 2:return g.dY(w),w.return(new sI("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",b,void 0,"OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 3:return w.return(new sI("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
b))}})},ERR=function(F,J){this.api=F;
this.C=J;this.logger=new g.Hl("woffle");this.U=!1;this.Po={jt:this.jt};this.logger.debug("Initialized OfflineMediaManager")},j8L=function(F){return g.S(function(J){return J.return(twt(F))})},GZW=function(F){var J;
return g.S(function(b){if(b.C==1)return g.T(b,g.Fek(F),2);J=b.U;return b.return(J.filter(function(I){return!!I.url}).map(function(I){return I.url}))})},Ch=function(F,J){var b=g.E9(J);
if(b===1||b===0)return Promise.resolve();(b=V7R(F,J))&&b.stopVideo();F.T=0;return j8L(J)},XM=function(F,J,b,I){b=b===void 0?!1:b;
I=I===void 0?!0:I;var u=typeof J==="string"?J:J.videoDetails.videoId;g.E9(u)===2&&((J=V7R(F,u))?J.stopVideo():F.logger.info(function(){return"Corresponding player for "+u+" not found. Pausing anyway"}),g.jE(u,2),F.T=2,b?PRV(F.C):I&&B2U(F.C))},V7R=function(F,J){var b;
return((b=F.player)==null?void 0:b.getVideoData().videoId)===J?F.player:null},T25=function(F,J,b){J.getPlayerResponse();
g.jE(J.videoId,2);F.T=2;F.U=!1;var I;(I=F.player)==null||I.dispose();F.player=F.api.v$(J);J={};F.player.Sn((J.localmediachange=F.N8,J.signatureexpired=F.Hv,J.statechange=F.WnQ,J),F);var u=F.jt(b);F.player.kE(g.HX(u,u,!0,"m"),!1);F.logger.debug(function(){return"Starting headless playback with quality: "+u});
F.player.PE(!1)},rSb=function(F,J){this.C=F;
this.rD=J},s85=function(F,J){var b,I;
return g.S(function(u){switch(u.C){case 1:return b=vH(J),g.T(u,ZK(F.C,J.entityKey,"transfer"),2);case 2:if(I=u.U)return u.return(new sI("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",b));g.lk(u,3);return g.T(u,S01(F,J),5);case 5:g.Wa(u,4);break;case 3:return g.dY(u),u.return(new sI("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",b,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 4:return u.return(new sI("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
b))}})},Y0m=function(F,J){var b,I;
return g.S(function(u){switch(u.C){case 1:return b=vH(J),g.T(u,ZK(F.C,J.entityKey,"transfer"),2);case 2:I=u.U;if(!I||I.transferState!=="TRANSFER_STATE_COMPLETE")return u.return(new sI("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",b));g.lk(u,3);return g.T(u,S01(F,J,!0),5);case 5:g.Wa(u,4);break;case 3:return g.dY(u),u.return(new sI("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",b,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));
case 4:return u.return(new sI("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",b))}})},$NU=function(F,J){var b,I,u,w,M,q,v,a,e,K;
return g.S(function(p){switch(p.C){case 1:return b=vH(J),I=g.w0(J.entityKey).entityId,g.T(p,ns(F.C,{mode:"readonly",Em:!0},function(m){var y=kt(m,J.entityKey,"transfer");m=kt(m,g.Ms(I,"videoDownloadContextEntity"),"videoDownloadContextEntity");return g.fD.all([y,m])}),2);
case 2:u=p.U;w=g.N(u);M=w.next().value;q=w.next().value;v=M;a=q;if(!v||v.transferState!=="TRANSFER_STATE_WAITING_FOR_PLAYER_RESPONSE_REFRESH")return p.return(new sI("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",b));g.lk(p,3);v.transferState="TRANSFER_STATE_TRANSFER_IN_QUEUE";return g.T(p,tl(F.C,v,"transfer"),5);case 5:e=g.w0(v.key).entityId;qz({transferStatusType:"TRANSFER_STATUS_TYPE_REENQUEUED_BY_PLAYER_RESPONSE_REFRESH"},{videoId:e,ZW:v,offlineModeType:(K=a)==null?void 0:K.offlineModeType});g.Wa(p,
4);break;case 3:return g.dY(p),p.return(new sI("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",b,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 4:return p.return(new sI("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",b))}})},S01=function(F,J,b){b=b===void 0?!1:b;
var I,u,w,M,q,v,a,e,K,p,m,y,f,d,G;return g.S(function(P){switch(P.C){case 1:return I=g.O(J.actionMetadata,CRe),u=g.w0(J.entityKey).entityId,w=g.Ms(u,"downloadStatusEntity"),g.T(P,ns(F.C,{mode:"readonly",Em:!0},function(r){var Q=kt(r,w,"downloadStatusEntity");r=kt(r,g.Ms(u,"videoDownloadContextEntity"),"videoDownloadContextEntity");return g.fD.all([Q,r])}),2);
case 2:return M=P.U,q=g.N(M),v=q.next().value,a=q.next().value,e=v,K=a,p="TRANSFER_STATE_TRANSFER_IN_QUEUE",((m=e)==null?void 0:m.downloadState)==="DOWNLOAD_STATE_USER_DELETED"&&(p="TRANSFER_STATE_PAUSED_BY_USER"),d={key:J.entityKey,transferState:p,cotn:g.Nq(16),enqueuedTimestampMs:Date.now().toString(),maximumDownloadQuality:(y=I)==null?void 0:y.maximumDownloadQuality,preferredAudioTrack:(f=I)==null?void 0:f.preferredAudioTrack,transferRetryCount:0,isRefresh:b,hasLoggedFirstStarted:!1},g.T(P,ns(F.C,
{mode:"readwrite",Em:!0},function(r){var Q=[];b&&Q.push(cb(r,g.Ms(u,"offlineVideoStreams")));Q.push(hl(r,d,"transfer"));return g.fD.all(Q)}),3);
case 3:if(!b){P.gD(4);break}return g.T(P,j8L(u),4);case 4:qz({transferStatusType:"TRANSFER_STATUS_TYPE_ENQUEUED",statusType:"ADDED_TO_QUEUE"},{videoId:u,ZW:d,offlineModeType:(G=K)==null?void 0:G.offlineModeType}),g.N4(P)}})},Q8W=function(F,J,b,I){if(!F.action.entityKey)throw Error("entityKey is missing.");
var u=g.w0(F.action.entityKey);u={entityType:u.FV,entityId:u.entityId,offlineOrchestrationActionType:F.action.actionType,orchestrationAction:{orchestrationActionId:F.actionId}};J&&(u.offlineOrchestrationActionResult=J.status,u.isRetryable=b?!1:J.C,J.T&&(u.offlineOrchestrationFailureReason=X25(J.T,u.isRetryable)));var w,M;if((w=F.action.actionMetadata)==null?0:(M=w.offlineLoggingData)==null?0:M.offlineModeType)u.offlineModeType=F.action.actionMetadata.offlineLoggingData.offlineModeType;I&&(u.additionalOrchestrationActions=
I.map(function(q){return{orchestrationActionId:q.actionId}}));
return u},X25=function(F,J){return F!=="OFFLINE_ORCHESTRATION_FAILURE_REASON_RECOVERABLE_NETWORK_ERROR"||J?F==="OFFLINE_ORCHESTRATION_FAILURE_REASON_UNRECOVERABLE_NETWORK_ERROR"&&J?"OFFLINE_ORCHESTRATION_FAILURE_REASON_RECOVERABLE_NETWORK_ERROR":F:"OFFLINE_ORCHESTRATION_FAILURE_REASON_UNRECOVERABLE_NETWORK_ERROR"},R8b=function(F,J){var b={offlineOrchestrationContext:Q8W(F)};
J=IG1(J,b);uwt(bLR(),J,F.rootActionId)},DNH=function(F,J,b,I){I=I===void 0?[]:I;
J={offlineOrchestrationContext:Q8W(F,J,b,I)};J=IG1(3,J);uwt(bLR(),J,F.rootActionId)},kZU=function(){this.actions=[]},OqW=function(F,J){J=g.N(J);
for(var b=J.next();!b.done;b=J.next())b=b.value,R8b(b,1),F.actions.push(b);F.actions.sort(F.C)},oRz=function(F,J){if(J)for(var b=0;b<F.actions.length;b++)if(J==="!*$_ALL_ENTITIES_!*$"&&F.actions[b].actionId!==J||J!=="!*$_ALL_ENTITIES_!*$"&&F.actions[b].rootActionId===J&&F.actions[b].actionId!==J)F.actions.splice(b,1),b--},h8t=function(F,J){F=g.N(F.actions);
for(var b=F.next();!b.done;b=F.next())if(b.value.actionId===J)return!0;return!1},Q0=function(F,J,b,I,u){g.R.call(this);
var w=this;this.U=F;this.Gj=J;this.Tj=b;this.V=I;this.rD=u;this.C=new kZU;this.W=new g.hB;this.T=new g.ty(function(){w.retry()});
this.Y=NaN;this.D=!1;this.Po={ygQ:function(){return w.C},
BX:function(){return w.W},
aqQ:function(){return w.T},
retry:function(){return w.retry()}};
g.k(this,this.T);this.N=this.U.observe(this.eE.bind(this))},xNz=function(F,J,b,I,u){var w;
return g.S(function(M){if(M.C==1)return w=new Q0(F,J,b,I,u),g.T(M,cSL(w),2);UNb(w);return M.return(w)})},UNb=function(F){var J=F.C.actions[0];
return F.Z?((J==null?void 0:J.action.actionType)==="OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE"&&F.Z[0].action.actionType!=="OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE"&&(F.D=!0),Promise.resolve()):nRz(F)},nRz=function(F){var J,b,I,u,w,M,q,v,a,e,K,p,m,y,f,d,G;
return g.S(function(P){switch(P.C){case 1:if(F.Z)throw Error("Already processing an action");if(F.iR())return P.return();J=F.C.actions.shift();iLW(F.Tj,!J);if(J===void 0)return P.return();J.action.actionType==="OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH"&&J.actionId==="DOWNLOADS_LIST_ENTITY_ID_SMART_DOWNLOADS"&&oRz(F.C,J.actionId);b="";J.action.actionType==="OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE"&&J.rootActionId===J.actionId&&(b=J.actionId);I=[J];F.Z=I;if(u=F.Gj[J.entityType]){P.gD(2);break}F.Z=
void 0;return g.T(P,nRz(F),3);case 3:return P.return();case 2:w=g.N(I);for(M=w.next();!M.done;M=w.next())q=M.value,R8b(q,2);g.lk(P,4,5);return g.T(P,e81(u,I.map(function(r){return r.action})),7);
case 7:v=P.U,a=g.N(I),e=a.next();case 8:if(e.done){P.gD(10);break}K=e.value;p=v.get(K.action);return g.T(P,t7R(F,K,p),9);case 9:e=a.next();P.gD(8);break;case 10:oRz(F.C,b);case 5:g.Em(P);F.Z=void 0;g.jz(P,6);break;case 4:return m=g.dY(P),I_("Orchestration error",m),g.lk(P,12),g.T(P,ZqR(F,I),14);case 14:g.Wa(P,5);break;case 12:y=g.dY(P);I_("Orchestration retry error",y);f=g.N(I);for(d=f.next();!d.done;d=f.next())G=d.value,G.retryScheduleIndex<3&&OqW(F.C,[G]);P.gD(5);break;case 6:return g.T(P,nRz(F),
0)}})},t7R=function(F,J,b){var I,u,w,M,q,v,a,e,K,p,m,y;
return g.S(function(f){switch(f.C){case 1:I=J.retryScheduleIndex+2===3;if(b.status==="OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS"){f.gD(2);break}if(b.status!=="OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE"){f.gD(0);break}DNH(J,b,I);if(b.C&&J.retryScheduleIndex+1<3)return g.T(f,ZqR(F,[J]),0);w=((u=b)==null?0:u.U)?b.U:"OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN";M={entityKey:J.action.entityKey,failureReason:w};q=void 0;g.hP(F.rD)?q="mainVideoDownloadStateEntity":g.sV(F.rD)&&(q="musicTrackDownloadMetadataEntity");
if(!q||!b.downloadState){f.gD(7);break}v=g.w0(J.action.entityKey).entityId;return g.T(f,ph(v,q,F.U,b.downloadState),7);case 7:wx(F.V,M);if(b.downloadState==="DOWNLOAD_STATE_FAILED"&&F.rD.S("html5_auto_retry_failed_pde_actions")){f.gD(0);break}I_("Orchestration result is not retryable, deleting action");return g.T(f,CT1(F.U,Nz(J).key),0);case 2:a=void 0;try{a=(e=b.Z)==null?void 0:e.map(function(d){return F.createAction(d,J)})}catch(d){return DNH(J,b,I),K={entityKey:J.action.entityKey,
failureReason:"OFFLINE_OPERATION_FAILURE_REASON_UNSUPPORTED_ENTITY_FAILED"},wx(F.V,K),I_("Orchestration subactions creation error",d),f.return()}DNH(J,b,I,a);if(!a){f.gD(12);break}p=a.map(function(d){return Nz(d)});
m=0;case 13:if(!(m<a.length)||F.D){f.gD(15);break}return g.T(f,ns(F.U,{mode:"readwrite",Em:!0},function(d){var G=[];G.push(Git(d,p.slice(m,m+10),"offlineOrchestrationActionWrapperEntity"));return g.fD.all(G)}),16);
case 16:m+=10;f.gD(13);break;case 15:if(F.D)return F.D=!1,f.return();case 12:return y=Nz(J),g.T(f,CT1(F.U,y.key),17);case 17:R8b(J,4),g.N4(f)}})},Jy8=function(F,J){var b,I,u,w,M,q,v,a,e,K,p,m;
return g.S(function(y){b=[];I=Infinity;u=4E3;w=g.N(J);for(M=w.next();!M.done;M=w.next())q=M.value,v=Number(q.enqueueTimeSec),a=Hqb(v),e=q.retryScheduleIndex,K=e!=null&&e>0,a>0&&K?(I=Math.min(I,v),u=Math.min(a,u)):b.push(q);isFinite(I)&&(!F.T.isActive()||I<F.Y)&&(F.Y=I,F.T.start(u));F.W.Vi()||(p=b.length,b=b.filter(function(f){var d;f=((d=f.actionProto)==null?void 0:d.actionType)||"OFFLINE_ORCHESTRATION_ACTION_TYPE_UNKNOWN";return!LaW.includes(f)}),m=b.length<p,!F.T.isActive()&&m&&F.T.start(1));
b.length>0&&FUU(F,b);return g.T(y,UNb(F),0)})},I_1=function(F){var J,b,I,u,w,M,q;
return g.S(function(v){if(v.C==1)return g.T(v,b8V(F),2);J=v.U;b=[];I=g.N(J);for(u=I.next();!u.done;u=I.next())w=u.value,M=g.w0(w.key),q=M.entityId,h8t(F.C,q)||b.push(w);return g.T(v,Jy8(F,b),0)})},Hqb=function(F){F=F*1E3-Date.now();
return F>4E3?4E3:F},ZqR=function(F,J){var b,I,u;
return g.S(function(w){b=g.N(J);for(I=b.next();!I.done;I=b.next()){u=I.value;var M=void 0,q=void 0,v=((q=u.action)==null?void 0:(M=q.actionMetadata)==null?void 0:M.retryScheduleIntervalsInSeconds)||[1,2,4];M=1;u.retryScheduleIndex<v.length&&(M=v[u.retryScheduleIndex]);u.C=M*1E3+Date.now();u.retryScheduleIndex++}return g.T(w,u0z(F,J),0)})},cSL=function(F){var J;
return g.S(function(b){if(b.C==1)return g.T(b,Hb(F.U,"offlineOrchestrationActionWrapperEntity"),2);J=b.U;return g.T(b,Jy8(F,J),0)})},FUU=function(F,J){J.length!==0&&J.forEach(function(b){b=zO(b);
b.retryScheduleIndex<3&&OqW(F.C,[b])})},b8V=function(F,J){var b;
return g.S(function(I){if(I.C==1)return g.T(I,Hb(F.U,"offlineOrchestrationActionWrapperEntity",J),2);b=I.U;return I.return(b.filter(oIW))})},u0z=function(F,J){if(J.length===0)return Promise.resolve([]);
J=J.map(function(b){return Nz(b)});
return $55(F.U,J)},wQ5=function(F){this.SE=F;
this.C=void 0},Mf8=function(F,J){var b,I,u,w;
return g.S(function(M){b=J.videoId;I=!0;if(J.captionTracks.length)u=E9V(J),F.C=new g.BU(F.SE,J,u);else if(J.zU)w=g.aXG(J),F.C=new g.rA(F.SE,J.zU,b,w,J.OM,J.eventId),I=J.OM;else return M.return();return M.return(new Promise(function(q){var v;(v=F.C)==null||v.xW({L8:function(){return g.S(function(a){if(a.C==1)return g.T(a,F.L8(b,I),2);q();g.N4(a)})},
b4:function(){}})}))})},Ayk=function(F){var J;
return g.S(function(b){if(b.C==1)return g.T(b,nIm(F),2);J=b.U;return b.return(!!J&&J.length>0)})},R_=function(F){g.R.call(this);
this.C=F;this.U=this.C.observe(this.T.bind(this))},qYR=function(F,J){var b,I,u,w,M,q,v;
return g.S(function(a){switch(a.C){case 1:if(J.length===0)return a.return([]);b=J.map(function(e){return g.Ms(e,"transfer")});
return g.T(a,Hb(F.C,"transfer",b),2);case 2:I=a.U;u=I.filter(oIW).map(function(e){return g.w0(e.key).entityId});
w=J.filter(function(e){return u.indexOf(e)===-1});
if(w.length===0)return a.return([]);M=g.N(w);q=M.next();case 3:if(q.done){a.gD(5);break}v=q.value;return g.T(a,j8L(v),4);case 4:q=M.next();a.gD(3);break;case 5:return a.return(w)}})},eb5=function(F,J,b,I,u,w){var M,q,v;
return g.S(function(a){M="STREAM_TYPE_UNKNOWN";b.video&&b.audio?(M="STREAM_TYPE_AUDIO_AND_VIDEO",I_("unexpected stream type")):b.video&&!b.audio?M="STREAM_TYPE_VIDEO":!b.video&&b.audio&&(M="STREAM_TYPE_AUDIO");q=g.Ms(J,"offlineVideoStreams");v={numBytesDownloaded:u.toFixed(),numTotalBytes:w.toFixed(),streamType:M,streamState:"DOWNLOAD_STREAM_STATE_IN_PROGRESS",formatStreamBytes:JSON.stringify(I),itag:M==="STREAM_TYPE_AUDIO_AND_VIDEO"?Number(b.itag):void 0};return g.T(a,ns(F,{mode:"readwrite",Em:!0},
function(e){var K=kt(e,q,"offlineVideoStreams"),p=kt(e,g.Ms(J,"transfer"),"transfer");return g.fD.all([K,p]).then(function(m){m=g.N(m);var y=m.next().value;m=m.next().value;if(!m)return cb(e,q).then(function(){});
var f=vQb(y);y=a_U(y,I,v,q);var d=hl(e,y,"offlineVideoStreams");vQb(y)>f&&(m.lastProgressTimeMs=Date.now().toString());f=[d];m.offlineVideoStreams||(m.offlineVideoStreams=[]);m.offlineVideoStreams.indexOf(q)===-1&&(m.offlineVideoStreams.push(q),f.push(hl(e,m,"transfer")));return g.fD.all(f)})}),0)})},KUb=function(F,J){var b,I,u,w,M;
return g.S(function(q){if(q.C==1)return b=g.Ms(J,"offlineVideoStreams"),g.T(q,ZK(F,b,"offlineVideoStreams"),2);I=q.U;if(!I||!I.streamsProgress)return q.return();u=g.N(I.streamsProgress);for(w=u.next();!w.done;w=u.next())M=w.value,M.streamState="DOWNLOAD_STREAM_STATE_COMPLETE",M.numTotalBytes!==M.numBytesDownloaded&&(M.numBytesDownloaded=M.numTotalBytes);return g.T(q,tl(F,I,"offlineVideoStreams"),0)})},a_U=function(F,J,b,I){if(F&&F.streamsProgress){I=F;
a:{J=J.itag+";"+J.xtags;for(var u=F.streamsProgress,w=0;w<u.length;w++){var M=JSON.parse(u[w].formatStreamBytes);if(M.itag+";"+M.xtags===J){u[w]=b;b=u;break a}}u.push(b);b=u}I.streamsProgress=b}else F={key:I,streamsProgress:[b]};return F},vQb=function(F){if(F==null?0:F.streamsProgress){var J=0;
F=F.streamsProgress;for(var b=0;b<F.length;b++){var I=F[b];isNaN(Number(I.numBytesDownloaded))?I_("stream progress bytes number invalid"):J+=Number(I.numBytesDownloaded)}return J}return 0},pQU=function(F,J,b,I){g.R.call(this);
var u=this;this.U=F;this.api=J;this.zj=b;this.eE=I;this.W=new g.hB;this.Z=new g.ty(function(){u.C&&u.C.transferState==="TRANSFER_STATE_TRANSFERRING"&&u.W.Vi()&&((u.C.transferRetryCount||0)<3?XM(u.V,u.D,!1,!1):Ch(u.V,u.D.videoDetails.videoId),u.un("TRANSFER_FAILURE_REASON_TIMEOUT_NO_PROGRESS"))});
this.Tj=this.WN=0;this.N=this.Y=!1;this.KW=g.eB(this.api.J().experiments,"html5_transfer_processing_logs_interval");this.dD=new g.s5(this);this.Po={IqG:function(){return u.Z},
h2G:function(){return u.eE},
BX:function(){return u.W}};
this.Gj=this.U.observe(this.ai.bind(this));this.V=new ERR(J,this);this.Jz=new wQ5(J);this.kQ=new R_(this.U);this.qf=this.W.listen("publicytnetworkstatus-online",this.pU.bind(this));this.fW=this.W.listen("publicytnetworkstatus-offline",this.leG.bind(this));this.N=this.api.J().S("html5_less_transfer_processing_logs");g.k(this,this.dD);this.dD.B(J,"offlinetransferpause",this.QH_);g.hP(this.api.J())?this.T="mainVideoDownloadStateEntity":g.sV(this.api.J())&&(this.T="musicTrackDownloadMetadataEntity")},
gQ1=function(F){return g.S(function(J){if(J.C==1)J=g.T(J,U5k(),2);
else{var b=F.kQ;var I=g.d7();I=Object.keys(I);b=qYR(b,I);J=g.T(J,b,0)}return J})},kh=function(F,J){J=J===void 0?!1:J;
var b;return g.S(function(I){if(I.C==1){if(F.C)throw Error("Already downloading a video");F.Tj=0;F.Y=!1;return g.T(I,mw5(F),2)}return I.C!=4?(b=I.U,zYe(F.zj,!b),b&&F.W.Vi()?J?g.T(I,new Promise(function(u){g.pl(u,1E3)}),4):I.gD(4):(!b&&F.C&&Dl(F),I.gD(0))):g.T(I,yyW(F,b),0)})},i8m=function(F){return g.S(function(J){if(J.C==1)return F.D?g.T(J,Ch(F.V,F.D.videoDetails.videoId),3):J.gD(0);
Dl(F);g.N4(J)})},zb5=function(F,J){var b,I,u;
return g.S(function(w){switch(w.C){case 1:return g.lk(w,2),(b=!!J.captionTracks.length||!!J.zU)?g.T(w,Ayk(J.videoId),4):w.return();case 4:return(I=w.U)?w.return():g.T(w,Mf8(F.Jz,J),5);case 5:g.Wa(w,0);break;case 2:u=g.dY(w),I_("Caption downloading error",u,J.cotn),g.N4(w)}})},yyW=function(F,J){var b,I,u,w,M,q;
return g.S(function(v){switch(v.C){case 1:if(F.Y)return v.return();F.Y=!0;F.C=J;b=g.w0(F.C.key);I=b.entityId;u=void 0;if(F.C.transferState==="TRANSFER_STATE_TRANSFERRING")return g.T(v,OI(F,I),7);if(F.C.transferState!=="TRANSFER_STATE_TRANSFER_IN_QUEUE"||F.C.transferRetryCount||F.C.hasLoggedFirstStarted){v.gD(3);break}return g.T(v,OI(F,I),5);case 5:return u=v.U,F.C.hasLoggedFirstStarted=!0,g.T(v,NiR(F),6);case 6:Njz({videoId:I,ZW:F.C,offlineModeType:u},void 0,void 0,!0);v.gD(3);break;case 7:u=v.U,
qz({transferStatusType:"TRANSFER_STATUS_TYPE_RESUME_PROCESSING",statusType:"OFFLINING_RETRIED"},{videoId:I,ZW:F.C,offlineModeType:u});case 3:return g.T(v,l_k(F),8);case 8:return w=null,g.lk(v,9),g.T(v,f_W(F,J),11);case 11:w=v.U;F.D=w;g.Wa(v,10);break;case 9:return M=g.dY(v),I_("error getting player response",M,J.cotn),g.T(v,F.un("TRANSFER_FAILURE_REASON_SERVER_PROPERTY_MISSING"),12);case 12:return v.return();case 10:return q=jNU(F.api.J(),J.cotn,w),g.T(v,zb5(F,q),13);case 13:return g.T(v,GZW(q.videoId),
14);case 14:q.F$=v.U,T25(F.V,q,J.maximumDownloadQuality),F.Z.start(108E5),g.N4(v)}})},mw5=function(F){var J,b;
return g.S(function(I){if(I.C==1)return g.T(I,Hb(F.U,"transfer"),2);J=I.U;b=J.filter(WUk).sort(dwz);return b.length===0?I.return():I.return(b[0])})},l_k=function(F){var J,b,I;
return g.S(function(u){if(u.C==1){if(!F.C)return o_(F,"onTransferStart"),u.return();F.Z.start(108E5);return g.T(u,hO(F,"TRANSFER_STATE_TRANSFERRING"),2)}J=F.C;return(I=((b=J)==null?0:b.key)?g.w0(J.key).entityId:"")&&F.T?g.T(u,ph(I,F.T,F.U,"DOWNLOAD_STATE_DOWNLOAD_IN_PROGRESS"),0):u.gD(0)})},PRV=function(F){var J,b,I,u;
g.S(function(w){switch(w.C){case 1:if(!F.C){o_(F,"onTransferPausedByUser");w.gD(2);break}J=F.C;F.Z.stop();return g.T(w,hO(F,"TRANSFER_STATE_PAUSED_BY_USER"),3);case 3:I=((b=J)==null?0:b.key)?g.w0(J.key).entityId:"";if(!I||!F.T){w.gD(4);break}return g.T(w,ph(I,F.T,F.U,"DOWNLOAD_STATE_PAUSED"),4);case 4:return g.T(w,OI(F,I),6);case 6:u=w.U,lG1({videoId:I,ZW:J,offlineModeType:u});case 2:Dl(F),kh(F),g.N4(w)}})},B2U=function(F){var J,b,I;
g.S(function(u){if(u.C==1){if(!F.C)return o_(F,"onTransferPausedByNetwork"),u.return();F.Z.stop();return g.T(u,hO(F,"TRANSFER_STATE_TRANSFER_IN_QUEUE"),2)}if(u.C!=3)return J=F.C,(I=((b=J)==null?0:b.key)?g.w0(J.key).entityId:"")&&F.T?g.T(u,ph(I,F.T,F.U,"DOWNLOAD_STATE_PAUSED"),3):u.gD(3);Dl(F);g.N4(u)})},EQt=function(F){var J,b,I,u,w;
g.S(function(M){switch(M.C){case 1:if(!F.C)return o_(F,"onTransferComplete"),M.return();J=F.C;F.Z.stop();if(!J||!F.D){M.gD(2);break}b=jNU(F.api.J(),J.cotn,F.D);return g.T(M,zb5(F,b),2);case 2:return g.T(M,hO(F,"TRANSFER_STATE_COMPLETE","DOWNLOAD_STREAM_STATE_COMPLETE"),4);case 4:u=((I=J)==null?0:I.key)?g.w0(J.key).entityId:"";if(!u||!F.T){M.gD(5);break}return g.T(M,ph(u,F.T,F.U,"DOWNLOAD_STATE_COMPLETE"),5);case 5:return g.T(M,KUb(F.U,u),7);case 7:return g.T(M,OI(F,u),8);case 8:w=M.U,qz({transferStatusType:"TRANSFER_STATUS_TYPE_COMPLETED",
statusType:"SUCCESS"},{videoId:u,ZW:J,offlineModeType:w}),Dl(F),kh(F),g.N4(M)}})},jEz=function(F,J,b){var I,u;
g.S(function(w){switch(w.C){case 1:if(!F.C)return o_(F,"onTransferProgress: "+J),w.return();if(F.C.transferState==="TRANSFER_STATE_TRANSFERRING"){w.gD(2);break}return g.T(w,l_k(F),2);case 2:I=Date.now();if(!(I-F.WN>1E3)){w.gD(4);break}F.WN=I;return g.T(w,eb5(F.U,b.videoId,b.U,b.Qw,b.bytesDownloaded,b.C),5);case 5:if(F.N&&!(F.N&&I-F.Tj>F.KW)){w.gD(4);break}F.Tj=I;return g.T(w,OI(F,J),7);case 7:u=w.U,Njz({videoId:J,ZW:F.C,offlineModeType:u},b.bytesDownloaded,b.C);case 4:F.Z.start(108E5),g.N4(w)}})},
GMz=function(F){var J=(F.C.transferRetryCount||0)<3;
J&&(F=F.C,F.transferRetryCount=(F.transferRetryCount||0)+1);return J},Vfe=function(F,J){J=J===void 0?"TRANSFER_FAILURE_REASON_UNKNOWN":J;
var b,I,u,w;return g.S(function(M){if(M.C==1)return F.C||o_(F,"setTransferToFailed: "+J),b="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",J==="TRANSFER_FAILURE_REASON_NETWORK"?b="OFFLINE_OPERATION_FAILURE_REASON_NETWORK_REQUEST_FAILED":J==="TRANSFER_FAILURE_REASON_FILESYSTEM_WRITE"&&(b="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED"),g.T(M,hO(F,"TRANSFER_STATE_FAILED","DOWNLOAD_STREAM_STATE_ERROR_STREAMS_MISSING",J),2);if(M.C!=3)return wx(F.eE,{entityKey:(I=F.C)==null?void 0:I.key,failureReason:b}),
u=F.C?g.w0(F.C.key).entityId:"",g.T(M,OI(F,u),3);w=M.U;var q={videoId:u,ZW:F.C,offlineModeType:w},v=J,a={transferStatusType:"TRANSFER_STATUS_TYPE_TERMINATED_WITH_FAILURE",statusType:"FAILED"};v&&(a.transferFailureReason=v,a.failureReason=fGR(v));qz(a,q);g.N4(M)})},hO=function(F,J,b,I){var u;
return g.S(function(w){if(w.C==1){if(!F.C)return o_(F,"saveTransferState: "+J),w.return();F.C.transferState=J;F.C.failureReason=I;g.lk(w,2);return g.T(w,NiR(F,function(M){return b?OA(M,"offlineVideoStreams",F.C.offlineVideoStreams).then(function(q){for(var v=g.N(q),a=v.next();!a.done;a=v.next())if((a=a.value)&&a.streamsProgress){a=g.N(a.streamsProgress);for(var e=a.next();!e.done;e=a.next())e.value.streamState=b}return Git(M,q.filter(function(K){return!!K}),"offlineVideoStreams")}):g.fD.resolve(void 0)}),
4)}if(w.C!=2)return g.Wa(w,0);
u=g.dY(w);return u instanceof g.gZ&&u.type==="QUOTA_EXCEEDED"?g.T(w,F.un("TRANSFER_FAILURE_REASON_FILESYSTEM_WRITE"),0):w.gD(0)})},NiR=function(F,J){var b;
return g.S(function(I){if(!F.C)return I.return();b=F.C;return g.T(I,ns(F.U,{mode:"readwrite",Em:!0},function(u){var w=[hl(u,b,"transfer")];J&&w.push(J(u));return g.fD.all(w)}),0)})},Dl=function(F){F.C=void 0;
F.D=void 0;F.Z.stop()},f_W=function(F,J){var b,I,u,w,M;
return g.S(function(q){if(q.C==1)return b=g.w0(J.key),I=b.entityId,u=g.Ms(I,"playbackData"),g.T(q,ZK(F.U,u,"playbackData"),2);w=q.U;if((M=w)==null?0:M.playerResponseJson)return q.return(JSON.parse(w.playerResponseJson));throw Error("No PlayerResponse found");})},o_=function(F,J){F.api.UQ("woffle",{mcte:J});
I_("missing current transfer entity.")},OI=function(F,J){var b,I,u;
return g.S(function(w){if(w.C==1)return g.T(w,ZK(F.U,g.Ms(J,"videoDownloadContextEntity"),"videoDownloadContextEntity"),2);b=w.U;return w.return((u=(I=b)==null?void 0:I.offlineModeType)!=null?u:void 0)})},WUk=function(F){return Pob[F.transferState]!==void 0},dwz=function(F,J){var b=Pob[F.transferState],I=Pob[J.transferState];
return b!==I?b-I:Number(F.enqueuedTimestampMs)-Number(J.enqueuedTimestampMs)},cH=function(F,J){var b=this;
this.rD=F;this.api=J;this.W=new g.hB;this.D=new g.m6;this.Po={tA:function(){return b.T.Po.tA()},
BX:function(){return b.W},
z2_:function(){return b.T},
Ca:function(){return b.Ca()},
ox:function(){return b.ox()},
j0:function(){return b.j0()},
cR:function(){return b.cR()},
jW:function(){return b.jW()},
SL:function(I){return b.SL(I)}};
this.T=new ggH(function(){return Bi5(b)},function(){b.j0()},this.api.o6(),this.api.S.bind(this.api));
this.C=new ul(this.api);mBV(this.T)},Bi5=function(F){return g.S(function(J){F.api.jE("onOrchestrationBecameLeader");
return g.T(J,F.ox(),0)})},ryb=function(F){var J,b;
return g.S(function(I){if(I.C==1)return g.T(I,Ls(),2);if(I.C!=3){J=I.U;if(!J)return I_("PES is undefined"),I.return();F.U=new pQU(J,F.api,F.T,F.C);b=F.lm(J);return g.T(I,xNz(J,b,F.T,F.C,F.rD),3)}F.V=I.U;return g.T(I,TiL(F),0)})},TiL=function(F){var J;
return g.S(function(b){switch(b.C){case 1:if(!F.U)return I_("transferManager is undefined"),b.return();if(F.U.C){b.gD(2);break}return g.T(b,kh(F.U),2);case 2:if(!F.rD.S("woffle_enable_main_downloads_library")){b.gD(4);break}return g.T(b,F.Ls(),4);case 4:if(!F.rD.S("html5_offline_playback_position_sync")){b.gD(6);break}return g.T(b,F.Zx(),7);case 7:return g.T(b,F.SL(864E5),6);case 6:return g.T(b,F.refreshAllStaleEntities(43200,!0),9);case 9:return g.T(b,F.zx(),10);case 10:if(!F.rD.S("html5_retry_downloads_for_expiration")){b.gD(11);
break}return g.T(b,F.jW(),11);case 11:return F.Y=g.g$(function(){F.refreshAllStaleEntities(43200,!0);F.zx()},9E5),g.tC(g.HK(),function(){return F.cR()}),g.T(b,Ls(),13);
case 13:return J=b.U,g.T(b,pc5(J),14);case 14:yWt(F.T),g.N4(b)}})},SY1=function(){var F,J,b,I,u,w;
return g.S(function(M){switch(M.C){case 1:return g.T(M,Ls(),2);case 2:F=M.U;if(!F)return M.return([]);J=Date.now()/1E3;return g.T(M,Hb(F,"offlineVideoPolicy"),3);case 3:b=M.U,I=g.N(b),u=I.next();case 4:if(u.done){M.gD(6);break}w=u.value;if(!(w.expirationTimestamp&&Number(w.expirationTimestamp)<J)){M.gD(5);break}w.action="OFFLINE_VIDEO_POLICY_ACTION_DISABLE";w.offlinePlaybackDisabledReason="OFFLINE_PLAYBACK_DISABLED_REASON_CLIENT_OFFLINE_CONTENT_EXPIRED";return g.T(M,tl(F,w,"offlineVideoPolicy"),5);
case 5:u=I.next();M.gD(4);break;case 6:return M.return(b.map(function(q){return q.key}))}})},UI=function(F,J,b,I,u){var w,M,q;
return g.S(function(v){if(v.C==1)return g.T(v,Ls(),2);w=v.U;if(!w)return v.return([]);M=J.map(function(a){var e=g.Ms(a,b);e={actionType:I,entityKey:e,actionMetadata:Object.assign({},Gvm(),u)};I!=="OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH"&&(e.actionMetadata.priority=0);a=new il(b,a,e);return Nz(a)});
q=$55(w,M);mBV(F.T);return v.return(q)})},sEk=function(F,J,b,I){var u,w,M,q,v,a,e,K;
return g.S(function(p){switch(p.C){case 1:u=[],w=g.N(J),M=w.next();case 2:if(M.done){p.gD(4);break}q=M.value;if(q.upToDate||b&&!q.shouldAutoSyncMetadata||!q.playlistId){p.gD(3);break}v={};switch(I){case "mainPlaylistEntity":a={nextAutoRefreshIntervalSeconds:q.checkInSeconds,autoSync:b};v={mainPlaylistEntityActionMetadata:a};break;case "musicPlaylist":e={autoSync:b},v={musicPlaylistEntityActionMetadata:e}}return g.T(p,UI(F,[q.playlistId],I,"OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH",v),6);case 6:(K=
p.U)&&u.push.apply(u,g.W(K));case 3:M=w.next();p.gD(2);break;case 4:return p.return(u)}})},YY5=function(F,J){var b;
return g.S(function(I){return J.length?(b=Gvm(),g.CO(b,Yh,{isEnqueuedForExpiredStreamUrlRefetch:!0}),F.api.UQ("qrd",{v:J.length}),I.return(UI(F,J,"playbackData","OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",b))):I.return([])})},$wU=function(F,J,b){this.C=F;
this.rD=J;this.T=b},QE1=function(F,J){var b,I,u,w,M,q,v,a,e,K,p,m,y,f,d,G,P;
return g.S(function(r){switch(r.C){case 1:return b=vH(J),I=g.w0(J.entityKey),u=I.entityId,w=[],g.lk(r,2),g.T(r,Coe(F,u),4);case 4:w=r.U;if(!(F.rD.S("woffle_enable_main_downloads_library")&&((M=w)==null?0:M.length))){r.gD(5);break}return g.T(r,RY1(F.C,[J.entityKey]),5);case 5:g.Wa(r,3);break;case 2:return q=g.dY(r),v="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",a="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",q instanceof g.gZ&&q.type==="QUOTA_EXCEEDED"?(v="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",
a="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"):I_("Playlist add error"),r.return(new sI("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",b,void 0,v,a));case 3:e=[];if(!F.rD.S("html5_offline_prevent_redownload_downloaded_video")){r.gD(7);break}return g.T(r,EgV(F.C,"mainVideoEntity",w),8);case 8:w=r.U;case 7:if((K=w)==null?0:K.length)for(p=g.N(w),m=p.next();!m.done;m=p.next())if(y=m.value,f=y.offlineVideoData,d=void 0,(d=f)==null?0:d.videoId)G=void 0,P=Number(((G=J.actionMetadata)==null?void 0:G.priority)||
0)+1,e.push(SG("OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",f.videoId,"mainVideoEntity",P,xh,XQW(J,f,u)));return r.return(new sI("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",b,e))}})},Dwm=function(F,J){var b,I,u,w,M,q,v,a,e,K,p,m,y,f,d,G,P,r,Q,D,t,n,uk,AJ,F7,h,L,l,c,Da,fz,Kz,Vz,Za,Ib,yU,E,V,B,Y,X,JJ,wY,M4,C,ez,yz,va,rY,pz,QU,Kf,hJ,QI,qX,rU,of,af,oD,Ry,h6,lB,eq,rb,pI,SP,s4,Yo,PR,HW,cz,Iy,WQ,CX;
return g.S(function(pf){switch(pf.C){case 1:return b=vH(J),I=J.entityKey,u=g.w0(I).entityId,w=[],M=!1,u==="!*$_ALL_ENTITIES_!*$"?(M=!0,g.T(pf,Hb(F.C,"mainPlaylistEntity"),5)):g.T(pf,ZK(F.C,I,"mainPlaylistEntity"),4);case 4:(q=pf.U)&&w.push(q);pf.gD(3);break;case 5:w=pf.U;case 3:if((v=w)==null||!v.length)return pf.return(new sI("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",b));a=g.O(J.actionMetadata,RbW);K=(e=a)==null?void 0:e.nextAutoRefreshIntervalSeconds;m=(p=a)==null?void 0:p.autoSync;y=[];d=f=
!0;G=!1;if(!M&&m===!1){pf.gD(6);break}g.lk(pf,7);return g.T(pf,Fat(0,!!m,!0,w),9);case 9:y=pf.U;g.Wa(pf,8);break;case 7:P=g.dY(pf);if(!(P instanceof Error&&P.message==="No data")){P instanceof Error&&P.message==="Empty response body"&&I_(P.message);pf.gD(8);break}return u==="!*$_ALL_ENTITIES_!*$"?g.T(pf,sNk(F.C,J,F.T,"OFFLINE_DELETE_REASON_UNAVAILABLE"),8):g.T(pf,rWR(u,F.C,J,F.T),8);case 8:if(!y.length||!M&&y[0].playlistId!==u)return pf.return(new sI("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
b));case 6:if(M){r=[];Q=g.N(y);for(D=Q.next();!D.done;D=Q.next())t=D.value,t.upToDate||m&&!t.shouldAutoSyncMetadata||!t.playlistId||(n={nextAutoRefreshIntervalSeconds:t.checkInSeconds,autoSync:m},r.push(SG("OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH",t.playlistId,"mainPlaylistEntity",0,xh,{mainPlaylistEntityActionMetadata:n})));return pf.return(new sI("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",b,r))}y.length&&(uk=y[0],G=!!uk.upToDate,m&&(f=(AJ=uk.shouldAutoSyncMetadata)!=null?AJ:!0,d=(F7=uk.shouldAutoSyncVideos)!=
null?F7:!0,uk.checkInSeconds&&(K=uk.checkInSeconds)));if(G||!f)return pf.return(new sI("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",b));h=[];L=w[0];if(!L.downloadState){l=void 0;pf.gD(15);break}return g.T(pf,ZK(F.C,L.downloadState,"mainPlaylistDownloadStateEntity"),16);case 16:l=pf.U;case 15:return c=l,fz=((Da=c)==null?0:Da.addedTimestampMillis)?String(c.addedTimestampMillis):void 0,g.lk(pf,17),g.T(pf,Coe(F,u,fz,K),19);case 19:h=pf.U;g.Wa(pf,18);break;case 17:Kz=g.dY(pf);if(!(Kz instanceof Error&&
Kz.message==="No data for playlist")){if(Kz instanceof Error&&Kz.message==="Empty response body for playlist")I_(Kz.message);else return Vz="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",Za="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",Kz instanceof g.gZ&&Kz.type==="QUOTA_EXCEEDED"&&(Vz="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",Za="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),pf.return(new sI("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",b,void 0,Vz,Za));pf.gD(18);
break}return g.T(pf,rWR(u,F.C,J,F.T),18);case 18:if(!d)return pf.return(new sI("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",b));Ib=[];yU=new Map;if((E=h)==null?0:E.length)for(V=g.N(h),B=V.next();!B.done;B=V.next())Y=B.value,X=Y.offlineVideoData,JJ=void 0,((JJ=X)==null?0:JJ.videoId)&&yU.set(X.videoId,X);wY=new Map;M4=[];if((C=L)==null?0:(ez=C.videos)==null?0:ez.length)for(yz=g.N(L.videos),va=yz.next();!va.done;va=yz.next())if(rY=va.value,pz=JSON.parse(g.w0(rY).entityId),QU=pz.videoId)yU.has(QU)?(wY.set(QU,
yU.get(QU)),yU.delete(QU)):M4.push(QU);hJ=Number(((Kf=J.actionMetadata)==null?void 0:Kf.priority)||0)+1;QI=g.N(yU.entries());for(qX=QI.next();!qX.done;qX=QI.next())rU=qX.value,of=g.N(rU),af=of.next().value,oD=of.next().value,Ry=af,h6=oD,Ib.push(SG("OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",Ry,"mainVideoEntity",hJ,xh,XQW(J,h6,u)));lB=g.N(wY.entries());for(eq=lB.next();!eq.done;eq=lB.next())rb=eq.value,pI=g.N(rb),SP=pI.next().value,s4=pI.next().value,Yo=SP,PR=s4,Ib.push(SG("OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH",
Yo,"mainVideoEntity",hJ,xh,XQW(J,PR,u)));HW=g.N(M4);for(cz=HW.next();!cz.done;cz=HW.next())Iy=cz.value,WQ={playlistId:u},CX={offlineLoggingData:{offlineDeleteReason:"OFFLINE_DELETE_REASON_PARENT_LIST_REFRESH"},mainVideoEntityActionMetadata:WQ},Ib.push(SG("OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE",Iy,"mainVideoEntity",0,xh,CX));return pf.return(new sI("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",b,Ib))}})},kMt=function(F,J){var b,I,u,w;
return g.S(function(M){switch(M.C){case 1:return b=vH(J),g.lk(M,2),I=g.w0(J.entityKey).entityId,I==="!*$_ALL_ENTITIES_!*$"?g.T(M,sNk(F.C,J,F.T,(u=J.actionMetadata)==null?void 0:(w=u.offlineLoggingData)==null?void 0:w.offlineDeleteReason),5):g.T(M,rWR(I,F.C,J,F.T),6);case 6:if(!F.rD.S("woffle_enable_main_downloads_library")){M.gD(5);break}return g.T(M,DB8(F.C,J.entityKey),5);case 5:g.Wa(M,3);break;case 2:return g.dY(M),M.return(new sI("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",b,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",
"OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 3:return M.return(new sI("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",b))}})},Coe=function(F,J,b,I){var u,w,M,q,v,a,e;
return g.S(function(K){switch(K.C){case 1:return g.T(K,HL1([J]),2);case 2:return u=K.U,g.T(K,O8t(F,u[0],b,I),3);case 3:return w=K.U,M=w.mainPlaylistEntity,q=w.tZ_,a=Bjm(M,(v=q)==null?void 0:v.avatar),g.lk(K,4),g.T(K,fh(a),6);case 6:g.Wa(K,5);break;case 4:e=g.dY(K),e instanceof Error&&e.message==="Failed to fetch"&&I_(e.message);case 5:return K.return(u[0].videos)}})},O8t=function(F,J,b,I){var u,w,M,q,v,a,e,K,p,m,y,f,d,G,P,r,Q;
return g.S(function(D){switch(D.C){case 1:u=Date.now().toString();b||(b=u);w=J.videos;M=J.playlistId;q=[];v=[];if(w)for(a=g.N(w),e=a.next();!e.done;e=a.next()){K=e.value;p=K.offlineVideoData;if(!p||!p.videoId)throw I_("Invalid offlineVideoData for playlist"),Error("Invalid offlineVideoData for playlist");m=p.videoId;y={videoId:m,playlistId:M};f={id:g.Ms(JSON.stringify(y),"mainPlaylistVideoEntity"),video:g.Ms(m,"mainVideoEntity")};q.push(f);v.push(f.id)}G={key:g.Ms(M,"mainPlaylistDownloadStateEntity"),
addedTimestampMillis:b,lastSyncedTimestampMillis:u};P={key:g.Ms(M,"mainPlaylistEntity"),playlistId:M,videos:v,title:J.title,thumbnailStyleData:oQL(J),visibility:hbU(J),downloadState:G.key};J.channel&&(r=J.channel.offlineChannelData,d=cyk(g.Ms(M,"ytMainChannelEntity"),r),P.channelOwner=d.id);((Q=P)==null?0:Q.entityMetadata)?(P.entityMetadata.offlineLastModifiedTimestampSeconds=J.lastModifiedTimestamp,I&&(P.entityMetadata.nextAutoRefreshIntervalSeconds=String(I))):P&&(P.entityMetadata={nextAutoRefreshIntervalSeconds:I?
String(I):void 0,offlineLastModifiedTimestampSeconds:J.lastModifiedTimestamp});g.lk(D,2);return g.T(D,ns(F.C,{mode:"readwrite",Em:!0},function(t){var n=hl(t,P,"mainPlaylistEntity"),uk=hl(t,G,"mainPlaylistDownloadStateEntity");n=[n,uk];uk=g.N(q);for(var AJ=uk.next();!AJ.done;AJ=uk.next())n.push(hl(t,AJ.value,"mainPlaylistVideoEntity"));d&&n.push(hl(t,d,"ytMainChannelEntity"));return g.fD.all(n)}),4);
case 4:g.Wa(D,3);break;case 2:throw g.dY(D),I_("PES failure for playlist"),Error("PES failure for playlist");case 3:return D.return({mainPlaylistEntity:P,tZ_:d,a_G:q})}})},cyk=function(F,J){return{id:F,
channelId:J.channelId,title:J.title,avatar:J.thumbnail}},oQL=function(F){var J=[],b=F.videos;
b&&b.length>0&&J.push({key:Number("PLAYLIST_THUMBNAIL_STYLE_FIRST_VIDEO"),value:{collageThumbnail:{coverThumbnail:b[0].offlineVideoData.thumbnail}}});if((F=F.additionalMetadadatas)&&F.length>0)for(F=g.N(F),b=F.next();!b.done;b=F.next()){var I=b.value.offlineBundleItemPlaylistData,u=void 0;b=(u=I)==null?void 0:u.style;u=void 0;I={collageThumbnail:{coverThumbnail:(u=I)==null?void 0:u.coverThumbnail}};switch(b){case "BUNDLE_ITEM_STYLE_UNSPECIFIED":J.push({key:Number("PLAYLIST_THUMBNAIL_STYLE_UNKNOWN"),
value:I});break;case "BUNDLE_ITEM_STYLE_TWO_BY_TWO":J.push({key:Number("PLAYLIST_THUMBNAIL_STYLE_TWO_BY_TWO"),value:I});break;case "BUNDLE_ITEM_STYLE_ONE_AND_TWO_AVATAR":J.push({key:Number("PLAYLIST_THUMBNAIL_STYLE_ONE_AND_TWO_AVATAR"),value:I});break;case "BUNDLE_ITEM_STYLE_ONE_AND_TWO":J.push({key:Number("PLAYLIST_THUMBNAIL_STYLE_ONE_AND_TWO"),value:I})}}return J},hbU=function(F){switch(F.privacy){case "PRIVATE":return"PLAYLIST_VISIBILITY_PRIVATE";
case "PUBLIC":return"PLAYLIST_VISIBILITY_PUBLIC";case "UNLISTED":return"PLAYLIST_VISIBILITY_UNLISTED";default:return"PLAYLIST_VISIBILITY_UNKNOWN"}},XQW=function(F,J,b){J={offlineVideoData:J,
playlistId:b};if(F=g.O(F.actionMetadata,RbW))J.maximumDownloadQuality=F.maximumDownloadQuality;return{mainVideoEntityActionMetadata:J}},UwV=function(F,J,b){this.C=F;
this.rD=J;this.T=b},tf8=function(F,J){var b,I,u,w,M,q,v,a,e,K,p,m,y;
return g.S(function(f){switch(f.C){case 1:return b=vH(J),I=g.w0(J.entityKey),u=I.entityId,w=g.O(J.actionMetadata,nh),q=!((M=w)==null?0:M.playlistId),g.lk(f,2),g.T(f,xwL(F,u,void 0,(v=w)==null?void 0:v.offlineVideoData,q),4);case 4:g.Wa(f,3);break;case 2:return a=g.dY(f),e="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",K="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",a instanceof g.gZ&&a.type==="QUOTA_EXCEEDED"&&(e="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",K="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),
f.return(new sI("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",b,void 0,e,K));case 3:p=1;p=Number(((m=J.actionMetadata)==null?void 0:m.priority)||0)+1;var d=(d=g.O(J.actionMetadata,nh))?{playbackDataActionMetadata:{maximumDownloadQuality:d.maximumDownloadQuality}}:void 0;y=SG("OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",u,"playbackData",p,nQ1,d);return f.return(new sI("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",b,[y]))}})},Z8H=function(F,J){var b,I,u,w,M,q,v,a,e,K,p,m,y,f,d,G,P;
return g.S(function(r){switch(r.C){case 1:return b=vH(J),I=g.w0(J.entityKey),u=I.entityId,g.T(r,ZK(F.C,J.entityKey,"mainVideoEntity"),2);case 2:w=r.U;if(!w){M=void 0;r.gD(3);break}return g.T(r,ZK(F.C,w.downloadState,"mainVideoDownloadStateEntity"),4);case 4:M=r.U;case 3:q=M;if(!w||!q)return r.return(new sI("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",b));g.lk(r,5);return g.T(r,xwL(F,u,q.addedTimestampMillis,(a=g.O(J.actionMetadata,nh))==null?void 0:a.offlineVideoData),7);case 7:e=1;e=Number(((K=
J.actionMetadata)==null?void 0:K.priority)||0)+1;v=SG("OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH",u,"playbackData",e,nQ1);g.Wa(r,6);break;case 5:p=g.dY(r);if(!(p instanceof Error&&p.message==="No data")){if(p instanceof Error&&p.message==="Empty response body")I_(p.message);else return m="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",y="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",p instanceof g.gZ&&p.type==="QUOTA_EXCEEDED"&&(m="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",
y="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),r.return(new sI("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",b,void 0,m,y));r.gD(6);break}return g.T(r,EI(F.C,u),9);case 9:f=r.U;d=g.O(J.actionMetadata,nh);if(P=(G=d)==null?void 0:G.playlistId)f.playlistId=P;f.offlineDeleteReason="OFFLINE_DELETE_REASON_UNAVAILABLE";return g.T(r,WH(u,F.C,J,F.T,f),6);case 6:return r.return(new sI("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",b,v?[v]:void 0))}})},H85=function(F,J){var b,I,u,w,M,q,v,a,e,K;
return g.S(function(p){switch(p.C){case 1:return b=vH(J),g.lk(p,2),I=g.w0(J.entityKey).entityId,I==="!*$_ALL_ENTITIES_!*$"?g.T(p,sNk(F.C,J,F.T,(e=J.actionMetadata)==null?void 0:(K=e.offlineLoggingData)==null?void 0:K.offlineDeleteReason),5):g.T(p,EI(F.C,I),6);case 6:u=p.U;w=g.O(J.actionMetadata,nh);if(q=(M=w)==null?void 0:M.playlistId)u.playlistId=q;u.offlineDeleteReason=(v=J.actionMetadata)==null?void 0:(a=v.offlineLoggingData)==null?void 0:a.offlineDeleteReason;return g.T(p,WH(I,F.C,J,F.T,u),7);
case 7:if(!F.rD.S("woffle_enable_main_downloads_library")){p.gD(5);break}return g.T(p,DB8(F.C,J.entityKey),5);case 5:g.Wa(p,3);break;case 2:return g.dY(p),p.return(new sI("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",b,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 3:return p.return(new sI("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",b))}})},xwL=function(F,J,b,I,u){var w,M,q,v,a,e;
return g.S(function(K){switch(K.C){case 1:if(w=I){K.gD(2);break}return g.T(K,ZL5([J]),3);case 3:M=K.U,w=M[0];case 2:return g.T(K,LU5(F,w,b,u),4);case 4:q=K.U;v=q.mainVideoEntity;a=q.channelEntity;g.lk(K,5);var p=y0(v.thumbnail),m=y0(a.avatar);return g.T(K,fh(p.concat(m)),7);case 7:g.Wa(K,0);break;case 5:e=g.dY(K),e instanceof Error&&e.message==="Failed to fetch"&&I_(e.message),g.N4(K)}})},LU5=function(F,J,b,I){var u,w,M,q,v,a,e,K,p,m,y,f,d;
return g.S(function(G){switch(G.C){case 1:b||(b=Date.now().toString());w=(u=J.channel)==null?void 0:u.offlineChannelData;M={id:g.Ms(J.videoId,"ytMainChannelEntity"),channelId:w.channelId,title:w.title,avatar:w.thumbnail};q={key:g.Ms(J.videoId,"mainVideoDownloadStateEntity"),playbackData:g.Ms(J.videoId,"playbackData"),addedTimestampMillis:b,videoDownloadContextEntity:g.Ms(J.videoId,"videoDownloadContextEntity")};v={key:g.Ms(J.videoId,"videoPlaybackPositionEntity"),videoId:J.videoId,lastPlaybackPositionSeconds:"0"};
F.rD.S("html5_offline_playback_position_sync")&&(a={playbackPosition:v.key});e=g.Ms(J.videoId,"mainVideoEntity");K={key:e,videoId:J.videoId,title:J.title,thumbnail:J.thumbnail,localizedStrings:{viewCount:J.shortViewCountText},userState:a,lengthSeconds:J.lengthSeconds?Number(J.lengthSeconds):void 0,publishedTimestampMillis:J.publishedTimestamp?(Number(J.publishedTimestamp)*1E3).toString():void 0,formattedDescription:J.description,owner:M.id,downloadState:q.key};if(!F.rD.S("woffle_enable_main_downloads_library")||
!I){G.gD(2);break}return g.T(G,QNb(F.C,[e]),3);case 3:if(y=G.U)p=y.mainDownloadsLibraryEntity,m=y.mainDownloadsListEntity;case 2:return d=dBb,f={key:g.Ms(J.videoId,"downloadStatusEntity"),downloadState:"DOWNLOAD_STATE_PENDING_DOWNLOAD"},g.CO(q,d,f),g.T(G,ns(F.C,{mode:"readwrite",Em:!0},function(P){var r=hl(P,M,"ytMainChannelEntity"),Q=hl(P,q,"mainVideoDownloadStateEntity"),D=hl(P,K,"mainVideoEntity");r=[r,Q,D];F.rD.S("html5_offline_playback_position_sync")&&(Q=hl(P,v,"videoPlaybackPositionEntity"),
r.push(Q));p&&(Q=hl(P,p,"mainDownloadsLibraryEntity"),r.push(Q));m&&(Q=hl(P,m,"mainDownloadsListEntity"),r.push(Q));f&&(P=hl(P,f,"downloadStatusEntity"),r.push(P));return g.fD.all(r)}),4);
case 4:return G.return({mainVideoEntity:K,channelEntity:M})}})},F5e=function(F,J,b){this.C=F;
this.rD=J;this.T=b},b6k=function(F,J){var b,I,u,w,M,q,v,a,e,K,p,m,y,f,d,G,P,r,Q,D,t,n,uk,AJ,F7,h,L;
return g.S(function(l){switch(l.C){case 1:return b=vH(J),I=[],g.T(l,QQ.getInstance(),2);case 2:u=l.U;if(!u){l.gD(3);break}return g.T(l,u.get("sdois"),4);case 4:return w=l.U,g.T(l,(q=u)==null?void 0:q.get("lmqf"),5);case 5:M=l.U;case 3:g.lk(l,6);if(w===void 0)throw Error("prefStorage or opt-in state is undefined");v=[];if(w){l.gD(8);break}return g.T(l,Xct(F.C),9);case 9:v=l.U,v.reverse();case 8:if(!v.length){l.gD(10);break}a=g.N(v);e=a.next();case 11:if(e.done){l.gD(10);break}K=e.value;if(!K){l.gD(12);
break}p=g.w0(K).entityId;return g.T(l,EI(F.C,p),14);case 14:return m=l.U,m.offlineDeleteReason="OFFLINE_DELETE_REASON_PARENT_LIST_DELETE",g.T(l,WH(p,F.C,{entityKey:K,actionType:J.actionType},F.T,m),12);case 12:e=a.next();l.gD(11);break;case 10:return g.T(l,bqm(w,(y=M)!=null?y:"SD"),16);case 16:return f=l.U,g.T(l,YNk(f),17);case 17:d=Cu1(f);if(!F.rD.S("woffle_enable_main_downloads_library")){l.gD(18);break}if(w){l.gD(19);break}return g.T(l,DB8(F.C,g.$E),19);case 19:return g.T(l,RY1(F.C,[g.$E]),18);
case 18:if((G=d)==null?0:G.length)for(P=g.N(d),r=P.next();!r.done;r=P.next())if(D=Q=r.value,t=D.actionType,n=D.entityKey,uk=D.actionMetadata,t&&n&&uk&&!g.O(uk,JnR)){t==="OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE"&&(uk.offlineLoggingData={offlineDeleteReason:"OFFLINE_DELETE_REASON_PARENT_LIST_DELETE"});if(AJ=g.O(Q.actionMetadata,nh))AJ.playlistId="DOWNLOADS_LIST_ENTITY_ID_SMART_DOWNLOADS",Q.actionMetadata=Object.assign({},Q.actionMetadata,{mainVideoEntityActionMetadata:AJ});I.push(Q)}g.Wa(l,7);break;
case 6:return F7=g.dY(l),h="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",L="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",F7 instanceof g.gZ&&F7.type==="QUOTA_EXCEEDED"&&(h="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",L="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),l.return(new sI("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",b,void 0,h,L));case 7:return l.return(new sI("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",b,I))}})},ICb=function(){cH.apply(this,arguments);
this.N="mainVideoEntity"},u4V=function(F,J,b){J=J===void 0?43200:J;
b=b===void 0?!0:b;var I=I===void 0?!1:I;var u,w,M;return g.S(function(q){switch(q.C){case 1:if(!F.W.Vi())return q.return([]);u=[];g.lk(q,2);return g.T(q,Fat(J,b,I),4);case 4:u=q.U;g.Wa(q,3);break;case 2:w=g.dY(q),w instanceof Error&&w.message==="No data"||w instanceof Error&&w.message==="Empty response body"&&I_(w.message);case 3:return M=sEk(F,u,b,"mainPlaylistEntity"),q.return(M)}})},wVk=function(F,J,b,I){I=I===void 0?!1:I;
var u,w,M,q,v,a,e,K,p,m,y,f,d,G,P;return g.S(function(r){switch(r.C){case 1:return u=[],g.T(r,JS5(),2);case 2:return(w=r.U)||I?g.T(r,ISL(J,b),3):r.return([]);case 3:M=r.U;if((q=M)==null||!q.length)return r.return([]);v={offlineDeleteReason:"OFFLINE_DELETE_REASON_PARENT_LIST_REFRESH"};a=g.N(M);e=a.next();case 4:if(e.done){r.gD(6);break}p=K=e.value;m=p.actionType;y=p.entityKey;f=p.actionMetadata;if(!(m&&y&&f)||g.O(f,JnR)){r.gD(5);break}m==="OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE"&&(f.offlineLoggingData=
v);d=g.w0(y);G=d.entityId;return g.T(r,UI(F,[G],"mainVideoEntity",m,f),8);case 8:P=r.U,u=u.concat(P);case 5:e=a.next();r.gD(4);break;case 6:return r.return(u)}})},MM5=function(F,J){this.C=F;
this.T=J},qJL=function(F,J){var b,I,u,w,M,q,v,a,e,K,p,m,y,f,d,G;
return g.S(function(P){switch(P.C){case 1:return b=vH(J),I=g.w0(J.entityKey),u=I.entityId,w=[],g.lk(P,2),g.T(P,AnU(F,u),4);case 4:w=P.U;if((M=w)==null||!M.length){P.gD(5);break}return g.T(P,cWU(F.C,J.entityKey),5);case 5:g.Wa(P,3);break;case 2:return q=g.dY(P),v="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",a="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",q instanceof g.gZ&&q.type==="QUOTA_EXCEEDED"&&(v="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",a="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),
P.return(new sI("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",b,void 0,v,a));case 3:return e=[],g.T(P,EgV(F.C,"musicTrack",w),7);case 7:w=P.U;if(w.length)for(K=g.N(w),p=K.next();!p.done;p=K.next())if(m=p.value,y=m.offlineVideoData,f=void 0,(f=y)==null?0:f.videoId)d=void 0,G=Number(((d=J.actionMetadata)==null?void 0:d.priority)||0)+1,e.push(SG("OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",y.videoId,"musicTrack",G,tO,PH(J,y,u)));return P.return(new sI("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",b,e))}})},
vdV=function(F,J){var b,I,u,w,M,q,v,a,e,K,p,m,y,f,d,G,P,r,Q,D,t,n,uk,AJ,F7,h,L,l,c,Da,fz,Kz,Vz,Za,Ib,yU,E,V,B,Y,X,JJ,wY,M4,C,ez,yz,va,rY,pz,QU,Kf,hJ,QI,qX,rU,of,af,oD;
return g.S(function(Ry){switch(Ry.C){case 1:return b=vH(J),I=J.entityKey,u=g.w0(I).entityId,w=[],M=!1,u==="!*$_ALL_ENTITIES_!*$"?(M=!0,g.T(Ry,Hb(F.C,"musicAlbumRelease"),5)):g.T(Ry,ZK(F.C,I,"musicAlbumRelease"),4);case 4:(q=Ry.U)&&w.push(q);Ry.gD(3);break;case 5:w=Ry.U;case 3:if((v=w)==null||!v.length)return Ry.return(new sI("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",b));if(M){a=[];e=g.N(w);for(K=e.next();!K.done;K=e.next())p=K.value,m=g.w0(p.id).entityId,a.push(SG("OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH",
m,"musicAlbumRelease",0,tO));return Ry.return(new sI("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",b,a))}y=[];f=w[0];d=void 0;if(!f.downloadMetadata){Ry.gD(6);break}return g.T(Ry,ZK(F.C,f.downloadMetadata,"musicAlbumReleaseDownloadMetadataEntity"),7);case 7:G=Ry.U,d=Number((r=(P=G)==null?void 0:P.addedTimestampMillis)!=null?r:"0")/1E3;case 6:return g.lk(Ry,8),g.T(Ry,AnU(F,u,(Q=d)==null?void 0:Q.toString()),10);case 10:y=Ry.U;g.Wa(Ry,9);break;case 8:D=g.dY(Ry);if(!(D instanceof Error&&D.message===
"No data")){if(D instanceof Error&&D.message==="Empty response body")I_(D.message);else return t="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",n="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",D instanceof g.gZ&&D.type==="QUOTA_EXCEEDED"&&(t="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",n="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),Ry.return(new sI("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",b,void 0,t,n));Ry.gD(9);break}return g.T(Ry,GO(u,"musicAlbumRelease",F.C,
J,F.T),9);case 9:uk=[];AJ=new Map;if((F7=y)==null?0:F7.length)for(h=g.N(y),L=h.next();!L.done;L=h.next())l=L.value,c=l.offlineVideoData,Da=void 0,((Da=c)==null?0:Da.videoId)&&AJ.set(c.videoId,c);fz=new Map;Kz=[];if((Vz=f)==null?0:(Za=Vz.tracks)==null?0:Za.length)for(Ib=g.N(f.tracks),yU=Ib.next();!yU.done;yU=Ib.next())if(E=yU.value,V=g.w0(E).entityId)AJ.has(V)?(fz.set(V,AJ.get(V)),AJ.delete(V)):Kz.push(V);Y=Number(((B=J.actionMetadata)==null?void 0:B.priority)||0)+1;X=g.N(AJ.entries());for(JJ=X.next();!JJ.done;JJ=
X.next())wY=JJ.value,M4=g.N(wY),C=M4.next().value,ez=M4.next().value,yz=C,va=ez,uk.push(SG("OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",yz,"musicTrack",Y,tO,PH(J,va)));rY=g.N(fz.entries());for(pz=rY.next();!pz.done;pz=rY.next())QU=pz.value,Kf=g.N(QU),hJ=Kf.next().value,QI=Kf.next().value,qX=hJ,rU=QI,uk.push(SG("OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH",qX,"musicTrack",Y,tO,PH(J,rU)));of=g.N(Kz);for(af=of.next();!af.done;af=of.next())oD=af.value,uk.push(SG("OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE",oD,
"musicTrack",0,tO));return Ry.return(new sI("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",b,uk))}})},aCU=function(F,J){var b,I;
return g.S(function(u){switch(u.C){case 1:return b=vH(J),g.lk(u,2),I=g.w0(J.entityKey).entityId,I==="!*$_ALL_ENTITIES_!*$"?g.T(u,V0(F.C,J,F.T),5):g.T(u,GO(I,"musicAlbumRelease",F.C,J,F.T),6);case 6:return g.T(u,UBV(F.C,J.entityKey),5);case 5:g.Wa(u,3);break;case 2:return g.dY(u),u.return(new sI("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",b,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 3:return u.return(new sI("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
b))}})},AnU=function(F,J,b){var I,u,w;
return g.S(function(M){switch(M.C){case 1:return g.T(M,HL1([J]),2);case 2:return I=M.U,g.T(M,e41(F,I[0],b),3);case 3:return u=M.U,w=y0(u.thumbnailDetails),g.T(M,fh(w),4);case 4:return M.return(I[0].videos)}})},e41=function(F,J,b){var I,u,w,M,q,v,a,e,K,p,m,y,f,d;
return g.S(function(G){if(G.C==1){I=J.additionalMetadadatas;u=void 0;if(I&&I.length>0)for(w=g.N(I),M=w.next();!M.done;M=w.next())if(q=M.value,q.offlineMusicPlaylistData){u=q.offlineMusicPlaylistData;break}v=J.playlistId;a=xBb(J);e=a.cU;K=a.mM;p=b?(Number(b)*1E3).toString():Date.now().toString();m=J.lastModifiedTimestamp?(Number(J.lastModifiedTimestamp)*1E3).toString():"0";y={id:g.Ms(v,"musicAlbumReleaseDownloadMetadataEntity"),trackDownloadMetadatas:K,lastModifiedTimestampMillis:m,addedTimestampMillis:p,
syncState:"DOWNLOAD_SYNC_STATE_UP_TO_DATE"};f={id:g.Ms(v,"musicAlbumRelease"),title:J.title,audioPlaylistId:v,trackCount:J.totalVideoCount,tracks:e,downloadMetadata:y.id};u&&(f.thumbnailDetails=(d=u.albumHqThumbnail)!=null?d:u.albumArtistThumbnail,f.artistDisplayName=u.albumArtistDisplayName,f.releaseDate=u.albumReleaseDate,f.contentRating={explicitType:u.albumReleaseExplicitType},f.releaseType=u.albumReleaseType);return g.T(G,ns(F.C,{mode:"readwrite",Em:!0},function(P){var r=hl(P,f,"musicAlbumRelease");
P=hl(P,y,"musicAlbumReleaseDownloadMetadataEntity");return g.fD.all([r,P])}),2)}return G.return(f)})},K5m=function(F,J){this.C=F;
this.T=J},gdz=function(F,J){var b,I,u,w,M,q,v,a,e,K,p,m,y,f,d,G;
return g.S(function(P){switch(P.C){case 1:return b=vH(J),I=g.w0(J.entityKey),u=I.entityId,w=[],g.lk(P,2),g.T(P,pVt(F,u),4);case 4:w=P.U;if((M=w)==null||!M.length){P.gD(5);break}return g.T(P,cWU(F.C,J.entityKey),5);case 5:g.Wa(P,3);break;case 2:return q=g.dY(P),v="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",a="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",q instanceof g.gZ&&q.type==="QUOTA_EXCEEDED"&&(v="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",a="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),
P.return(new sI("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",b,void 0,v,a));case 3:return e=[],g.T(P,EgV(F.C,"musicTrack",w),7);case 7:w=P.U;if(w.length)for(K=g.N(w),p=K.next();!p.done;p=K.next())if(m=p.value,y=m.offlineVideoData,f=void 0,(f=y)==null?0:f.videoId)d=void 0,G=Number(((d=J.actionMetadata)==null?void 0:d.priority)||0)+1,e.push(SG("OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",y.videoId,"musicTrack",G,Zl,PH(J,y,u)));return P.return(new sI("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",b,e))}})},
mrU=function(F,J){var b,I,u,w,M,q,v,a,e,K,p,m,y,f,d,G,P,r,Q,D,t,n,uk,AJ,F7,h,L,l,c,Da,fz,Kz,Vz,Za,Ib,yU,E,V,B,Y,X,JJ,wY,M4,C,ez,yz,va,rY,pz,QU,Kf,hJ,QI,qX,rU,of,af,oD,Ry,h6,lB,eq,rb,pI,SP,s4,Yo,PR,HW,cz;
return g.S(function(Iy){switch(Iy.C){case 1:return b=vH(J),I=J.entityKey,u=g.w0(I).entityId,w=[],M=!1,u==="!*$_ALL_ENTITIES_!*$"?(M=!0,g.T(Iy,Hb(F.C,"musicPlaylist"),5)):g.T(Iy,ZK(F.C,I,"musicPlaylist"),4);case 4:(q=Iy.U)&&w.push(q);Iy.gD(3);break;case 5:w=Iy.U;case 3:if((v=w)==null||!v.length)return Iy.return(new sI("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",b));a=g.O(J.actionMetadata,ngb);K=(e=a)==null?void 0:e.autoSync;p=[];y=m=!0;f=!1;d=void 0;if(!M&&K===!1){Iy.gD(6);break}g.lk(Iy,7);return g.T(Iy,
uLL(0,!!K,!0,w),9);case 9:p=Iy.U;g.Wa(Iy,8);break;case 7:G=g.dY(Iy);if(!(G instanceof Error&&G.message==="No data")){G instanceof Error&&G.message==="Empty response body"&&I_(G.message);Iy.gD(8);break}return u==="!*$_ALL_ENTITIES_!*$"?g.T(Iy,V0(F.C,J,F.T),8):g.T(Iy,GO(u,"musicPlaylist",F.C,J,F.T),8);case 8:if(!p.length||!M&&p[0].playlistId!==u)return Iy.return(new sI("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",b));case 6:if(M){P=[];r=g.N(p);for(Q=r.next();!Q.done;Q=r.next())D=Q.value,D.upToDate||
K&&!D.shouldAutoSyncMetadata||!D.playlistId||(t={autoSync:K},P.push(SG("OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH",D.playlistId,"musicPlaylist",0,Zl,{musicPlaylistEntityActionMetadata:t})));return Iy.return(new sI("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",b,P))}p.length&&(n=p[0],f=!!n.upToDate,K&&(m=(uk=n.shouldAutoSyncMetadata)!=null?uk:!0,y=(AJ=n.shouldAutoSyncVideos)!=null?AJ:!0,n.checkInSeconds&&(d=n.checkInSeconds)));if(f||!m)return Iy.return(new sI("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
b));F7=[];h=w[0];L=void 0;if(!h.downloadMetadata){Iy.gD(15);break}return g.T(Iy,ZK(F.C,h.downloadMetadata,"musicPlaylistDownloadMetadataEntity"),16);case 16:l=Iy.U,L=Number((Da=(c=l)==null?void 0:c.addedTimestampMillis)!=null?Da:"0")/1E3;case 15:return g.lk(Iy,17),g.T(Iy,pVt(F,u,(fz=L)==null?void 0:fz.toString(),d),19);case 19:F7=Iy.U;g.Wa(Iy,18);break;case 17:Kz=g.dY(Iy);if(!(Kz instanceof Error&&Kz.message==="No data")){if(Kz instanceof Error&&Kz.message==="Empty response body")I_(Kz.message);else return Vz=
"OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",Za="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",Kz instanceof g.gZ&&Kz.type==="QUOTA_EXCEEDED"&&(Vz="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",Za="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),Iy.return(new sI("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",b,void 0,Vz,Za));Iy.gD(18);break}return g.T(Iy,GO(u,"musicPlaylist",F.C,J,F.T),18);case 18:if(!y)return Iy.return(new sI("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
b));Ib=[];yU=new Map;if((E=F7)==null?0:E.length)for(V=g.N(F7),B=V.next();!B.done;B=V.next())Y=B.value,X=Y.offlineVideoData,JJ=void 0,((JJ=X)==null?0:JJ.videoId)&&yU.set(X.videoId,X);wY=new Map;M4=[];if((C=h)==null?0:(ez=C.tracks)==null?0:ez.length)for(yz=g.N(h.tracks),va=yz.next();!va.done;va=yz.next())if(rY=va.value,pz=g.w0(rY).entityId)yU.has(pz)?(wY.set(pz,yU.get(pz)),yU.delete(pz)):M4.push(pz);Kf=Number(((QU=J.actionMetadata)==null?void 0:QU.priority)||0)+1;hJ=g.N(yU.entries());for(QI=hJ.next();!QI.done;QI=
hJ.next())qX=QI.value,rU=g.N(qX),of=rU.next().value,af=rU.next().value,oD=of,Ry=af,Ib.push(SG("OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",oD,"musicTrack",Kf,Zl,PH(J,Ry)));h6=g.N(wY.entries());for(lB=h6.next();!lB.done;lB=h6.next())eq=lB.value,rb=g.N(eq),pI=rb.next().value,SP=rb.next().value,s4=pI,Yo=SP,Ib.push(SG("OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH",s4,"musicTrack",Kf,Zl,PH(J,Yo)));PR=g.N(M4);for(HW=PR.next();!HW.done;HW=PR.next())cz=HW.value,Ib.push(SG("OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE",
cz,"musicTrack",0,Zl));return Iy.return(new sI("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",b,Ib))}})},yn5=function(F,J){var b,I;
return g.S(function(u){switch(u.C){case 1:return b=vH(J),g.lk(u,2),I=g.w0(J.entityKey).entityId,I==="!*$_ALL_ENTITIES_!*$"?g.T(u,V0(F.C,J,F.T),5):g.T(u,GO(I,"musicPlaylist",F.C,J,F.T),6);case 6:return g.T(u,UBV(F.C,J.entityKey),5);case 5:g.Wa(u,3);break;case 2:return g.dY(u),u.return(new sI("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",b,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 3:return u.return(new sI("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
b))}})},pVt=function(F,J,b,I){var u,w,M;
return g.S(function(q){switch(q.C){case 1:return g.T(q,HL1([J]),2);case 2:return u=q.U,g.T(q,i6b(F,u[0],b,I),3);case 3:return w=q.U,M=y0(w.thumbnailDetails),g.T(q,fh(M),4);case 4:return q.return(u[0].videos)}})},i6b=function(F,J,b,I){var u,w,M,q,v,a,e,K,p;
return g.S(function(m){return m.C==1?(u=J.playlistId,w=xBb(J),M=w.cU,q=w.mM,v=b?(Number(b)*1E3).toString():Date.now().toString(),a=J.lastModifiedTimestamp?(Number(J.lastModifiedTimestamp)*1E3).toString():"0",e={id:g.Ms(u,"musicPlaylistDownloadMetadataEntity"),trackDownloadMetadatas:q,lastModifiedTimestampMillis:a,addedTimestampMillis:v,syncState:"DOWNLOAD_SYNC_STATE_UP_TO_DATE"},K={id:g.Ms(u,"musicPlaylist"),title:J.title,playlistId:u,thumbnailDetails:J.thumbnail,visibility:z41(J),trackCount:J.totalVideoCount,
tracks:M,downloadMetadata:e.id},I&&(((p=K)==null?0:p.entityMetadata)?K.entityMetadata.nextAutoRefreshIntervalSeconds=String(I):K&&(K.entityMetadata={nextAutoRefreshIntervalSeconds:String(I)})),g.T(m,ns(F.C,{mode:"readwrite",Em:!0},function(y){var f=hl(y,K,"musicPlaylist");y=hl(y,e,"musicPlaylistDownloadMetadataEntity");return g.fD.all([f,y])}),2)):m.return(K)})},z41=function(F){switch(F.privacy){case "PRIVATE":return"PLAYLIST_ENTITY_VISIBILITY_PRIVATE";
case "PUBLIC":return"PLAYLIST_ENTITY_VISIBILITY_PUBLIC";case "UNLISTED":return"PLAYLIST_ENTITY_VISIBILITY_UNLISTED";default:return"PLAYLIST_ENTITY_VISIBILITY_UNKNOWN"}},NDR=function(F,J){this.C=F;
this.T=J},drt=function(F,J){var b,I,u,w,M,q,v,a,e,K,p,m,y;
return g.S(function(f){switch(f.C){case 1:return b=vH(J),I=g.w0(J.entityKey),u=I.entityId,w=g.O(J.actionMetadata,lCm),g.lk(f,2),g.T(f,fC1(F,u,void 0,(M=w)==null?void 0:M.track,(q=w)==null?void 0:q.albumRelease),4);case 4:if((v=w)==null?0:v.playlistId){f.gD(5);break}return g.T(f,cWU(F.C,J.entityKey),5);case 5:g.Wa(f,3);break;case 2:return a=g.dY(f),e="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",K="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",a instanceof g.gZ&&a.type==="QUOTA_EXCEEDED"&&
(e="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",K="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),f.return(new sI("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",b,void 0,e,K));case 3:m=Number(((p=J.actionMetadata)==null?void 0:p.priority)||0)+1;var d=(d=g.O(J.actionMetadata,lCm))?{playbackDataActionMetadata:{maximumDownloadQuality:d.maximumDownloadQuality}}:void 0;y=SG("OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",u,"playbackData",m,W5H,d);return f.return(new sI("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
b,[y]))}})},Ede=function(F,J){var b,I,u,w,M,q,v,a,e,K,p,m,y,f,d;
return g.S(function(G){switch(G.C){case 1:return b=vH(J),I=g.w0(J.entityKey),u=I.entityId,g.T(G,ZK(F.C,J.entityKey,"musicTrack"),2);case 2:w=G.U;if(!w){M=void 0;G.gD(3);break}return g.T(G,ZK(F.C,w.downloadMetadata,"musicTrackDownloadMetadataEntity"),4);case 4:M=G.U;case 3:q=M;if(!w||!q)return G.return(new sI("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",b));a=g.O(J.actionMetadata,lCm);g.lk(G,5);return g.T(G,fC1(F,u,q.addedTimestampMillis,(e=a)==null?void 0:e.track,(K=a)==null?void 0:K.albumRelease),
7);case 7:m=Number(((p=J.actionMetadata)==null?void 0:p.priority)||0)+1;v=SG("OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH",u,"playbackData",m,W5H);g.Wa(G,6);break;case 5:y=g.dY(G);if(!(y instanceof Error&&y.message==="No data")){if(y instanceof Error&&y.message==="Empty response body")I_(y.message);else return f="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",d="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",y instanceof g.gZ&&y.type==="QUOTA_EXCEEDED"&&(f="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",
d="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),G.return(new sI("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",b,void 0,f,d));G.gD(6);break}return g.T(G,jG(u,F.C,J,F.T),6);case 6:return G.return(new sI("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",b,v?[v]:void 0))}})},j35=function(F,J){var b,I;
return g.S(function(u){switch(u.C){case 1:return b=vH(J),g.lk(u,2),I=g.w0(J.entityKey).entityId,I==="!*$_ALL_ENTITIES_!*$"?g.T(u,V0(F.C,J,F.T),5):g.T(u,jG(I,F.C,J,F.T),6);case 6:return g.T(u,UBV(F.C,J.entityKey),5);case 5:g.Wa(u,3);break;case 2:return g.dY(u),u.return(new sI("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",b,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 3:return u.return(new sI("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
b))}})},fC1=function(F,J,b,I,u){var w,M,q,v,a,e;
return g.S(function(K){switch(K.C){case 1:if(w=I){K.gD(2);break}return g.T(K,ZL5([J]),3);case 3:M=K.U,q=M[0],w=hYk(q);case 2:return g.T(K,G8b(F,w,J,u,b),4);case 4:v=K.U;a=v.musicTrackEntity;e=v.fz;var p=y0(a.thumbnailDetails),m=[];e&&(m=y0(e.thumbnailDetails));return g.T(K,fh(p.concat(m)),0)}})},G8b=function(F,J,b,I,u){var w;
return g.S(function(M){return M.C==1?(u||(u=Date.now().toString()),w={id:g.Ms(b,"musicTrackDownloadMetadataEntity"),playbackData:g.Ms(b,"playbackData"),addedTimestampMillis:u,videoDownloadContextEntity:g.Ms(b,"videoDownloadContextEntity")},I&&(J.albumRelease=I.id),g.T(M,ns(F.C,{mode:"readwrite",Em:!0},function(q){var v=[],a=hl(q,w,"musicTrackDownloadMetadataEntity");v.push(a);a=hl(q,J,"musicTrack");v.push(a);I&&(q=hl(q,I,"musicAlbumRelease"),v.push(q));return g.fD.all(v)}),2)):M.C!=3?g.T(M,ph(b,"musicTrackDownloadMetadataEntity",
F.C,"DOWNLOAD_STATE_PENDING_DOWNLOAD"),3):M.return({musicTrackEntity:J,
fz:I})})},HH=function(){cH.apply(this,arguments);
this.N="musicTrack"},VMW=function(F,J,b){J=J===void 0?43200:J;
b=b===void 0?!0:b;var I=I===void 0?!1:I;var u,w;return g.S(function(M){switch(M.C){case 1:if(!F.W.Vi())return M.return([]);u=[];g.lk(M,2);return g.T(M,uLL(J,b,I),4);case 4:u=M.U;g.Wa(M,3);break;case 2:g.dY(M);case 3:return w=sEk(F,u,b,"musicPlaylist"),M.return(w)}})},PGW=function(){g.GN.apply(this,arguments);
var F=this;this.events=new g.s5(this);this.rD=this.player.J();this.Po={K5E:function(){return F.C},
fG:function(){return F.fG()},
SJ:function(J){return F.SJ(J)}}},BDU=function(F){var J;
F=g.O((J=F.getWatchNextResponse())==null?void 0:J.currentVideoEndpoint,g.x$);if(F==null?0:F.playlistId)var b=F.playlistId;return b},TDH=function(F,J){var b,I,u,w;
return g.S(function(M){if(M.C==1){b=J.clientPlaybackNonce;I={cpn:b,offlineSourceVisualElement:g.NY(J.WN||"").getAsJson(),selectedOfflineMode:"OFFLINE_NOW",isPartialPlayback:!1};J.U&&(I.videoFmt=Number(J.U.itag));J.Z&&(I.audioFmt=Number(J.Z.itag));if((u=BDU(J))&&J.videoId){var q=J.videoId;q=u!=="PPSV"?Promise.resolve(!1):F.C.bW(q);M=g.T(M,q,3)}else M=M.gD(2);return M}M.C!=2&&(w=M.U)&&(I.selectedOfflineMode="OFFLINE_MODE_TYPE_AUTO_OFFLINE");F.U=b;g.AY("offlinePlaybackStarted",I);g.N4(M)})};
g.ly.prototype.v$=g.IG(45,function(F){return this.app.v$(F)});
g.Np.prototype.v$=g.IG(44,function(F){return g.lK(this,9,F)});
g.z(Cs,$t);g.q4.Object.defineProperties(Cs.prototype,{entityMetadata:{configurable:!0,enumerable:!0,get:function(){return this.C.entityMetadata},
set:function(F){this.C.entityMetadata=F}}});
g.z(G5b,Cs);G5b.prototype.U=function(){return[]};
g.z(VWW,Cs);VWW.prototype.U=function(){return[]};
g.z(P3H,Cs);P3H.prototype.U=function(){return[]};
g.z(B88,Cs);B88.prototype.U=function(){return[]};
g.z(T8b,Cs);T8b.prototype.U=function(){var F=[];this.C.alternateChannel&&F.push(this.C.alternateChannel);this.C.alternateChannelList&&F.push.apply(F,g.W(this.C.alternateChannelList));this.C.oneofChannelEntity&&F.push(this.C.oneofChannelEntity);return[].concat(g.W(new Set(F)))};
g.z(rvb,Cs);rvb.prototype.U=function(){var F=[];this.C.entryCollection&&F.push(this.C.entryCollection);return[].concat(g.W(new Set(F)))};
g.z(SUb,$t);SUb.prototype.U=function(){var F=[];this.C.video&&F.push(this.C.video);return[].concat(g.W(new Set(F)))};
g.z(s6L,Cs);s6L.prototype.U=function(){var F=[];this.C.parentPlaylist&&F.push(this.C.parentPlaylist);if(this.C.entries)for(var J=g.N(this.C.entries),b=J.next();!b.done;b=J.next())F.push.apply(F,g.W((new SUb(b.value)).U()));return[].concat(g.W(new Set(F)))};
g.z(YUU,Cs);YUU.prototype.U=function(){var F=[];this.C.descriptionEntity&&F.push(this.C.descriptionEntity);this.C.creators&&F.push.apply(F,g.W(this.C.creators));this.C.theBiggestFan&&F.push(this.C.theBiggestFan);return[].concat(g.W(new Set(F)))};
g.z($6b,Cs);$6b.prototype.U=function(){return[]};
g.z(C35,Cs);C35.prototype.U=function(){return[]};
g.z(XRR,Cs);XRR.prototype.U=function(){return[]};
g.z(Q6R,Cs);Q6R.prototype.U=function(){return[]};
g.z(RPe,Cs);RPe.prototype.U=function(){return[]};
g.z(D6W,Cs);D6W.prototype.U=function(){return[]};
g.z(k5k,Cs);k5k.prototype.U=function(){return[]};
g.z(O2z,Cs);O2z.prototype.U=function(){return[]};
g.z(o9U,Cs);o9U.prototype.U=function(){return[]};
g.z(hPU,Cs);hPU.prototype.U=function(){var F=[];this.C.downloadsList&&F.push(this.C.downloadsList);this.C.smartDownloadsList&&F.push(this.C.smartDownloadsList);this.C.recommendedDownloadsList&&F.push(this.C.recommendedDownloadsList);this.C.refresh&&F.push(this.C.refresh);return[].concat(g.W(new Set(F)))};
g.z(cvb,$t);cvb.prototype.U=function(){var F=[];this.C.video&&F.push(this.C.video);this.C.playlist&&F.push(this.C.playlist);this.C.videoItem&&F.push(this.C.videoItem);this.C.playlistItem&&F.push(this.C.playlistItem);return[].concat(g.W(new Set(F)))};
g.z(U6b,Cs);U6b.prototype.U=function(){var F=[];this.C.refresh&&F.push(this.C.refresh);if(this.C.downloads)for(var J=g.N(this.C.downloads),b=J.next();!b.done;b=J.next())F.push.apply(F,g.W((new cvb(b.value)).U()));return[].concat(g.W(new Set(F)))};
g.z(x61,Cs);x61.prototype.U=function(){var F=[];this.C.localImageEntities&&F.push.apply(F,g.W(this.C.localImageEntities));return[].concat(g.W(new Set(F)))};
g.z(n91,Cs);n91.prototype.U=function(){var F=[];this.C.playbackData&&F.push(this.C.playbackData);this.C.localImageEntities&&F.push.apply(F,g.W(this.C.localImageEntities));this.C.videoDownloadContextEntity&&F.push(this.C.videoDownloadContextEntity);return[].concat(g.W(new Set(F)))};
g.z(tW1,Cs);tW1.prototype.U=function(){return[]};
g.z(Z21,Cs);Z21.prototype.U=function(){var F=[];this.C.fakeChildren&&F.push.apply(F,g.W(this.C.fakeChildren));return[].concat(g.W(new Set(F)))};
g.z(H25,Cs);H25.prototype.U=function(){var F=[];this.C.video&&F.push(this.C.video);this.C.playbackData&&F.push(this.C.playbackData);this.C.offlineVideoPolicy&&F.push(this.C.offlineVideoPolicy);return[].concat(g.W(new Set(F)))};
g.z(L6t,Cs);L6t.prototype.U=function(){return[]};
g.z(FjU,Cs);FjU.prototype.U=function(){var F=[];this.C.channelOwner&&F.push(this.C.channelOwner);this.C.videos&&F.push.apply(F,g.W(this.C.videos));this.C.collaboratorChannels&&F.push.apply(F,g.W(this.C.collaboratorChannels));this.C.downloadState&&F.push(this.C.downloadState);this.C.refresh&&F.push(this.C.refresh);return[].concat(g.W(new Set(F)))};
g.z(JNW,Cs);JNW.prototype.U=function(){var F=[];this.C.video&&F.push(this.C.video);this.C.channelContributor&&F.push(this.C.channelContributor);return[].concat(g.W(new Set(F)))};
g.z(bM5,$t);bM5.prototype.U=function(){var F=[];this.C.localImageEntities&&F.push.apply(F,g.W(this.C.localImageEntities));this.C.videoDownloadContextEntity&&F.push(this.C.videoDownloadContextEntity);return[].concat(g.W(new Set(F)))};
g.z(IV1,$t);IV1.prototype.U=function(){var F=[];this.C.recommendedVideoMetadata&&F.push.apply(F,g.W((new bM5(this.C.recommendedVideoMetadata)).U()));return[].concat(g.W(new Set(F)))};
g.z(uBe,$t);uBe.prototype.U=function(){var F=[];this.C.playbackPosition&&F.push(this.C.playbackPosition);return[].concat(g.W(new Set(F)))};
g.z(wtV,Cs);wtV.prototype.U=function(){var F=[];this.C.owner&&F.push(this.C.owner);this.C.downloadState&&F.push(this.C.downloadState);this.C.userState&&F.push.apply(F,g.W((new uBe(this.C.userState)).U()));this.C.additionalMetadata&&F.push.apply(F,g.W((new IV1(this.C.additionalMetadata)).U()));return[].concat(g.W(new Set(F)))};
g.z(Mhb,Cs);Mhb.prototype.U=function(){var F=[];this.C.userChannelDetails&&F.push(this.C.userChannelDetails);return[].concat(g.W(new Set(F)))};
g.z(ANb,Cs);ANb.prototype.U=function(){var F=[];this.C.channelOwner&&F.push(this.C.channelOwner);this.C.playbackPosition&&F.push(this.C.playbackPosition);this.C.localImageEntities&&F.push.apply(F,g.W(this.C.localImageEntities));this.C.downloadStatus&&F.push(this.C.downloadStatus);return[].concat(g.W(new Set(F)))};
g.z(q45,Cs);q45.prototype.U=function(){return[]};
g.z(voU,Cs);voU.prototype.U=function(){return[]};
g.z(aVt,Cs);aVt.prototype.U=function(){return[]};
g.z(e$W,Cs);e$W.prototype.U=function(){return[]};
g.z(Kj8,Cs);Kj8.prototype.U=function(){return[]};
g.z(ptL,Cs);ptL.prototype.U=function(){return[]};
g.z(gob,Cs);gob.prototype.U=function(){return[]};
g.z(ml8,Cs);ml8.prototype.U=function(){return[]};
g.z(yNm,Cs);yNm.prototype.U=function(){return[]};
g.z(iMW,Cs);iMW.prototype.U=function(){return[]};
g.z(z$R,Cs);z$R.prototype.U=function(){return[]};
g.z(NRH,Cs);NRH.prototype.U=function(){var F=[];this.C.trackDownloadMetadatas&&F.push.apply(F,g.W(this.C.trackDownloadMetadatas));return[].concat(g.W(new Set(F)))};
g.z(lV1,Cs);
lV1.prototype.U=function(){var F=[];this.C.downloadedTracks&&F.push.apply(F,g.W(this.C.downloadedTracks));this.C.smartDownloadedTracks&&F.push.apply(F,g.W(this.C.smartDownloadedTracks));this.C.downloadedEpisodes&&F.push.apply(F,g.W(this.C.downloadedEpisodes));this.C.downloadedAlbumReleases&&F.push.apply(F,g.W(this.C.downloadedAlbumReleases));this.C.smartDownloadedAlbumReleases&&F.push.apply(F,g.W(this.C.smartDownloadedAlbumReleases));this.C.downloadedPlaylists&&F.push.apply(F,g.W(this.C.downloadedPlaylists));this.C.smartDownloadedPlaylists&&
F.push.apply(F,g.W(this.C.smartDownloadedPlaylists));this.C.metadataOnlyTracks&&F.push.apply(F,g.W(this.C.metadataOnlyTracks));return[].concat(g.W(new Set(F)))};
g.z(fVt,Cs);fVt.prototype.U=function(){var F=[];this.C.trackDownloadMetadatas&&F.push.apply(F,g.W(this.C.trackDownloadMetadatas));return[].concat(g.W(new Set(F)))};
g.z(Wjk,Cs);Wjk.prototype.U=function(){var F=[];this.C.playbackData&&F.push(this.C.playbackData);this.C.localImageEntities&&F.push.apply(F,g.W(this.C.localImageEntities));this.C.videoDownloadContextEntity&&F.push(this.C.videoDownloadContextEntity);return[].concat(g.W(new Set(F)))};
g.z(dlk,Cs);dlk.prototype.U=function(){var F=[];this.C.musicLibraryStatusEntity&&F.push(this.C.musicLibraryStatusEntity);this.C.primaryArtists&&F.push.apply(F,g.W(this.C.primaryArtists));this.C.details&&F.push(this.C.details);this.C.userDetails&&F.push(this.C.userDetails);this.C.tracks&&F.push.apply(F,g.W(this.C.tracks));this.C.share&&F.push(this.C.share);this.C.downloadMetadata&&F.push(this.C.downloadMetadata);this.C.refresh&&F.push(this.C.refresh);return[].concat(g.W(new Set(F)))};
g.z(Eo8,Cs);Eo8.prototype.U=function(){var F=[];this.C.albumRelease&&F.push(this.C.albumRelease);this.C.tracks&&F.push.apply(F,g.W(this.C.tracks));return[].concat(g.W(new Set(F)))};
g.z(j2k,Cs);j2k.prototype.U=function(){var F=[];this.C.albumRelease&&F.push(this.C.albumRelease);return[].concat(g.W(new Set(F)))};
g.z(GmU,Cs);GmU.prototype.U=function(){var F=[];this.C.details&&F.push(this.C.details);this.C.userDetails&&F.push(this.C.userDetails);return[].concat(g.W(new Set(F)))};
g.z(Vhm,Cs);Vhm.prototype.U=function(){var F=[];this.C.parentArtist&&F.push(this.C.parentArtist);return[].concat(g.W(new Set(F)))};
g.z(PFb,Cs);PFb.prototype.U=function(){var F=[];this.C.parentArtist&&F.push(this.C.parentArtist);return[].concat(g.W(new Set(F)))};
g.z(BR8,Cs);BR8.prototype.U=function(){return[]};
g.z(TRz,Cs);TRz.prototype.U=function(){return[]};
g.z(rNW,$t);rNW.prototype.U=function(){var F=[];this.C.creatorEntity&&F.push(this.C.creatorEntity);return[].concat(g.W(new Set(F)))};
g.z(S4b,Cs);
S4b.prototype.U=function(){var F=[];this.C.tracks&&F.push.apply(F,g.W(this.C.tracks));this.C.refresh&&F.push(this.C.refresh);this.C.musicLibraryStatusEntity&&F.push(this.C.musicLibraryStatusEntity);this.C.details&&F.push(this.C.details);this.C.downloadMetadata&&F.push(this.C.downloadMetadata);this.C.sideloadMetadata&&F.push(this.C.sideloadMetadata);this.C.userDetails&&F.push(this.C.userDetails);this.C.entryCollection&&F.push(this.C.entryCollection);this.C.share&&F.push(this.C.share);this.C.podcastShowAdditionalMetadata&&F.push.apply(F,
g.W((new rNW(this.C.podcastShowAdditionalMetadata)).U()));return[].concat(g.W(new Set(F)))};
g.z(s21,Cs);s21.prototype.U=function(){return[]};
g.z(Y4b,Cs);
Y4b.prototype.U=function(){var F=[];this.C.musicLibraryStatusEntity&&F.push(this.C.musicLibraryStatusEntity);this.C.artists&&F.push.apply(F,g.W(this.C.artists));this.C.audioModeVersion&&F.push(this.C.audioModeVersion);this.C.videoModeVersion&&F.push(this.C.videoModeVersion);this.C.userDetails&&F.push(this.C.userDetails);this.C.details&&F.push(this.C.details);this.C.albumRelease&&F.push(this.C.albumRelease);this.C.share&&F.push(this.C.share);this.C.libraryEdit&&F.push(this.C.libraryEdit);this.C.downloadMetadata&&
F.push(this.C.downloadMetadata);this.C.playbackPosition&&F.push(this.C.playbackPosition);this.C.lyrics&&F.push(this.C.lyrics);return[].concat(g.W(new Set(F)))};
g.z($lU,Cs);$lU.prototype.U=function(){var F=[];this.C.parentTrack&&F.push(this.C.parentTrack);return[].concat(g.W(new Set(F)))};
g.z(CFk,Cs);CFk.prototype.U=function(){var F=[];this.C.parentTrack&&F.push(this.C.parentTrack);return[].concat(g.W(new Set(F)))};
g.z(Xtm,Cs);Xtm.prototype.U=function(){return[]};
g.z(Q2e,Cs);Q2e.prototype.U=function(){return[]};
g.z(R$b,Cs);R$b.prototype.U=function(){return[]};
g.z(Dlm,Cs);Dlm.prototype.U=function(){return[]};
g.z(kmU,Cs);kmU.prototype.U=function(){var F=[];this.C.transfer&&F.push(this.C.transfer);this.C.adsPlaybackData&&F.push.apply(F,g.W(this.C.adsPlaybackData));this.C.drmLicense&&F.push(this.C.drmLicense);this.C.offlineVideoPolicy&&F.push(this.C.offlineVideoPolicy);this.C.videoDownloadContextEntity&&F.push(this.C.videoDownloadContextEntity);return[].concat(g.W(new Set(F)))};
g.z(OMU,Cs);OMU.prototype.U=function(){return[]};
g.z(ooW,Cs);ooW.prototype.U=function(){var F=[];this.C.offlineVideoStreams&&F.push.apply(F,g.W(this.C.offlineVideoStreams));this.C.captionTrack&&F.push.apply(F,g.W(this.C.captionTrack));return[].concat(g.W(new Set(F)))};
g.z(h$R,Cs);h$R.prototype.U=function(){return[]};
g.z(cNV,Cs);cNV.prototype.U=function(){return[]};
g.z(Ulb,Cs);Ulb.prototype.U=function(){return[]};
g.z(xlt,Cs);xlt.prototype.U=function(){return[]};
g.z(no5,Cs);no5.prototype.U=function(){return[]};
g.z(tht,Cs);tht.prototype.U=function(){return[]};
g.z(ZMU,Cs);ZMU.prototype.U=function(){return[]};
g.z(HMz,Cs);HMz.prototype.U=function(){return[]};
g.z(Ljm,Cs);Ljm.prototype.U=function(){return[]};
g.z(FxH,Cs);FxH.prototype.U=function(){return[]};
g.z(Jh5,Cs);Jh5.prototype.U=function(){return[]};
g.z(b_b,Cs);b_b.prototype.U=function(){return[]};
g.z(IAb,Cs);IAb.prototype.U=function(){return[]};
g.z(uV5,Cs);uV5.prototype.U=function(){return[]};
g.z(wYk,Cs);wYk.prototype.U=function(){return[]};
g.z(Mwb,Cs);Mwb.prototype.U=function(){return[]};
g.z(AhU,Cs);AhU.prototype.U=function(){return[]};
g.z(qGm,Cs);qGm.prototype.U=function(){return[]};
var w2L=["browse","music/browse","unplugged/browse"],aSt=["offline/playlist_sync_check"],tuH=["offline"],M7z=["offline/offline_video_playback_position_sync"],q0V=["offline/get_playback_data_entity"],Xr;QQ.getInstance=function(){return g.S(function(F){return F.return(new Promise(function(J){g.tY().then(function(b){b?(QQ.instance||(QQ.instance=new QQ(b)),J(QQ.instance)):J(void 0)})}))})};
QQ.prototype.get=function(F){var J=this,b,I,u;return g.S(function(w){if(w.C==1)return g.T(w,Kxm(J.token),2);if(w.C!=3)return b=w.U,g.T(w,b.get("prefs",F),3);I=w.U;if(!I)return w.return();u=(0,g.jR)();return I.expirationTimestampMs<=u?w.return():w.return(I.value)})};
QQ.prototype.set=function(F,J,b){b=b===void 0?31536E3:b;var I=this,u,w,M;return g.S(function(q){if(q.C==1)return u=(0,g.jR)(),w={key:F,value:J,expirationTimestampMs:u+b*1E3},g.T(q,Kxm(I.token),2);M=q.U;return g.T(q,g.rZ(M,"prefs",w),0)})};
QQ.prototype.remove=function(F){var J=this,b;return g.S(function(I){if(I.C==1)return g.T(I,Kxm(J.token),2);b=I.U;return g.T(I,b.delete("prefs",F),0)})};
g.z(R5,g.hC);g.z(DK,i_V);DK.prototype.T=function(F,J){J=Nfe(J);F=(new TextEncoder).encode(JSON.stringify(F));return this.C.encrypt(F,J)};
DK.prototype.U=function(F,J){if(!(F instanceof Uint8Array))throw pYk(1);var b=new TextDecoder;J=Nfe(J);F=this.C.decrypt(F,J);return JSON.parse(b.decode(F))};
var lAz={accountLinkStatusEntity:XRR,booleanEntity:P3H,buttonEntity:Jh5,captionTrack:Xtm,channelHandle:G5b,commerceAcquisitionClientPayloadEntity:IAb,commerceCartListEntity:uV5,contextNoteFeedEntityPayload:VWW,continuationTokenEntity:L6t,downloadQualityPickerEntity:k5k,downloadsPageRefreshTokenEntity:o9U,downloadsPageViewConfigurationEntity:q45,downloadStatusEntity:O2z,dismissState:no5,sfvAudioItemCurrentlyPlayingEntity:cNV,emojiFountainDataEntity:Ljm,emojiCustomizationSetEntity:HMz,fakeChannel:T8b,
fakePlaylist:rvb,fakePlaylistEntryCollection:s6L,fakeVideo:YUU,fakeVideoDescription:$6b,featuredProductsEntity:yNm,flowStateEntity:C35,iconBadgeEntity:wYk,interstitialInteractionStateEntity:RPe,likeButtonAnimationEntity:voU,liveChatPollStateEntity:D6W,liveReactionsDataEntity:FxH,logoEntity:Q6R,macroMarkerEntity:aVt,mainDownloadsLibraryEntity:hPU,mainDownloadsListEntity:U6b,mainPlaylistDownloadStateEntity:x61,mainPlaylistEntity:FjU,mainPlaylistVideoEntity:JNW,mainVideoDownloadStateEntity:n91,mainVideoEntity:wtV,
markersEngagementPanelSyncEntity:e$W,markersVisibilityOverrideEntity:Kj8,musicAlbumReleaseDetail:Eo8,musicAlbumReleaseDownloadMetadataEntity:NRH,musicAlbumRelease:dlk,musicAlbumReleaseUserDetail:j2k,musicArtistDetail:Vhm,musicArtist:GmU,musicArtistUserDetail:PFb,musicDownloadsLibraryEntity:lV1,musicLibraryEdit:BR8,musicLibraryStatusEntity:TRz,musicPlaylist:S4b,musicPlaylistDownloadMetadataEntity:fVt,musicShare:s21,musicTrackDetail:$lU,musicTrackDownloadMetadataEntity:Wjk,musicTrack:Y4b,musicTrackUserDetail:CFk,
offlineOrchestrationActionWrapperEntity:Q2e,offlineVideoPolicy:R$b,offlineVideoStreams:Dlm,offlineabilityEntity:tW1,orchestrationWebSamplingEntity:Z21,pageHeaderEntity:tht,pdpStateEntity:Mwb,pinnedProductEntity:iMW,playbackData:kmU,playerStateEntity:ptL,quantityIncrementerEntity:AhU,refresh:OMU,saveToPlaylistListEntity:Ulb,settingEntity:xlt,stringEntity:B88,suggestedFeedbackChipStateEntity:gob,transfer:ooW,trendingOfferEntity:z$R,videoDownloadContextEntity:h$R,videoOverviewAsyncDataEntity:qGm,videoPlaybackPositionEntity:b_b,
votingEntity:ZMU,ytMainChannelEntity:Mhb,youchatPendingResponseEntity:ml8,ytMainDownloadedVideoEntity:H25,ytMainVideoEntity:ANb};g.z(UA,i_V);UA.prototype.T=function(F){return F};
UA.prototype.U=function(F){if(F instanceof Uint8Array)throw pYk(0);return F};
g.z(xt,g.R);xt.prototype.observe=function(F){var J=this;this.observers.push(F);return function(){var b=J.observers.indexOf(F);b>=0&&J.observers.splice(b,1)}};
xt.prototype.U=function(F){YGL(this,F.data)};
xt.prototype.X_=function(){this.channel.close()};
var RAR,$Be=new g.Ek("elementsCommand");var dx=new g.Ek("entityBatchUpdate");var dBb=new g.Ek("downloadStatusEntity");var RbW=new g.Ek("mainPlaylistEntityActionMetadata");var nh=new g.Ek("mainVideoEntityActionMetadata");var ngb=new g.Ek("musicPlaylistEntityActionMetadata");var lCm=new g.Ek("musicTrackEntityActionMetadata");var JnR=new g.Ek("localImageEntityActionMetadata");var Yh=new g.Ek("playbackDataActionMetadata");var CRe=new g.Ek("transferEntityActionMetadata");var fSH=new g.Ek("videoPlaybackPositionEntityActionMetadata");var JW8;new g.m6;new g.m6;Mub.prototype.request=function(F,J,b){J=J===void 0?{}:J;return this.locks.request(F,J,function(I){return b(I)})};var bl=g.Qz.caches,JO,eY8;FM.prototype.open=function(F){return bl.open(vg1(F))};
FM.prototype.has=function(F){return bl.has(vg1(F))};
FM.prototype.delete=function(F){return bl.delete(vg1(F))};
FM.prototype.match=function(F,J){var b=this,I,u,w,M,q,v;return g.S(function(a){switch(a.C){case 1:return g.T(a,b.keys(),2);case 2:I=a.U,u=g.N(I),w=u.next();case 3:if(w.done){a.gD(5);break}M=w.value;return g.T(a,b.open(M),6);case 6:return q=a.U,g.T(a,q.match(F,J),7);case 7:if(v=a.U)return a.return(v);w=u.next();a.gD(3);break;case 5:return a.return()}})};
g.z(qNk,FM);qNk.prototype.keys=function(){var F,J,b,I,u,w,M,q,v;return g.S(function(a){if(a.C==1)return F=[],J=g.cK("CacheStorage keys"),g.T(a,bl.keys(),2);b=a.U;I=g.N(b);for(u=I.next();!u.done;u=I.next()){w=u.value;var e=w.indexOf(":");M=e===-1?{Rt:w}:{Rt:w.substring(0,e),datasyncId:w.substring(e+1)};q=M.Rt;v=M.datasyncId;v===J&&F.push(q)}return a.return(F)})};g.z(ul,g.R);ul.prototype.T=function(F){this.api.jE("onOfflineOperationFailure",F.data)};
ul.prototype.Z=function(F){this.api.publish("offlinetransferpause",F.data)};
ul.prototype.X_=function(){var F;(F=this.C)==null||F.close();var J;(J=this.U)==null||J.close()};ggH.prototype.G0=function(){this.C&&Mz(this)};
ggH.prototype.jA=function(){this.U&&this.U.resolve();this.T=this.C=!1;this.N()};var LaW=["OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD","OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH"];var SNW="captionTrack downloadStatusEntity ytMainChannelEntity mainPlaylistEntity mainPlaylistDownloadStateEntity mainPlaylistVideoEntity mainVideoEntity mainVideoDownloadStateEntity offlineVideoPolicy offlineVideoStreams playbackData transfer videoDownloadContextEntity videoPlaybackPositionEntity".split(" ");var ogL="downloadStatusEntity musicAlbumRelease musicDownloadsLibraryEntity musicPlaylist musicTrack musicTrackDownloadMetadataEntity offlineVideoPolicy offlineVideoStreams playbackData transfer videoDownloadContextEntity".split(" ");g.z(KaL,rx);KaL.prototype.U=function(F){return a_(F)?mN5(this,F):eG(F)?z8L(this,F):Promise.reject(Error("Unsupported action type: "+F.actionType))};g.z(N2R,rx);N2R.prototype.U=function(F){return eG(F)?lSe(this,F):W21(F)?Wa1(this,F):Kh(F)?dNb(this,F):Promise.reject(Error("Unsupported action type: "+F.actionType))};g.A=ERR.prototype;g.A.WnQ=function(F){var J=this,b,I,u,w;return g.S(function(M){if(!g.x(F.state,128))return M.gD(0);b=F.state.e6;var q=(I=b)==null?void 0:I.errorCode,v=(u=b)==null?void 0:u.Zu;w=q==="net.connect"&&v===1?"TRANSFER_FAILURE_REASON_NETWORK_LOST":(q==null?0:q.startsWith("net."))?"TRANSFER_FAILURE_REASON_NETWORK":"TRANSFER_FAILURE_REASON_INTERNAL";return g.T(M,J.un(J.player.getVideoData().videoId,w),0)})};
g.A.un=function(F,J){var b=this;return g.S(function(I){if(I.C==1){if(b.U)return I.return();b.U=!0;return J==="TRANSFER_FAILURE_REASON_NETWORK_LOST"?(XM(b,F,!1,!0),I.gD(0)):g.T(I,Ch(b,F),3)}g.jE(F,4);return g.T(I,b.C.un(J),0)})};
g.A.N8=function(F){F.status===2?(F.status!==this.T&&(l_k(this.C),g.jE(F.videoId,2)),F.MM&&jEz(this.C,F.videoId,F.MM)):F.status===4?(Ch(this,F.videoId),this.un(F.videoId,F.HH?"TRANSFER_FAILURE_REASON_FILESYSTEM_WRITE":"TRANSFER_FAILURE_REASON_INTERNAL")):F.status===1&&EQt(this.C);this.T=F.status;this.api.jE("localmediachange",{videoId:F.videoId,status:F.status})};
g.A.Hv=function(){var F=this,J;return g.S(function(b){if(b.C==1){if(F.U)return b.return();F.U=!0;J=F.player.getVideoData().videoId;return g.T(b,Ch(F,J),2)}return g.T(b,F.C.Hv(),0)})};
g.A.jt=function(F){switch(F){case "HD_1080":return"hd1080";case "HD":return"hd720";case "SD":return"large";case "LD":return"tiny";default:return"hd720"}};
g.A.S=function(F){return this.api.J().S(F)};g.z(rSb,rx);rSb.prototype.U=function(F){return a_(F)?s85(this,F):eG(F)?Y0m(this,F):W21(F)?$NU(this,F):Promise.reject(Error("Unsupported action type: "+F.actionType))};kZU.prototype.C=function(F,J){var b=F.action.actionMetadata.priority-J.action.actionMetadata.priority;b===0&&(F.C<J.C?b=-1:F.C>J.C&&(b=1));return b};g.z(Q0,g.R);Q0.prototype.X_=function(){this.N&&this.N();g.R.prototype.X_.call(this)};
Q0.prototype.createAction=function(F,J){var b=g.w0(F.entityKey).entityType,I=g.Nq(16);return new il(b,I,F,J.actionId,J.rootActionId)};
Q0.prototype.eE=function(F){var J=this,b,I,u,w,M,q,v,a,e;return g.S(function(K){if(K.C==1){if(J.iR())return K.return();I=(b=F.offlineOrchestrationActionWrapperEntity)!=null?b:new Set;u=[];w=g.N(I);for(M=w.next();!M.done;M=w.next())q=M.value,v=g.w0(q),a=v.entityId,h8t(J.C,a)||u.push(q);return g.T(K,b8V(J,u),2)}e=K.U;return g.T(K,Jy8(J,e),0)})};
Q0.prototype.retry=function(){var F=this;return g.S(function(J){return g.T(J,I_1(F),0)})};wQ5.prototype.L8=function(F,J){J=J===void 0?!0:J;var b=this,I,u,w,M,q,v,a,e;return g.S(function(K){switch(K.C){case 1:if(!b.C)return K.return();I=[];u=g.gA(b.C.U,J);w=[];for(M={J8:0};M.J8<u.length;M={J8:M.J8},M.J8++)q=u[M.J8],v=b.C.UG(q,"json3"),a=g.Px(v,{withCredentials:!0,format:"RAW"},3,500).then(function(p){return function(m){m={metadata:g.aH(u[p.J8]),trackData:m.xhr.responseText};w.push(m)}}(M)).rX(function(p){I_("Caption fetch error",p)}),I.push(a);
return g.T(K,j6W(I),2);case 2:return g.lk(K,3),g.T(K,x55(F,w),5);case 5:g.Wa(K,0);break;case 3:e=g.dY(K),I_("Caption DB transaction error",e),g.N4(K)}})};g.z(R_,g.R);R_.prototype.X_=function(){this.U&&this.U();g.R.prototype.X_.call(this)};
R_.prototype.T=function(F){var J=this,b,I,u,w,M,q,v,a;return g.S(function(e){I=(b=F.transfer)!=null?b:new Set;u=[];w=g.N(I);for(M=w.next();!M.done;M=w.next())q=M.value,v=g.w0(q),a=v.entityId,u.push(a);return u.length===0?e.return():g.T(e,qYR(J,u),0)})};g.z(pQU,g.R);g.A=pQU.prototype;g.A.X_=function(){this.Gj&&this.Gj();this.kQ.dispose();this.Z.dispose();this.qf&&g.X9(this.W.dT,this.qf);this.fW&&g.X9(this.W.dT,this.fW);g.R.prototype.X_.call(this)};
g.A.QH_=function(F){var J=this,b,I,u;return g.S(function(w){switch(w.C){case 1:b=g.Ms(F,"transfer");if(J.C&&b===J.C.key){XM(J.V,J.D,!0);J.Z.stop();w.gD(0);break}return g.T(w,ns(J.U,{mode:"readwrite",Em:!0},function(M){return kt(M,b,"transfer").then(function(q){if(q&&q.transferState!=="TRANSFER_STATE_COMPLETE"&&q.transferState!=="TRANSFER_STATE_FAILED")return q.transferState="TRANSFER_STATE_PAUSED_BY_USER",hl(M,q,"transfer").then(function(){return q})})}),3);
case 3:I=w.U;if(!I){w.gD(0);break}if(!F||!J.T){w.gD(5);break}return g.T(w,ph(F,J.T,J.U,"DOWNLOAD_STATE_PAUSED"),5);case 5:return g.T(w,OI(J,F),7);case 7:u=w.U,lG1({videoId:F,ZW:I,offlineModeType:u}),g.N4(w)}})};
g.A.leG=function(){var F=this;if(this.C&&this.D){XM(this.V,this.D,!1);var J=this.C,b=(J==null?0:J.key)?g.w0(J.key).entityId:"";b&&this.T&&(new Promise(function(I,u){ph(b,F.T,F.U,"DOWNLOAD_STATE_PAUSED").catch(function(w){u(w)})})).catch(function(I){I_("Download state setting error",I)})}this.Z.stop()};
g.A.pU=function(){this.C?yyW(this,this.C):kh(this)};
g.A.ai=function(F){var J=this;return g.S(function(b){switch(b.C){case 1:if(!J.C){b.gD(2);break}if(J.C.transferState==="TRANSFER_STATE_COMPLETE"||J.C.transferState==="TRANSFER_STATE_FAILED"||!F.transfer||!F.transfer.has(J.C.key)){b.gD(3);break}return g.T(b,ZK(J.U,J.C.key,"transfer"),4);case 4:J.C=b.U;if(J.C){b.gD(3);break}return g.T(b,i8m(J),3);case 3:if(J.C)return b.return();case 2:return g.T(b,kh(J),0)}})};
g.A.un=function(F,J){var b=this,I,u,w,M,q;return g.S(function(v){switch(v.C){case 1:if(!b.C){o_(b,"onTransferFailure: "+F);v.gD(2);break}I=b.C;w=((u=I)==null?0:u.key)?g.w0(I.key).entityId:"";a:switch(F){case "TRANSFER_FAILURE_REASON_FILESYSTEM_WRITE":case "TRANSFER_FAILURE_REASON_EXTERNAL_FILESYSTEM_WRITE":case "TRANSFER_FAILURE_REASON_PLAYABILITY":case "TRANSFER_FAILURE_REASON_TOO_MANY_RETRIES":var a=!1;break a;default:a=!0}return a&&GMz(b)?g.T(v,hO(b,"TRANSFER_STATE_TRANSFER_IN_QUEUE"),8):g.T(v,
Vfe(b,F),5);case 5:if(!w||!b.T){v.gD(2);break}return g.T(v,ph(w,b.T,b.U,"DOWNLOAD_STATE_FAILED"),2);case 8:return g.T(v,OI(b,w),9);case 9:M=v.U;qz({transferStatusType:"TRANSFER_STATUS_TYPE_REENQUEUED_BY_RETRY"},{videoId:w,ZW:I,offlineModeType:M});if(!w||!b.T){v.gD(2);break}return g.T(v,ph(w,b.T,b.U,"DOWNLOAD_STATE_RETRYABLE_FAILURE"),2);case 2:Dl(b),q=kh(b,!0),J&&J(q),g.N4(v)}})};
g.A.Hv=function(F){var J=this,b,I,u,w,M,q,v,a,e,K,p,m;return g.S(function(y){switch(y.C){case 1:if(!J.C){o_(J,"onMaybeTransferStreamsExpired");y.gD(2);break}return GMz(J)?g.T(y,hO(J,"TRANSFER_STATE_WAITING_FOR_PLAYER_RESPONSE_REFRESH"),9):g.T(y,Vfe(J,"TRANSFER_FAILURE_REASON_STREAM_MISSING"),5);case 5:if(!J.T){y.gD(2);break}b=J.C;u=((I=b)==null?0:I.key)?g.w0(b.key).entityId:"";if(!u){y.gD(2);break}return g.T(y,ph(u,J.T,J.U,"DOWNLOAD_STATE_FAILED"),2);case 9:return J.C||o_(J,"onMaybeTransferStreamsExpiredRetryAttempting"),
w=J.C,q=((M=w)==null?0:M.key)?g.w0(w.key).entityId:"",g.T(y,OI(J,q),10);case 10:return v=y.U,qz({transferStatusType:"TRANSFER_STATUS_TYPE_DEQUEUED_BY_PLAYER_RESPONSE_EXPIRATION"},{videoId:q,ZW:w,offlineModeType:v}),a=Gvm(),g.CO(a,Yh,{isEnqueuedForExpiredStreamUrlRefetch:!0}),e=g.Ms(q,"playbackData"),K={actionType:"OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",entityKey:e,actionMetadata:a},p=Nz(new il("playbackData",q,K)),g.T(y,tl(J.U,p,"offlineOrchestrationActionWrapperEntity"),2);case 2:Dl(J),m=kh(J,!0),
F&&F(m),g.N4(y)}})};
var rn1={},Pob=(rn1.TRANSFER_STATE_TRANSFERRING=1,rn1.TRANSFER_STATE_TRANSFER_IN_QUEUE=2,rn1);g.A=cH.prototype;g.A.Ca=function(){return this.D.promise};
g.A.ox=function(){if(this.U&&this.V)return this.D.promise;ryb(this).then(this.D.resolve).catch(this.D.reject);return this.D.promise};
g.A.lm=function(F){var J={};return J.playbackData=new KaL(F,this.rD,this.C),J.transfer=new rSb(F,this.rD),J.videoPlaybackPositionEntity=new N2R(F,this.rD),J};
g.A.cR=function(){var F=this;return g.S(function(J){return F.U?g.T(J,gQ1(F.U),0):J.gD(0)})};
g.A.j0=function(){var F=this,J,b;return g.S(function(I){if(I.C==1)return F.U||F.V?g.T(I,F.Ca(),2):I.return();F.Y!==void 0&&(g.ii(F.Y),F.Y=void 0);F.Z!==void 0&&(g.ii(F.Z),F.Z=void 0);(J=F.U)==null||J.dispose();F.U=void 0;(b=F.V)==null||b.dispose();F.V=void 0;F.api.jE("onOrchestrationLostLeader");F.D=new g.m6;g.N4(I)})};
g.A.isOrchestrationLeader=function(){return this.T.C};
g.A.bW=function(){return g.S(function(F){return F.return(!1)})};
g.A.uP=function(F){var J=this.C;J.api.publish("offlinetransferpause",F);var b;(b=J.U)==null||b.postMessage(F)};
g.A.pU=function(F){var J,b;return g.S(function(I){if(I.C==1)return g.T(I,Ls(),2);J=I.U;if(!J)return I.return();b=g.Ms(F,"transfer");return g.T(I,ns(J,{mode:"readwrite",Em:!0},function(u){var w=kt(u,b,"transfer"),M=kt(u,g.Ms(F,"videoDownloadContextEntity"),"videoDownloadContextEntity");return g.fD.all([w,M]).then(function(q){q=g.N(q);var v=q.next().value;var a=q.next().value;return v&&v.transferState==="TRANSFER_STATE_PAUSED_BY_USER"?(v.transferState="TRANSFER_STATE_TRANSFER_IN_QUEUE",hl(u,v,"transfer").then(function(){qz({transferStatusType:"TRANSFER_STATUS_TYPE_REENQUEUED_BY_USER_RESUME",
statusType:"USER_RESUMED"},{videoId:F,ZW:v,offlineModeType:a==null?void 0:a.offlineModeType});return g.fD.resolve(null)})):g.fD.resolve(null)})}),0)})};
g.A.HR=function(F){F=F===void 0?43200:F;var J=this,b,I,u,w,M,q,v,a;return g.S(function(e){if(e.C==1)return J.W.Vi()?g.T(e,Ls(),2):e.return(SY1());if(e.C!=3){b=e.U;if(!b)return e.return([]);I=Date.now()/1E3;return g.T(e,Hb(b,"offlineVideoPolicy"),3)}u=e.U;w=[];M=g.N(u);for(q=M.next();!q.done;q=M.next())v=q.value,Number(v.lastUpdatedTimestampSeconds)+F<=I&&(a=g.w0(v.key).entityId,w.push(a));return w.length?e.return(UI(J,w,J.N,"OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH")):e.return([])})};
g.A.deleteAll=function(){return UI(this,["!*$_ALL_ENTITIES_!*$"],this.N,"OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE",{offlineLoggingData:{offlineDeleteReason:"OFFLINE_DELETE_REASON_USER_INITIATED"}})};
g.A.refreshAllStaleEntities=function(F){var J=this;return g.S(function(b){return b.C==1?g.T(b,J.HR(F),2):b.return(b.U)})};
g.A.setUpPositionSyncInterval=function(F){var J=this;this.Z!==void 0&&(g.ii(this.Z),this.Z=void 0);var b=F!=null?F:864E5;this.Z=g.g$(function(){J.SL(b)},b)};
g.A.SL=function(F){var J=this,b,I,u,w,M,q;return g.S(function(v){switch(v.C){case 1:return g.lk(v,2),g.T(v,QQ.getInstance(),4);case 4:b=v.U;if(!b)throw Error("prefStorage is undefined");return g.T(v,b.get("psi"),5);case 5:I=v.U;w=((u=I)==null?0:u.OF)?Number(I.OF)/1E3:0;M=Date.now();if(!(w+F<=M)){v.gD(6);break}return g.T(v,UI(J,["!*$_ALL_ENTITIES_!*$"],"videoPlaybackPositionEntity","OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH"),6);case 6:g.Wa(v,0);break;case 2:q=g.dY(v),I_("Offline manager error",q),
g.N4(v)}})};
g.A.jW=function(){var F=this,J,b,I,u,w,M,q;return g.S(function(v){if(v.C==1)return g.T(v,Ls(),2);if(v.C!=3)return(J=v.U)?g.T(v,Hb(J,"transfer"),3):v.return([]);b=v.U;I=[];u=g.N(b);for(w=u.next();!w.done;w=u.next())M=w.value,M.transferState==="TRANSFER_STATE_WAITING_FOR_PLAYER_RESPONSE_REFRESH"&&M.key&&(q=g.w0(M.key).entityId,I.push(q));return v.return(YY5(F,I))})};
g.A.zx=function(){return g.S(function(F){return F.return([])})};
g.A.Ls=function(){return g.S(function(F){g.N4(F)})};
g.A.Zx=function(){return g.S(function(F){g.N4(F)})};g.z($wU,rx);$wU.prototype.U=function(F){return a_(F)?QE1(this,F):eG(F)?Dwm(this,F):Kh(F)?kMt(this,F):Promise.reject(Error("Unsupported action type: "+F.actionType))};
var xh=[10];g.z(UwV,rx);UwV.prototype.U=function(F){return a_(F)?tf8(this,F):eG(F)?Z8H(this,F):Kh(F)?H85(this,F):Promise.reject(Error("Unsupported action type: "+F.actionType))};
var nQ1=[10];g.z(F5e,rx);F5e.prototype.U=function(F){return eG(F)?b6k(this,F):Promise.reject(Error("Unsupported action type: "+F.actionType))};g.z(ICb,cH);g.A=ICb.prototype;g.A.lm=function(F){var J=cH.prototype.lm.call(this,F);J.mainVideoEntity=new UwV(F,this.rD,this.C);J.mainPlaylistEntity=new $wU(F,this.rD,this.C);J.mainDownloadsListEntity=new F5e(F,this.rD,this.C);return J};
g.A.refreshAllStaleEntities=function(F,J){var b=this,I,u,w,M,q,v,a,e,K,p,m;return g.S(function(y){switch(y.C){case 1:I=[];if(!b.rD.S("web_player_offline_playlist_auto_refresh")){y.gD(2);break}return g.T(y,u4V(b,F,J),3);case 3:I=y.U;case 2:return g.T(y,QQ.getInstance(),4);case 4:return u=y.U,g.T(y,(w=u)==null?void 0:w.get("sdois"),5);case 5:return M=y.U,g.T(y,(q=u)==null?void 0:q.get("lmqf"),6);case 6:v=y.U;if(!M){y.gD(7);break}e=I;K=e.concat;return g.T(y,wVk(b,M,(a=v)!=null?a:"SD",F===0),8);case 8:I=
K.call(e,y.U);case 7:return p=I,m=p.concat,g.T(y,cH.prototype.refreshAllStaleEntities.call(b,F,J),9);case 9:return I=m.call(p,y.U),y.return(I)}})};
g.A.bW=function(F){var J,b,I,u,w,M,q,v;return g.S(function(a){if(a.C==1)return g.T(a,Ls(),2);if(a.C!=3)return(J=a.U)?g.T(a,ZK(J,g.$E,"mainDownloadsListEntity"),3):a.return(!1);b=a.U;if((I=b)==null?0:(u=I.downloads)==null?0:u.length)for(w=g.Ms(F,"mainVideoEntity"),M=g.N(b.downloads),q=M.next();!q.done;q=M.next())if(v=q.value,v.videoItem===w)return a.return(!0);return a.return(!1)})};
g.A.zx=function(){var F=this,J,b,I,u,w,M,q,v;return g.S(function(a){if(a.C==1)return g.T(a,Ls(),2);if(a.C!=3)return(J=a.U)?g.T(a,Hb(J,"downloadStatusEntity"),3):a.return([]);b=a.U;I=[];u=g.N(b);for(w=u.next();!w.done;w=u.next())M=w.value,M.downloadState==="DOWNLOAD_STATE_USER_DELETED"&&M.key&&(q=g.w0(M.key).entityId,I.push(q));return I.length?(v={offlineLoggingData:{offlineDeleteReason:"OFFLINE_DELETE_REASON_USER_INITIATED"}},a.return(UI(F,I,"mainVideoEntity","OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE",
v))):a.return([])})};
g.A.Zx=function(){var F;return g.S(function(J){return J.C==1?g.T(J,Ls(),2):(F=J.U)?g.T(J,ns(F,{mode:"readwrite",Em:!0},function(b){return OA(b,"mainVideoEntity").then(function(I){var u=[];I=g.N(I);for(var w=I.next();!w.done;w=I.next()){w=w.value;var M=void 0;(M=w.userState)!=null&&M.playbackPosition||(M=g.w0(w.key).entityId,M={key:g.Ms(M,"videoPlaybackPositionEntity"),videoId:M,lastPlaybackPositionSeconds:"0"},u.push(hl(b,M,"videoPlaybackPositionEntity")),w.userState={playbackPosition:M.key},u.push(hl(b,
w,"mainVideoEntity")))}return g.fD.all(u)})}),0):J.return()})};
g.A.Ls=function(){var F,J,b,I,u,w,M,q,v,a,e,K,p,m,y,f,d,G,P,r,Q,D,t,n,uk,AJ,F7,h,L,l,c,Da,fz,Kz,Vz,Za,Ib,yU;return g.S(function(E){if(E.C==1)return g.T(E,Ls(),2);if(E.C!=3){F=E.U;if(!F)return E.return();J=g.Ms("DOWNLOADS_LIST_ENTITY_ID_MANUAL_DOWNLOADS","mainDownloadsListEntity");return g.T(E,ns(F,{mode:"readonly",Em:!0},function(V){return g.fD.all([kt(V,J,"mainDownloadsListEntity"),kt(V,g.$E,"mainDownloadsListEntity"),OA(V,"mainVideoEntity"),OA(V,"mainPlaylistEntity")])}),3)}b=E.U;
I=g.N(b);u=I.next().value;w=I.next().value;M=I.next().value;q=I.next().value;v=u;a=w;e=M;K=q;p=new Set;if((m=v)==null?0:(y=m.downloads)==null?0:y.length)for(f=g.N(v.downloads),d=f.next();!d.done;d=f.next())G=d.value,P=void 0,(r=(P=G.videoItem)!=null?P:G.playlistItem)&&p.add(r);if((Q=a)==null?0:(D=Q.downloads)==null?0:D.length)for(t=g.N(a.downloads),n=t.next();!n.done;n=t.next())uk=n.value,uk.videoItem&&p.add(uk.videoItem);AJ=new Set;F7=[];h=g.N(K);for(L=h.next();!L.done;L=h.next()){l=L.value;if(l.videos)for(c=
g.N(l.videos),Da=c.next();!Da.done;Da=c.next())fz=Da.value,(Kz=JSON.parse(g.w0(fz).entityId).videoId)&&AJ.add(Kz);l.key&&!p.has(l.key)&&F7.push(l.key)}Vz=g.N(e);for(Za=Vz.next();!Za.done;Za=Vz.next())Ib=Za.value,Ib.key&&!p.has(Ib.key)&&(yU=g.w0(Ib.key).entityId,AJ.has(yU)||F7.push(Ib.key));return F7.length?g.T(E,RY1(F,F7),0):E.gD(0)})};g.z(MM5,rx);MM5.prototype.U=function(F){return a_(F)?qJL(this,F):eG(F)?vdV(this,F):Kh(F)?aCU(this,F):Promise.reject(Error("Unsupported action type: "+F.actionType))};
var tO=[10];g.z(K5m,rx);K5m.prototype.U=function(F){return a_(F)?gdz(this,F):eG(F)?mrU(this,F):Kh(F)?yn5(this,F):Promise.reject(Error("Unsupported action type: "+F.actionType))};
var Zl=[10];g.z(NDR,rx);NDR.prototype.U=function(F){return a_(F)?drt(this,F):eG(F)?Ede(this,F):Kh(F)?j35(this,F):Promise.reject(Error("Unsupported action type: "+F.actionType))};
var W5H=[10];g.z(HH,cH);HH.prototype.lm=function(F){var J=cH.prototype.lm.call(this,F);J.musicTrack=new NDR(F,this.C);J.musicPlaylist=new K5m(F,this.C);J.musicAlbumRelease=new MM5(F,this.C);return J};
HH.prototype.refreshAllStaleEntities=function(F,J){var b=this,I,u,w;return g.S(function(M){if(M.C==1)return g.T(M,VMW(b,F,J),2);if(M.C!=3)return u=I=M.U,w=u.concat,g.T(M,cH.prototype.refreshAllStaleEntities.call(b,F,J),3);I=w.call(u,M.U);return M.return(I)})};g.z(PGW,g.GN);g.A=PGW.prototype;g.A.create=function(){var F=this;g.k(this,this.events);g.hP(this.rD)?this.C=new ICb(this.rD,this.player):g.sV(this.rD)&&(this.C=new HH(this.rD,this.player));this.events.B(this.player,"onPlaybackStartExternal",function(){F.fG()});
this.events.B(this.player,"videodatachange",function(){F.fG()});
this.rD.S("html5_offline_playback_position_sync")&&this.events.B(this.player,"presentingplayerstatechange",this.SJ)};
g.A.u7=function(){return!1};
g.A.EB=function(F,J,b,I){var u=this;return g.S(function(w){return u.C?w.return(UI(u.C,F,J,b,I)):w.return(Promise.reject())})};
g.A.deleteAll=function(){return this.C.deleteAll()};
g.A.HR=function(F){return this.C.HR(F)};
g.A.refreshAllStaleEntities=function(F){return this.C.refreshAllStaleEntities(F)};
g.A.setUpPositionSyncInterval=function(F){this.C.setUpPositionSyncInterval(F)};
g.A.uP=function(F){this.C.uP(F)};
g.A.pU=function(F){return this.C.pU(F)};
g.A.fG=function(){var F=this,J;return g.S(function(b){J=F.player.getVideoData();return g.UW(J)?BDU(J)&&F.U!==J.clientPlaybackNonce?g.T(b,TDH(F,J),0):b.gD(0):b.return()})};
g.A.SJ=function(F){var J=this,b,I,u,w,M,q,v;return g.S(function(a){if(a.C==1)return b=J.player.getVideoData(),I=b.KW,g.e1(F,2)||g.e1(F,512)?g.T(a,Ls(),2):a.return();if(a.C!=3){u=a.U;if(!u)return I_("PES is undefined"),a.return();w=b.videoId;return g.T(a,ZK(u,g.Ms(w,"mainVideoEntity"),"mainVideoEntity"),3)}M=a.U;if(!M)return a.return();q=Math.floor(I).toString();v={videoPlaybackPositionEntityActionMetadata:{lastPlaybackPositionSeconds:q}};return g.T(a,J.EB([w],"videoPlaybackPositionEntity","OFFLINE_ORCHESTRATION_ACTION_TYPE_UPDATE",
v),0)})};
g.A.isOrchestrationLeader=function(){return this.C.isOrchestrationLeader()};
g.A.updateDownloadState=function(F,J){var b,I,u,w;return g.S(function(M){if(M.C==1)return g.T(M,Ls(),2);b=M.U;if(!b)return I_("PES is undefined"),M.return();I=g.w0(F);u=I.entityType;w=I.entityId;return g.T(M,ph(w,u,b,J,!0),0)})};g.jn("offline",PGW);})(_yt_player);
